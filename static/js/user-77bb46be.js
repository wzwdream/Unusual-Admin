import{_ as e,u as a,a as l}from"./index-b3fbacf8.js";import{_ as t,a as d}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-9227fd3c.js";import{h as n,a as o}from"./index-a1b3d2b0.js";import{g as s}from"./role-8546a947.js";import{u}from"./useDict-24a04082.js";import{c as i,a as r,b as c}from"./calibrationRules-6d34d65c.js";import{h as m,M as p,x as v,bb as b,bc as h,o as f,q as g,k as _,w as y,l as k,Q as w,J as x,H as U,j as D,S as R,bd as j,b4 as S,aU as q,az as V,be as F,bf as A,ax as E,aV as H}from"./.pnpm-50f13181.js";import"./dict-2be0c59b.js";const K=e=>n.put("/user",e),Q=e=>n.delete("/user/"+e),z=e=>n.post("/user",e),I=m({name:"User"}),N=o(m({...I,setup(n){const o={add:["admin","user:add"],del:["admin","user:del"],edit:["admin","user:edit"],download:["admin","user:download"]},m=p([]);s().then((e=>{m.value=e.data.data}));const{dict:I,getDictLabel:N}=u(["status","sex"]),B=p([{type:"selection",disabled:e=>1===e.id},{title:"ID",key:"id"},{title:"登录账号",key:"account"},{title:"用户名称",key:"name"},{title:"性别",key:"sex",render:e=>v("span",N("sex",String(e.sex)))},{title:"电话",key:"phone"},{title:"状态",key:"status",render:e=>v(b,{rubberBand:!1,value:Number(e.status),loading:!!e.loading,checkedValue:1,uncheckedValue:0,disabled:1===e.id,onUpdateValue:()=>C(e)})},{title:"创建日期",key:"createTime"},{title:"操作",key:"actions",align:"center",fixed:"right",render:a=>[v(e,{disabled:1===a.id,permission:o,onHandleDelete:()=>Y(a.id),onHandleEdit:()=>Z(a),onHandleView:()=>ee(a)})]}]),C=async e=>{e.loading=!0;const a={...e,status:0===e.status?1:0};await K(a),await se(),e.loading=!1},L={account:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:i,message:"密码格式不正确",trigger:"input"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:r,message:"请输入正确的邮箱",trigger:"input"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:c,message:"请输入正确的手机号",trigger:"input"}]},T=h(),{pagination:J,modalVisible:M,modalAction:G,modalShowFooter:O,modalTitle:P,modalLoading:W,handleAdd:X,handleDelete:Y,handleEdit:Z,handleDownload:$,handleView:ee,handleSave:ae,handlereset:le,defualtQuery:te,modalForm:de,modalFormRef:ne,changeCheckRow:oe,listQuery:se,listData:ue,loading:ie,rowKey:re,btnDisabled:ce,checkedRowKeys:me}=a({name:"用户",url:"/user",key:"id",initForm:{account:"",name:"",phone:"",email:"",sex:0,status:1,roles:[]},initQuery:{account:void 0,phone:void 0,status:void 0},beforeRefresh:e=>(e&&e.title&&(e.pid=void 0),e),afterSave:e=>{"add"===e&&T.info({title:"初始密码",content:"123456"})},doDelete:Q,doCreate:z,doUpdate:K});return(e,a)=>{const n=R,s=t,u=j,i=S,r=d,c=q,p=V,v=F,b=A,h=E,K=H,Q=l;return f(),g("div",null,[_(r,{columns:k(B),"onUpdate:columns":a[3]||(a[3]=e=>w(B)?B.value=e:null),btnDisabled:k(ce),permission:o,onSearch:k(se),onReset:k(le),onAdd:k(X),onDelete:k(Y),onEdit:k(Z),onDownload:k($)},{queryBar:y((()=>[_(s,{label:"登录账号"},{default:y((()=>[_(n,{value:k(te).account,"onUpdate:value":a[0]||(a[0]=e=>k(te).account=e),size:"small",clearable:"",placeholder:"输入登录账号，模糊搜索"},null,8,["value"])])),_:1}),_(s,{label:"手机号"},{default:y((()=>[_(n,{value:k(te).phone,"onUpdate:value":a[1]||(a[1]=e=>k(te).phone=e),size:"small",clearable:"",placeholder:"输入手机号，模糊搜索"},null,8,["value"])])),_:1}),_(s,{label:"用户状态"},{default:y((()=>{var e;return[_(u,{value:k(te).status,"onUpdate:value":a[2]||(a[2]=e=>k(te).status=e),placeholder:"选择用户状态",options:null==(e=k(I))?void 0:e.status,clearable:""},null,8,["value","options"])]})),_:1})])),default:y((()=>[_(i,{columns:k(B),data:k(ue),loading:k(ie),"row-key":k(re),pagination:k(J),striped:"",remote:!0,"checked-row-keys":k(me),"onUpdate:checkedRowKeys":k(oe)},null,8,["columns","data","loading","row-key","pagination","checked-row-keys","onUpdate:checkedRowKeys"])])),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),_(Q,{visible:k(M),"onUpdate:visible":a[11]||(a[11]=e=>w(M)?M.value=e:null),title:k(P),loading:k(W),"show-footer":k(O),width:"600px",onSave:k(ae)},{default:y((()=>[_(K,{ref_key:"modalFormRef",ref:ne,"label-placement":"left","label-align":"right","label-width":80,model:k(de),rules:L,disabled:"view"===k(G)},{default:y((()=>[_(h,{"x-gap":"12",cols:2},{default:y((()=>[_(p,null,{default:y((()=>[_(c,{label:"登录账号",path:"account"},{default:y((()=>[_(n,{value:k(de).account,"onUpdate:value":a[4]||(a[4]=e=>k(de).account=e),clearable:""},null,8,["value"])])),_:1})])),_:1}),_(p,null,{default:y((()=>[_(c,{label:"电话",path:"phone"},{default:y((()=>[_(n,{value:k(de).phone,"onUpdate:value":a[5]||(a[5]=e=>k(de).phone=e),clearable:""},null,8,["value"])])),_:1})])),_:1}),_(p,null,{default:y((()=>[_(c,{label:"用户名称",path:"name"},{default:y((()=>[_(n,{value:k(de).name,"onUpdate:value":a[6]||(a[6]=e=>k(de).name=e),clearable:""},null,8,["value"])])),_:1})])),_:1}),_(p,null,{default:y((()=>[_(c,{label:"邮箱",path:"email"},{default:y((()=>[_(n,{value:k(de).email,"onUpdate:value":a[7]||(a[7]=e=>k(de).email=e),clearable:""},null,8,["value"])])),_:1})])),_:1}),_(p,null,{default:y((()=>[_(c,{label:"性别",path:"sex"},{default:y((()=>[_(b,{value:k(de).sex,"onUpdate:value":a[8]||(a[8]=e=>k(de).sex=e),name:"sex"},{default:y((()=>{var e;return[(f(!0),g(x,null,U(null==(e=k(I))?void 0:e.sex,(e=>(f(),D(v,{key:e.id,value:Number(e.value),label:e.label},null,8,["value","label"])))),128))]})),_:1},8,["value"])])),_:1})])),_:1}),_(p,null,{default:y((()=>[_(c,{label:"状态",path:"status"},{default:y((()=>[_(b,{value:k(de).status,"onUpdate:value":a[9]||(a[9]=e=>k(de).status=e),name:"status"},{default:y((()=>{var e;return[(f(!0),g(x,null,U(null==(e=k(I))?void 0:e.status,(e=>(f(),D(v,{key:e.id,value:Number(e.value),label:e.label},null,8,["value","label"])))),128))]})),_:1},8,["value"])])),_:1})])),_:1}),_(p,{span:"2"},{default:y((()=>[_(c,{label:"用户角色",path:"roles"},{default:y((()=>[_(u,{value:k(de).roles,"onUpdate:value":a[10]||(a[10]=e=>k(de).roles=e),multiple:"","label-field":"name","value-field":"id",filterable:"",clearable:"",options:k(m)},null,8,["value","options"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","disabled"])])),_:1},8,["visible","title","loading","show-footer","onSave"])])}}}),[["__scopeId","data-v-d2bad7d5"]]);export{N as default};
