import{_ as ie,u as re,a as de}from"./index-4074b9b4.js";import{_ as pe,a as me}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-178a4612.js";import{h as k,_ as _e}from"./index-54c8dad2.js";import{g as ce}from"./role-51aafa24.js";import{u as fe}from"./useDict-0da1ad03.js";import{c as be,a as ge,b as ve}from"./calibrationRules-c253761e.js";import{X as he,L as ke,k as ye,Y as Ue,T as we,M as xe,H as De,Z as Re,$ as Se,I as Be,O as Fe}from"./naive-ui-e3a37dce.js";import{d as N,a as F,h as v,l as _,m as h,q as a,bt as o,u as e,f as V,F as $,aT as E,a8 as L}from"./@vue-b1321081.js";import"./vue-i18n-d9dd9a4c.js";import"./@intlify-9ddbe450.js";import"./lodash-es-000674ce.js";import"./pinia-44adfabd.js";import"./vue-demi-71ba0ef2.js";import"./@vueuse-d91fccee.js";import"./vue-echarts-f350ff7c.js";import"./resize-detector-a5205554.js";import"./echarts-8b4ffd07.js";import"./zrender-d04178fe.js";import"./tslib-54e39b60.js";import"./vue-router-655d402f.js";import"./@iconify-688b7688.js";import"./axios-47b9d439.js";import"./@codemirror-f87e1e31.js";import"./@lezer-42a0dbdf.js";import"./style-mod-fd510d21.js";import"./w3c-keyname-9fb136d3.js";import"./pinia-plugin-persistedstate-02097300.js";import"./date-fns-2c268c3c.js";import"./@babel-31db5498.js";import"./vueuc-e19c7b48.js";import"./evtd-b614532e.js";import"./seemly-4f9c12c5.js";import"./@css-render-490b4d85.js";import"./vooks-db1138e2.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./treemate-426a560e.js";import"./async-validator-dee29e8b.js";import"./dict-ed1115bc.js";const C=d=>k.put("/user",d),Ve=d=>k.delete("/user/"+d),$e=d=>k.post("/user",d),Ee=N({name:"User"}),Le=N({...Ee,setup(d){const y={add:["admin","user:add"],del:["admin","user:del"],edit:["admin","user:edit"],download:["admin","user:download"]},U=F([]);ce().then(l=>{U.value=l.data.data});const{dict:f,getDictLabel:q}=fe(["status","sex"]),c=F([{type:"selection",disabled:l=>l.account==="admin"},{title:"ID",key:"id"},{title:"登录账号",key:"account"},{title:"用户名称",key:"name"},{title:"性别",key:"sex",render(l){return v("span",q("sex",String(l.sex)))}},{title:"电话",key:"phone"},{title:"状态",key:"status",render(l){return v(he,{rubberBand:!1,value:Number(l.status),loading:!!l.loading,checkedValue:1,uncheckedValue:0,disabled:l.account==="admin",onUpdateValue:()=>A(l)})}},{title:"创建日期",key:"createTime"},{title:"操作",key:"actions",align:"center",fixed:"right",render(l){return[v(ie,{disabled:l.account==="admin",permission:y,onHandleDelete:()=>w(l.id),onHandleEdit:()=>x(l),onHandleView:()=>X(l)})]}}]),A=async l=>{l.loading=!0;const n={...l,status:l.status===0?1:0};await C(n),await D(),l.loading=!1},H={account:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:be,message:"密码格式不正确",trigger:"input"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:ge,message:"请输入正确的邮箱",trigger:"input"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:ve,message:"请输入正确的手机号",trigger:"input"}]},K=ke(),{pagination:T,modalVisible:b,modalAction:I,modalShowFooter:M,modalTitle:Q,modalLoading:z,handleAdd:P,handleDelete:w,handleEdit:x,handleDownload:O,handleView:X,handleSave:Y,handlereset:Z,defualtQuery:p,modalForm:s,modalFormRef:j,changeCheckRow:G,listQuery:D,listData:J,loading:W,rowKey:ee,btnDisabled:ae,checkedRowKeys:te}=re({name:"用户",url:"/user",key:"id",initForm:{account:"",name:"",phone:"",email:"",sex:0,status:1,roles:[]},initQuery:{account:void 0,phone:void 0,status:void 0},beforeRefresh:l=>(l&&l.title&&(l.pid=void 0),l),afterSave:(l,n)=>{l==="add"&&K.info(`初始密码': content: ${n.data.pwd} || '123456`,{closable:!0,duration:0})},doDelete:Ve,doCreate:$e,doUpdate:C});return(l,n)=>{const m=ye,g=pe,R=Ue,le=we,ne=me,i=xe,r=De,S=Re,B=Se,oe=Be,se=Fe,ue=de;return _(),h("div",null,[a(ne,{columns:e(c),"onUpdate:columns":n[3]||(n[3]=t=>V(c)?c.value=t:null),btnDisabled:e(ae),permission:y,onSearch:e(D),onReset:e(Z),onAdd:e(P),onDelete:e(w),onEdit:e(x),onDownload:e(O)},{queryBar:o(()=>[a(g,{label:"登录账号"},{default:o(()=>[a(m,{value:e(p).account,"onUpdate:value":n[0]||(n[0]=t=>e(p).account=t),size:"small",clearable:"",placeholder:"输入登录账号，模糊搜索"},null,8,["value"])]),_:1}),a(g,{label:"手机号"},{default:o(()=>[a(m,{value:e(p).phone,"onUpdate:value":n[1]||(n[1]=t=>e(p).phone=t),size:"small",clearable:"",placeholder:"输入手机号，模糊搜索"},null,8,["value"])]),_:1}),a(g,{label:"用户状态"},{default:o(()=>{var t;return[a(R,{value:e(p).status,"onUpdate:value":n[2]||(n[2]=u=>e(p).status=u),placeholder:"选择用户状态",options:(t=e(f))==null?void 0:t.status,clearable:""},null,8,["value","options"])]}),_:1})]),default:o(()=>[a(le,{columns:e(c),data:e(J),loading:e(W),"row-key":e(ee),pagination:e(T),striped:"",remote:!0,"checked-row-keys":e(te),"onUpdate:checkedRowKeys":e(G)},null,8,["columns","data","loading","row-key","pagination","checked-row-keys","onUpdate:checkedRowKeys"])]),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),a(ue,{visible:e(b),"onUpdate:visible":n[11]||(n[11]=t=>V(b)?b.value=t:null),title:e(Q),loading:e(z),"show-footer":e(M),width:"600px",onSave:e(Y)},{default:o(()=>[a(se,{ref_key:"modalFormRef",ref:j,"label-placement":"left","label-align":"right","label-width":80,model:e(s),rules:H,disabled:e(I)==="view"},{default:o(()=>[a(oe,{"x-gap":"12",cols:2},{default:o(()=>[a(r,null,{default:o(()=>[a(i,{label:"登录账号",path:"account"},{default:o(()=>[a(m,{value:e(s).account,"onUpdate:value":n[4]||(n[4]=t=>e(s).account=t),clearable:""},null,8,["value"])]),_:1})]),_:1}),a(r,null,{default:o(()=>[a(i,{label:"电话",path:"phone"},{default:o(()=>[a(m,{value:e(s).phone,"onUpdate:value":n[5]||(n[5]=t=>e(s).phone=t),clearable:""},null,8,["value"])]),_:1})]),_:1}),a(r,null,{default:o(()=>[a(i,{label:"用户名称",path:"name"},{default:o(()=>[a(m,{value:e(s).name,"onUpdate:value":n[6]||(n[6]=t=>e(s).name=t),clearable:""},null,8,["value"])]),_:1})]),_:1}),a(r,null,{default:o(()=>[a(i,{label:"邮箱",path:"email"},{default:o(()=>[a(m,{value:e(s).email,"onUpdate:value":n[7]||(n[7]=t=>e(s).email=t),clearable:""},null,8,["value"])]),_:1})]),_:1}),a(r,null,{default:o(()=>[a(i,{label:"性别",path:"sex"},{default:o(()=>[a(B,{value:e(s).sex,"onUpdate:value":n[8]||(n[8]=t=>e(s).sex=t),name:"sex"},{default:o(()=>{var t;return[(_(!0),h($,null,E((t=e(f))==null?void 0:t.sex,u=>(_(),L(S,{key:u.id,value:Number(u.value),label:u.label},null,8,["value","label"]))),128))]}),_:1},8,["value"])]),_:1})]),_:1}),a(r,null,{default:o(()=>[a(i,{label:"状态",path:"status"},{default:o(()=>[a(B,{value:e(s).status,"onUpdate:value":n[9]||(n[9]=t=>e(s).status=t),name:"status"},{default:o(()=>{var t;return[(_(!0),h($,null,E((t=e(f))==null?void 0:t.status,u=>(_(),L(S,{key:u.id,value:Number(u.value),label:u.label},null,8,["value","label"]))),128))]}),_:1},8,["value"])]),_:1})]),_:1}),a(r,{span:"2"},{default:o(()=>[a(i,{label:"用户角色",path:"roles"},{default:o(()=>[a(R,{value:e(s).roles,"onUpdate:value":n[10]||(n[10]=t=>e(s).roles=t),multiple:"","label-field":"name","value-field":"id",filterable:"",clearable:"",options:e(U)},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer","onSave"])])}}});const ya=_e(Le,[["__scopeId","data-v-bf437a82"]]);export{ya as default};
