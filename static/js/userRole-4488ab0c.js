import{k as _e,p as U,a as fe}from"./index-54c8dad2.js";import{_ as ve,u as ge,a as be}from"./index-4074b9b4.js";import{_ as ke,a as ye}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-178a4612.js";import{u as D,a as he,s as we,b as Re,d as Ue}from"./role-51aafa24.js";import{u as De}from"./useDict-0da1ad03.js";import{X as x,g as xe,k as Ce,Y as Se,T as Be,M as Ve,W as Ke,p as Me,O as $e,H as Ee,a2 as Fe,o as Ie,I as Ne}from"./naive-ui-e3a37dce.js";import{d as V,a as r,h as C,j as S,l as qe,m as Ae,q as n,bt as o,u as e,f as B,B as He}from"./@vue-b1321081.js";import"./@vueuse-d91fccee.js";import"./pinia-44adfabd.js";import"./vue-demi-71ba0ef2.js";import"./vue-i18n-d9dd9a4c.js";import"./@intlify-9ddbe450.js";import"./vue-echarts-f350ff7c.js";import"./resize-detector-a5205554.js";import"./echarts-8b4ffd07.js";import"./zrender-d04178fe.js";import"./tslib-54e39b60.js";import"./vue-router-655d402f.js";import"./@iconify-688b7688.js";import"./axios-47b9d439.js";import"./@codemirror-f87e1e31.js";import"./@lezer-42a0dbdf.js";import"./style-mod-fd510d21.js";import"./w3c-keyname-9fb136d3.js";import"./lodash-es-000674ce.js";import"./pinia-plugin-persistedstate-02097300.js";import"./date-fns-2c268c3c.js";import"./@babel-31db5498.js";import"./vueuc-e19c7b48.js";import"./evtd-b614532e.js";import"./seemly-4f9c12c5.js";import"./@css-render-490b4d85.js";import"./vooks-db1138e2.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./treemate-426a560e.js";import"./async-validator-dee29e8b.js";import"./dict-ed1115bc.js";const Le=V({name:"UserRole"}),Bt=V({...Le,setup(ze){const v={add:["admin","role:add"],del:["admin","role:del"],edit:["admin","role:edit"],download:["admin","role:download"]},{dict:K}=De(["status"]),u=r([{type:"selection",disabled:t=>t.id===1},{title:"ID",key:"id"},{title:"角色名称",key:"name"},{title:"角色排序",key:"sort"},{title:"角色状态",key:"status",render(t){return C(x,{rubberBand:!1,value:Number(t.status),loading:!!t.loading,checkedValue:1,uncheckedValue:0,disabled:t.id===1,onUpdateValue:()=>M(t)})}},{title:"备注",key:"remark"},{title:"操作",key:"actions",align:"center",fixed:"right",render(t){return[C(ve,{permission:v,disabled:t.id===1,onHandleDelete:()=>k(t.id),onHandleEdit:()=>y(t),onHandleView:()=>j(t)})]}}]),M=async t=>{try{t.loading=!0;const a={...t,status:t.status===0?1:0};await D(a),await h(),t.loading=!1}catch{t.loading=!1}},i=r(),$=t=>({style:"cursor: pointer;",onClick:async()=>{var a;t.id&&t.id!==1&&t.id!==((a=i.value)==null?void 0:a.id)&&(d.value=await E(t.id)||[],i.value=t)}}),E=async t=>(await he(t)).data,F=S(()=>t=>{var a;return t.id===((a=i.value)==null?void 0:a.id)?"selected-row":""}),g=r(),d=r([]),b=S(()=>{var t;return((t=i.value)==null?void 0:t.id)===void 0});_e().then(t=>{g.value=t.data});const I=t=>{d.value=t},m=r(!1),N=()=>{var t;i.value&&d.value?(m.value=!0,we((t=i.value)==null?void 0:t.id,d.value).then(a=>{m.value=!1,U.success(a.message)}).catch(()=>{m.value=!1})):U.warning("请选择数据")},q={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{modalVisible:_,modalAction:A,modalShowFooter:H,modalTitle:L,modalLoading:z,handleAdd:Q,handleDelete:k,handleEdit:y,handleDownload:T,handleView:j,handleSave:O,handlereset:P,defualtQuery:p,modalForm:s,modalFormRef:W,changeCheckRow:X,listQuery:h,listData:Y,pagination:G,loading:J,rowKey:Z,btnDisabled:ee,checkedRowKeys:te}=ge({name:"角色",url:"/role",key:"id",initForm:{name:"",status:1,sort:null,remark:""},initQuery:{name:"",status:null},doCreate:Re,doDelete:Ue,doUpdate:D,beforeSave:t=>(console.log(t),t),beforeRefresh:()=>(i.value=void 0,d.value=[],!0)});return(t,a)=>{const f=Ce,w=ke,ae=Se,ne=Be,oe=ye,c=Ve,le=Ke,se=Me,ie=$e,de=be,R=Ee,re=fe,ue=Fe,me=Ie,pe=Ne;return qe(),Ae("div",null,[n(pe,{cols:"3","item-responsive":"","y-gap":8,"x-gap":10,responsive:"screen"},{default:o(()=>[n(R,{span:"3 m:2 l:2 xl:2"},{default:o(()=>[n(oe,{columns:e(u),"onUpdate:columns":a[2]||(a[2]=l=>B(u)?u.value=l:null),btnDisabled:e(ee),permission:v,onSearch:e(h),onReset:e(P),onAdd:e(Q),onDelete:e(k),onEdit:e(y),onDownload:e(T)},{queryBar:o(()=>[n(w,{label:"角色名称"},{default:o(()=>[n(f,{value:e(p).name,"onUpdate:value":a[0]||(a[0]=l=>e(p).name=l),size:"small",placeholder:"输入角色名称"},null,8,["value"])]),_:1}),n(w,{label:"角色状态"},{default:o(()=>{var l;return[n(ae,{value:e(p).status,"onUpdate:value":a[1]||(a[1]=ce=>e(p).status=ce),placeholder:"选择角色状态",clearable:"",options:(l=e(K))==null?void 0:l.status},null,8,["value","options"])]}),_:1})]),default:o(()=>[n(ne,{columns:e(u),data:e(Y),pagination:e(G),loading:e(J),"row-key":e(Z),"row-props":$,"row-class-name":e(F),striped:"",remote:!0,"checked-row-keys":e(te),"onUpdate:checkedRowKeys":e(X)},null,8,["columns","data","pagination","loading","row-key","row-class-name","checked-row-keys","onUpdate:checkedRowKeys"])]),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),n(de,{visible:e(_),"onUpdate:visible":a[7]||(a[7]=l=>B(_)?_.value=l:null),title:e(L),loading:e(z),"show-footer":e(H),width:"550px",onSave:e(O)},{default:o(()=>[n(ie,{ref_key:"modalFormRef",ref:W,"label-placement":"left","label-align":"right","label-width":80,model:e(s),rules:q,disabled:e(A)==="view"},{default:o(()=>[n(c,{label:"角色名称",path:"name"},{default:o(()=>[n(f,{value:e(s).name,"onUpdate:value":a[3]||(a[3]=l=>e(s).name=l)},null,8,["value"])]),_:1}),n(se,{justify:"space-between"},{default:o(()=>[n(c,{label:"角色排序",path:"sort"},{default:o(()=>[n(le,{value:e(s).sort,"onUpdate:value":a[4]||(a[4]=l=>e(s).sort=l),clearable:""},null,8,["value"])]),_:1}),n(c,{label:"角色状态",path:"status"},{default:o(()=>[n(e(x),{"checked-value":1,"unchecked-value":0,value:e(s).status,"onUpdate:value":a[5]||(a[5]=l=>e(s).status=l)},null,8,["value"])]),_:1})]),_:1}),n(c,{label:"备注",path:"remark"},{default:o(()=>[n(f,{value:e(s).remark,"onUpdate:value":a[6]||(a[6]=l=>e(s).remark=l)},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer","onSave"])]),_:1}),n(R,{span:"3 m:1 l:1 xl:1"},{default:o(()=>[n(me,{title:"菜单分配",size:"small",segmented:!0},{"header-extra":o(()=>[n(e(xe),{type:"primary",size:"small",loading:e(m),disabled:e(b),onClick:N},{icon:o(()=>[n(re,{icon:"mingcute:save-2-line"})]),default:o(()=>[He(" 保存 ")]),_:1},8,["loading","disabled"])]),default:o(()=>[n(ue,{data:e(g),"checked-keys":e(d),disabled:e(b),"key-field":"id","label-field":"title",selectable:!1,"show-line":!0,"block-line":"",multiple:"",checkable:"","expand-on-click":"","onUpdate:checkedKeys":I},null,8,["data","checked-keys","disabled"])]),_:1})]),_:1})]),_:1})])}}});export{Bt as default};
