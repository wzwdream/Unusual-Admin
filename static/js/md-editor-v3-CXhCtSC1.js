import{x as e,f as t,R as l,h as o,$ as n,C as a,F as i,L as r}from"./@vavt-CMRoxN9M.js";import{d as s,i as c,q as d,v as u,a as m,w as p,o as v,x as h,y as g,s as f,j as b,n as y,T as k,h as $,z as w,F as C,t as T,A as x}from"./@vue-7s647Hg9.js";import{E as S,H as E,s as I,k as F,d as A,h as L,i as H,a as M,m as j,u as B,r as O,b as P,c as N,e as D,f as V,p as R,C as z,l as q,g as W,S as _,j as U}from"./@codemirror-BDMijoIR.js";import{a as K}from"./@lezer-B1NhjyO5.js";import{m as G}from"./medium-zoom-CYdBhaDp.js";import{c as Z}from"./copy-to-clipboard-lg0rY0OP.js";import{M as J}from"./markdown-it-D-rRJ5Ge.js";import{r as X}from"./markdown-it-image-figures-DRVLg4Fi.js";import{T as Y}from"./markdown-it-task-lists-CcmDKRtl.js";import{X as Q}from"./markdown-it-xss-Brhrdqro.js";import{L as ee}from"./lru-cache-DUv_w53D.js";const te="md-editor",le="https://cdnjs.cloudflare.com/ajax/libs",oe={main:`${le}/prettier/2.8.0/standalone.js`,markdown:`${le}/prettier/2.8.0/parser-markdown.js`},ne=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","previewOnly","htmlPreview","catalog","github"],ae=["markdownTotal","=","scrollSwitch"],ie={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",previewOnly:"仅预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",previewOnly:"preview only",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},re={a11y:{light:`${le}/highlight.js/11.8.0/styles/a11y-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/a11y-dark.min.css`},atom:{light:`${le}/highlight.js/11.8.0/styles/atom-one-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/atom-one-dark.min.css`},github:{light:`${le}/highlight.js/11.8.0/styles/github.min.css`,dark:`${le}/highlight.js/11.8.0/styles/github-dark.min.css`},gradient:{light:`${le}/highlight.js/11.8.0/styles/gradient-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/gradient-dark.min.css`},kimbie:{light:`${le}/highlight.js/11.8.0/styles/kimbie-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/kimbie-dark.min.css`},paraiso:{light:`${le}/highlight.js/11.8.0/styles/paraiso-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${le}/highlight.js/11.8.0/styles/qtcreator-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${le}/highlight.js/11.8.0/styles/stackoverflow-light.min.css`,dark:`${le}/highlight.js/11.8.0/styles/stackoverflow-dark.min.css`}},se={editorExtensions:{highlight:{js:`${le}/highlight.js/11.8.0/highlight.min.js`,css:re},prettier:{standaloneJs:oe.main,parserMarkdownJs:oe.markdown},cropper:{...{css:`${le}/cropperjs/1.5.13/cropper.min.css`,js:`${le}/cropperjs/1.5.13/cropper.min.js`}},iconfont:"https://at.alicdn.com/t/c/font_2605852_rfu1p40qggh.js",iconfontClass:"https://at.alicdn.com/t/c/font_2605852_rfu1p40qggh.css",screenfull:{js:`${le}/screenfull.js/5.2.0/screenfull.min.js`},mermaid:{js:`${le}/mermaid/10.6.1/mermaid.esm.min.mjs`},katex:{...{js:`${le}/KaTeX/0.16.9/katex.min.js`,css:`${le}/KaTeX/0.16.9/katex.min.css`}}},editorExtensionsAttrs:{},editorConfig:{languageUserDefined:{},mermaidTemplate:{},renderDelay:500,zIndex:2e4},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e},ce=170,de=({instance:e,ctx:t,props:l={}},o="default")=>{const n=(null==e?void 0:e.$slots[o])||(null==t?void 0:t.slots[o]);return(n?n(e):"")||l[o]},ue=s({props:{overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},setup(e,t){const l=`${te}-dropdown-hidden`,o=u({overlayClass:[l],overlayStyle:{},triggerHover:!1,overlayHover:!1}),n=m(),a=m(),i=()=>{var t,l;o.triggerHover=!0;const i=n.value,r=a.value;if(!i||!r)return;const s=i.getBoundingClientRect(),c=i.offsetTop,d=i.offsetLeft,u=s.height,m=s.width,p=(null==(t=document.querySelector(e.relative))?void 0:t.scrollLeft)||0,v=(null==(l=document.querySelector(e.relative))?void 0:l.clientWidth)||0;let h=d-r.offsetWidth/2+m/2-p;h+r.offsetWidth>p+v&&(h=p+v-r.offsetWidth),h<0&&(h=0),o.overlayStyle={...o.overlayStyle,top:c+u+"px",left:h+"px"},e.onChange(!0)},r=()=>{o.overlayHover=!0};p((()=>e.visible),(e=>{e?o.overlayClass=o.overlayClass.filter((e=>e!==l)):o.overlayClass.push(l)}));let s=-1;const c=t=>{n.value===t.target?o.triggerHover=!1:o.overlayHover=!1,clearTimeout(s),s=window.setTimeout((()=>{o.overlayHover||o.triggerHover||e.onChange(!1)}),10)};return v((()=>{n.value.addEventListener("mouseenter",i),n.value.addEventListener("mouseleave",c),a.value.addEventListener("mouseenter",r),a.value.addEventListener("mouseleave",c)})),h((()=>{n.value.removeEventListener("mouseenter",i),n.value.removeEventListener("mouseleave",c),a.value.removeEventListener("mouseenter",r),a.value.removeEventListener("mouseleave",c)})),()=>{const l=de({ctx:t}),i=de({props:e,ctx:t},"overlay");return[g(l instanceof Array?l[0]:l,{ref:n,key:"cloned-dropdown-trigger"}),d("div",{class:[`${te}-dropdown`,o.overlayClass],style:o.overlayStyle,ref:a},[d("div",{class:`${te}-dropdown-overlay`},[i instanceof Array?i[0]:i])])]}}}),me=s({name:"DropdownToolbar",props:{title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String},default:{type:[String,Object]}},emits:["onChange"],setup(e,t){const l=c("editorId");return()=>{const o=de({props:e,ctx:t},"trigger"),n=de({props:e,ctx:t},"overlay"),a=de({props:e,ctx:t});return d(ue,{relative:`#${l}-toolbar-wrapper`,visible:e.visible,onChange:l=>{e.onChange instanceof Function?e.onChange(l):t.emit("onChange",l)},overlay:n},{default:()=>[d("div",{class:`${te}-toolbar-item`,title:e.title||""},[o,a])]})}}});me.install=e=>(e.component(me.name,me),e);var pe=Object.defineProperty,ve=(e,t,l)=>(((e,t,l)=>{t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l})(e,t+"",l),l);const he=new class{constructor(){ve(this,"pools",{})}remove(e,t,l){const o=this.pools[e]&&this.pools[e][t];o&&(this.pools[e][t]=o.filter((e=>e!==l)))}clear(e){this.pools[e]={}}on(e,t){return this.pools[e]||(this.pools[e]={}),this.pools[e][t.name]||(this.pools[e][t.name]=[]),this.pools[e][t.name].push(t.callback),this.pools[e][t.name].includes(t.callback)}emit(e,t,...l){this.pools[e]||(this.pools[e]={});const o=this.pools[e][t];o&&o.forEach((e=>{try{e(...l)}catch(t){}}))}},ge="onSave",fe="changeCatalogVisible",be="changeFullscreen",ye="pageFullscreenChanged",ke="fullscreenChanged",$e="previewChanged",we="previewOnlyChanged",Ce="htmlPreviewChanged",Te="catalogVisibleChanged",xe="buildFinished",Se="errorCatcher",Ee="replace",Ie="uploadImage",Fe="openModals",Ae="ctrlZ",Le="ctrlShiftZ",He="catalogChanged",Me="pushCatalog",je="rerender",Be="eventListener",Oe=(e,t)=>{const l=l=>{const o=e.parentElement||document.body,n=o.offsetWidth,a=o.offsetHeight,{clientWidth:i}=document.documentElement,{clientHeight:r}=document.documentElement,s=l.offsetX,c=l.offsetY,d=e=>{let l=e.x+document.body.scrollLeft-document.body.clientLeft-s,d=e.y+document.body.scrollTop-document.body.clientTop-c;l=l<1?1:l<i-n-1?l:i-n-1,d=d<1?1:d<r-a-1?d:r-a-1,t?t(l,d):(o.style.left=`${l}px`,o.style.top=`${d}px`)};document.addEventListener("mousemove",d);const u=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",u)};document.addEventListener("mouseup",u)};return e.addEventListener("mousedown",l),()=>{e.removeEventListener("mousedown",l)}},Pe=(e,t,l="")=>{var o;const n=document.getElementById(t.id);if(n)""!==l&&(Reflect.get(window,l)?null==(o=t.onload)||o.call(n,new Event("load")):t.onload&&n.addEventListener("load",t.onload));else{const l={...t};l.onload=null;const o=Ne(e,l);t.onload&&o.addEventListener("load",t.onload),document.head.appendChild(o)}},Ne=(e,t)=>{const l=document.createElement(e);return Object.keys(t).forEach((e=>{void 0!==t[e]&&(l[e]=t[e])})),l},De=(e,t="image.png")=>{const l=e.split(","),o=l[0].match(/:(.*?);/);if(o){const e=o[1],n=atob(l[1]);let a=n.length;const i=new Uint8Array(a);for(;a--;)i[a]=n.charCodeAt(a);return new File([i],t,{type:e})}return null},Ve=(()=>{let e=0;return t=>t+ ++e})(),Re=(()=>{let e=0;return()=>++e})(),ze=s({props:{name:{type:String,default:""}},setup:e=>()=>d("svg",{class:`${te}-icon`,"aria-hidden":"true"},[d("use",{"xlink:href":`#${te}-icon-${e.name}`},null)])}),qe=s({props:{name:{type:String,default:""}},setup(e){const t=c("customIcon");return()=>{const l=t.value[e.name];return"object"==typeof l?"object"==typeof l.component?$(l.component,l.props):d("span",{innerHTML:l.component},null):d(ze,{name:e.name},null)}}}),We=s({name:"MdModal",props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String},style:{type:Object,default:()=>({})}},emits:["onClose"],setup(e,t){const l=c("theme"),o=m(e.visible),n=m([`${te}-modal`]),a=m(),i=m(),r=m(),s=f();let h=()=>{};const g=u({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),$=b((()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height}));return p((()=>e.isFullscreen),(e=>{e?h():y((()=>{h=Oe(i.value,((e,t)=>{g.initPos.left=e+"px",g.initPos.top=t+"px"}))}))})),p((()=>e.visible),(t=>{t?(g.maskStyle.zIndex=se.editorConfig.zIndex+Re(),g.modalStyle.zIndex=se.editorConfig.zIndex+Re(),n.value.push("zoom-in"),o.value=t,y((()=>{const t=a.value.offsetWidth/2,l=a.value.offsetHeight/2,o=document.documentElement.clientWidth/2,n=document.documentElement.clientHeight/2;g.initPos.left=o-t+"px",g.initPos.top=n-l+"px",e.isFullscreen||(h=Oe(i.value,((e,t)=>{g.initPos.left=e+"px",g.initPos.top=t+"px"})))})),setTimeout((()=>{n.value=n.value.filter((e=>"zoom-in"!==e))}),140)):(n.value.push("zoom-out"),h(),setTimeout((()=>{n.value=n.value.filter((e=>"zoom-out"!==e)),o.value=t}),130))})),v((()=>{r.value=document.body})),()=>{const c=de({ctx:t}),u=de({props:e,ctx:t},"title");return r.value?d(k,{to:r.value},{default:()=>[d("div",{ref:s,class:`${te}-modal-container`,"data-theme":l.value},[d("div",{class:e.class,style:{...e.style,display:o.value?"block":"none"}},[d("div",{class:`${te}-modal-mask`,style:g.maskStyle,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),d("div",{class:n.value,style:{...g.modalStyle,...g.initPos,...$.value},ref:a},[d("div",{class:`${te}-modal-header`,ref:i},[u||""]),d("div",{class:`${te}-modal-body`},[c]),d("div",{class:`${te}-modal-func`},[e.showAdjust&&d("div",{class:`${te}-modal-adjust`,onClick:t=>{t.stopPropagation(),e.isFullscreen?g.initPos=g.historyPos:(g.historyPos=g.initPos,g.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[d(qe,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),d("div",{class:`${te}-modal-close`,onClick:l=>{l.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[d(qe,{name:"close"},null)])])])])])]}):""}}});We.install=e=>(e.component(We.name,We),e);const _e=e=>{const t=c("highlight"),l=f(se.editorExtensions.highlight.instance);return v((()=>{e.noHighlight||l.value||(Pe("link",{...t.value.css,rel:"stylesheet",id:`${te}-hlCss`}),Pe("script",{...t.value.js,id:`${te}-hljs`,onload(){l.value=window.hljs}},"hljs"))})),p((()=>t.value.css),(()=>{((e,t)=>{const l=document.getElementById(t.id);null==l||l.remove(),Pe(e,t)})("link",{...t.value.css,rel:"stylesheet",id:`${te}-hlCss`})})),l},Ue=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(e,o,n,a,i)=>{const r=e[o],s=r.content.trim();if("mermaid"===r.info){let l;return e[o].map&&0===e[o].level&&(l=e[o].map[0],e[o].attrSet("data-line",String(l))),`<div class="${te}-mermaid" ${void 0!==l?"data-line="+l:""} data-mermaid-theme=${t.themeRef.value}>${s}</div>`}return l(e,o,n,a,i)}},Ke=(e,t)=>{const l=e.attrs?e.attrs.slice():[];return t.forEach((t=>{const o=e.attrIndex(t[0]);o<0?l.push(t):(l[o]=l[o].slice(),l[o][1]+=` ${t[1]}`)})),l},Ge=(e,t)=>{let l=!0,o=!0;const n=e.posMax,a=t>0?e.src.charCodeAt(t-1):-1,i=t+1<=n?e.src.charCodeAt(t+1):-1;return(32===a||9===a||i>=48&&i<=57)&&(o=!1),32!==i&&9!==i||(l=!1),{can_open:l,can_close:o}},Ze=(e,t)=>{let l,o,n,a;if("$"!==e.src[e.pos])return!1;if(n=Ge(e,e.pos),!n.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const i=e.pos+1;for(l=i;-1!==(l=e.src.indexOf("$",l));){for(a=l-1;"\\"===e.src[a];)a-=1;if((l-a)%2==1)break;l+=1}return-1===l?(t||(e.pending+="$"),e.pos=i,!0):l-i==0?(t||(e.pending+="$$"),e.pos=i+1,!0):(n=Ge(e,l),n.can_close?(t||(o=e.push("math_inline","math",0),o.markup="$",o.content=e.src.slice(i,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=i,!0))},Je=(e,t,l,o)=>{let n,a,i,r,s=!1,c=e.bMarks[t]+e.tShift[t],d=e.eMarks[t];if(c+2>d)return!1;if("$$"!==e.src.slice(c,c+2))return!1;if(c+=2,n=e.src.slice(c,d),o)return!0;for("$$"===n.trim().slice(-2)&&(n=n.trim().slice(0,-2),s=!0),i=t;!s&&(i++,!(i>=l))&&(c=e.bMarks[i]+e.tShift[i],d=e.eMarks[i],!(c<d&&e.tShift[i]<e.blkIndent));)"$$"===e.src.slice(c,d).trim().slice(-2)&&(r=e.src.slice(0,d).lastIndexOf("$$"),a=e.src.slice(c,r),s=!0);e.line=i+1;const u=e.push("math_block","math",0);return u.block=!0,u.content=(n&&n.trim()?n+"\n":"")+e.getLines(t+1,i,e.tShift[t],!0)+(a&&a.trim()?a:""),u.map=[t,e.line],u.markup="$$",!0},Xe=(e,{katexRef:t})=>{e.inline.ruler.after("escape","math_inline",Ze),e.block.ruler.after("blockquote","math_block",Je,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(e,l,o,n,a)=>{const i=e[l],r={attrs:Ke(i,[["class",`${te}-katex-inline`]])};if(t.value){const e=t.value.renderToString(i.content,{throwOnError:!1});return`<span ${a.renderAttrs(r)} data-processed>${e}</span>`}return`<span ${a.renderAttrs(r)}>${i.content}</span>`},e.renderer.rules.math_block=(e,l,o,n,a)=>{const i=e[l],r={attrs:Ke(i,[["class",`${te}-katex-block`]])};if(t.value){const e=t.value.renderToString(i.content,{throwOnError:!1,displayMode:!0});return`<p ${a.renderAttrs(r)} data-processed>${e}</p>`}return`<p ${a.renderAttrs(r)}>${i.content}</p>`}},Ye=(e,t)=>{const l=(t=t||{}).marker||"!",o=l.charCodeAt(0),n=l.length;let a="",i="";const r=(e,t,l,o,n)=>{const a=e[t];return"admonition_open"===a.type?e[t].attrPush(["class",`${te}-admonition ${te}-admonition-${a.info}`]):"admonition_title_open"===a.type&&e[t].attrPush(["class",`${te}-admonition-title`]),n.renderToken(e,t,l)};e.block.ruler.before("code","admonition",((e,t,r,s)=>{let c,d,u,m=!1,p=e.bMarks[t]+e.tShift[t],v=e.eMarks[t];if(o!==e.src.charCodeAt(p))return!1;for(c=p+1;c<=v&&l[(c-p)%n]===e.src[c];c++);const h=Math.floor((c-p)/n);if(3!==h)return!1;c-=(c-p)%n;const g=e.src.slice(p,c);if((e=>{const t=e.trim().split(" ",2);i="",a=t[0],t.length>1&&(i=e.substring(a.length+2)),""!==i&&i||(i=a)})(e.src.slice(c,v)),s)return!0;for(d=t;(d++,!(d>=r))&&(p=e.bMarks[d]+e.tShift[d],v=e.eMarks[d],!(p<v&&e.sCount[d]<e.blkIndent));)if(o===e.src.charCodeAt(p)&&!(e.sCount[d]-e.blkIndent>=4)){for(c=p+1;c<=v&&l[(c-p)%n]===e.src[c];c++);if(!(Math.floor((c-p)/n)<h||(c-=(c-p)%n,c=e.skipSpaces(c),c<v))){m=!0;break}}const f=e.parentType,b=e.lineMax;return e.parentType="root",e.lineMax=d,u=e.push("admonition_open","div",1),u.markup=g,u.block=!0,u.info=a,u.map=[t,d],u=e.push("admonition_title_open","p",1),u.markup=g+" "+a,u.map=[t,d],u=e.push("inline","",0),u.content=i,u.map=[t,e.line-1],u.children=[],u=e.push("admonition_title_close","p",-1),u.markup=g+" "+a,e.md.block.tokenize(e,t+1,d),u=e.push("admonition_close","div",-1),u.markup=e.src.slice(p,c),u.block=!0,e.parentType=f,e.lineMax=b,e.line=d+(m?1:0),!0}),{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=r,e.renderer.rules.admonition_title_open=r,e.renderer.rules.admonition_title_close=r,e.renderer.rules.admonition_close=r},Qe=(e,t)=>{e.renderer.rules.heading_open=(l,o)=>{var n;const a=l[o],i=(null==(n=l[o+1].children)?void 0:n.reduce(((e,t)=>e+(["text","code_inline"].includes(t.type)&&t.content||"")),""))||"",r=a.markup.length;return t.headsRef.value.push({text:i,level:r}),a.map&&0===a.level&&a.attrSet("id",t.mdHeadingId(i,r,t.headsRef.value.length)),e.renderer.renderToken(l,o,t)},e.renderer.rules.heading_close=(e,t,l,o,n)=>n.renderToken(e,t,l)},et=(e,t)=>{const l=e.renderer.rules.fence,o=e.utils.unescapeAll,n=/\[(\w*)(?::([\w ]*))?\]/,a=e=>e.info?o(e.info).trim():"",i=e=>{const t=a(e),[l=null,o=""]=(n.exec(t)||[]).slice(1);return[l,o]},r=e=>{const t=a(e);return t?t.split(/(\s+)/g)[0]:""},s=e=>({open:e.content.trim().split("\n").length<t.autoFoldThreshold,tagContainer:t.codeFoldable?"details":"div",tagHeader:t.codeFoldable?"summary":"div"});e.renderer.rules.fence=(e,o,a,c,d)=>{var u,m;if(e[o].hidden)return"";const[p]=i(e[o]);if(null===p){const{open:n,tagContainer:i,tagHeader:r}=s(e[o]),m=[["class",`${te}-code`]];n&&m.push(["open",""]);const p={attrs:Ke(e[o],m)},v=l(e,o,a,c,d);return`<${i} ${d.renderAttrs(p)}>\n    <${r} class="${te}-code-head">\n      <div class="${te}-code-flag">\n        <span></span>\n        <span></span>\n        <span></span>\n      </div>\n      <div>\n        <span class="${te}-code-lang">${e[o].info.trim()}</span>\n        <span class="${te}-copy-button">${null==(u=t.usedLanguageTextRef.value)?void 0:u.copyCode.text}</span>\n      </div>\n    </${r}>${v}</${i}>`}let v,h,g,f,b="",y="",k="";const{open:$,tagContainer:w,tagHeader:C}=s(e[o]),T=[["class",`${te}-code`]];$&&T.push(["open",""]);const x={attrs:Ke(e[o],T)};for(let s=o;s<e.length&&(v=e[s],[h,g]=i(v),h===p);s++){v.info=v.info.replace(n,""),v.hidden=!0;const i=`${te}-codetab-${t.editorId}-${o}-${s-o}`;f=s-o>0?"":"checked",b+=`<li>\n          <input type="radio" name="${te}-codetab-label-${t.editorId}-${o}" class="${i}" ${f}>\n          <label onclick="document.querySelectorAll('.${i}').forEach(e => e.click())">${g||r(v)}</label>\n        </li>`,y+=`<input type="radio" name="${te}-codetab-pre-${t.editorId}-${o}" class="${i}" ${f}>\n      ${l(e,s,a,c,d)}`,k+=`<input type="radio" name="${te}-codetab-lang-${t.editorId}-${o}" class="${i}" ${f}>\n      <span class=${te}-code-lang>${r(v)}</span>`}return`<${w} ${d.renderAttrs(x)}>\n    <${C} class="${te}-code-head">\n      <div class="${te}-code-flag">\n        <ul class="${te}-codetab-label">${b}</ul>\n      </div>\n      <div>\n        <span class="${te}-codetab-lang">${k}</span>\n        <span class="${te}-copy-button">${null==(m=t.usedLanguageTextRef.value)?void 0:m.copyCode.text}</span>\n      </div>\n    </${C}>${y}</${w}>`}},tt=(e,t)=>{const{editorConfig:n,markdownItConfig:a,markdownItPlugins:i}=se,r=c("editorId"),s=c("usedLanguageText"),d=c("showCodeRowNumber"),u=c("theme"),h=m([]),g=_e(e),k=(e=>{const t=f(se.editorExtensions.katex.instance);return v((()=>{if(e.noKatex||t.value)return;const{editorExtensions:l}=se;Pe("script",{src:l.katex.js,id:`${te}-katex`,onload(){t.value=window.katex}},"katex"),Pe("link",{rel:"stylesheet",href:l.katex.css,id:`${te}-katexCss`})})),t})(e),{reRenderRef:$,replaceMermaid:w}=(e=>{const t=c("theme"),{editorExtensions:l,editorExtensionsAttrs:n,mermaidConfig:a}=se,i=f(l.mermaid.instance),r=f(-1),s=new ee({max:1e3,ttl:6e5}),d=()=>{const l=i.value;!e.noMermaid&&l&&(l.initialize(a({startOnLoad:!1,theme:"dark"===t.value?"dark":"default"})),r.value=r.value+1)};return p((()=>t.value),(()=>{s.clear(),d()})),v((()=>{var t,o,a;if(e.noMermaid||(null==(t=i.value)?void 0:t.instance))return;const r=l.mermaid.js;/\.mjs/.test(r)?(Pe("link",{...null==(o=n.mermaid)?void 0:o.js,rel:"modulepreload",href:r,id:`${te}-mermaid-m`}),import(r).then((e=>{i.value=e.default,d()}))):Pe("script",{...null==(a=n.mermaid)?void 0:a.js,src:r,id:`${te}-mermaid`,onload(){i.value=window.mermaid,d()}},"mermaid")})),{mermaidRef:i,reRenderRef:r,replaceMermaid:()=>{y((()=>{if(!e.noMermaid&&i.value){const t=document.querySelectorAll(`div.${te}-mermaid`),l=document.createElement("div");l.style.width=document.body.offsetWidth+"px",l.style.height=document.body.offsetHeight+"px",l.style.position="fixed",l.style.zIndex="-10000",l.style.top="-10000";let n=t.length;n>0&&document.body.appendChild(l),t.forEach((async t=>{let a=s.get(t.innerText);if(!a){const n=o(),r=i.value.renderAsync||i.value.render;let d="";try{d=await r(n,t.innerText,l)}catch(c){}a=await e.sanitizeMermaid("string"==typeof d?d:d.svg),s.set(t.innerText,a)}const r=document.createElement("p");r.className=`${te}-mermaid`,r.setAttribute("data-processed",""),r.innerHTML=a,void 0!==t.dataset.line&&(r.dataset.line=t.dataset.line),t.replaceWith(r),0==--n&&l.remove()}))}}))}}})(e),C=J({html:!0,breaks:!0,linkify:!0});a(C,{editorId:r});const x=[{type:"image",plugin:X,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Ye,options:{}},{type:"taskList",plugin:Y,options:{}},{type:"heading",plugin:Qe,options:{mdHeadingId:e.mdHeadingId,headsRef:h}},{type:"code",plugin:et,options:{editorId:r,usedLanguageTextRef:s,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold}},{type:"xss",plugin:Q,options:{xss:e=>({whiteList:Object.assign({},e.getDefaultWhiteList(),{input:["class","disabled","type","checked"],iframe:["class","width","height","src","title","border","frameborder","framespacing","allow","allowfullscreen"]})})}}];e.noKatex||x.push({type:"katex",plugin:Xe,options:{katexRef:k}}),e.noMermaid||x.push({type:"mermaid",plugin:Ue,options:{themeRef:u}}),i(x,{editorId:r}).forEach((e=>{C.use(e.plugin,e.options)}));const S=C.options.highlight;C.set({highlight:(t,l,o)=>{if(S){const e=S(t,l,o);if(e)return e}let n;if(!e.noHighlight&&g.value){n=g.value.getLanguage(l)?g.value.highlight(t,{language:l,ignoreIllegals:!0}).value:g.value.highlightAuto(t).value}else n=C.utils.escapeHtml(t);return`<pre><code class="language-${l}" language=${l}>${d?(e=>{if(!e)return e;const t=e.split("\n"),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach((()=>{l.push("<span></span>")})),l.push("</span>"),`<span class="${te}-code-block">${e}</span>${l.join("")}`})(n.replace(/^\n+|\n+$/g,"")):`<span class="${te}-code-block">${n.replace(/^\n+|\n+$/g,"")}</span>`}</code></pre>`}}),e.previewOnly||(e=>{e.core.ruler.push("init-line-number",(e=>(e.tokens.forEach((e=>{e.map&&(e.attrs||(e.attrs=[]),e.attrs.push(["data-line",e.map[0].toString()]))})),!0)))})(C);const E=m(`_article-key_${o()}`),I=m(e.sanitize(C.render(e.modelValue))),F=()=>{he.emit(r,xe,I.value),e.onHtmlChanged(I.value),e.onGetCatalog(h.value),he.emit(r,He,h.value),w()};v(F);const A=()=>{h.value=[],I.value=e.sanitize(C.render(e.modelValue)),F()},L=b((()=>(e.noKatex||k.value)&&(e.noHighlight||g.value)));return p([T(e,"modelValue"),L,$],l(A,t?0:n.renderDelay)),p((()=>e.setting.preview),(()=>{e.setting.preview&&y((()=>{he.emit(r,He,h.value)}))})),v((()=>{he.on(r,{name:Me,callback(){he.emit(r,He,h.value)}}),he.on(r,{name:je,callback:()=>{E.value=`_article-key_${o()}`,A()}})})),{html:I,key:E}},lt={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function},codeFoldable:{type:Boolean},autoFoldThreshold:{type:Number}},ot={...lt,updateModelValue:{type:Function,default:()=>{}},onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},nt=s({name:"ContentPreview",props:lt,setup(e){const t=c("editorId"),o=c("previewTheme"),n=c("showCodeRowNumber"),{html:a,key:i}=tt(e,e.previewOnly);return((e,t,l)=>{const o=c("editorId"),n=c("usedLanguageText"),a=()=>{document.querySelectorAll(`#${o} .${te}-preview .${te}-code`).forEach((t=>{let l=-1;const o=t.querySelector(`.${te}-copy-button`);o&&(o.onclick=a=>{a.preventDefault(),clearTimeout(l);const i=(t.querySelector("input:checked + pre code")||t.querySelector("pre code")).textContent,r=Z(e.formatCopiedText(i)),{text:s,successTips:c,failTips:d}=n.value.copyCode;o.innerHTML=r?c:d,l=window.setTimeout((()=>{o.innerHTML=s}),1500)})}))},i=e=>{e&&y(a)};p([t,l],(()=>{y(a)})),p((()=>e.setting.preview),i),p((()=>e.setting.htmlPreview),i),p((()=>n.value),a),v(a)})(e,a,i),((e,t)=>{const o=c("editorId"),{noImgZoomIn:n}=e,a=l((()=>{const e=document.querySelectorAll(`#${o}-preview img`);0!==e.length&&G(e,{background:"#00000073"})}));v((()=>{a()})),p([t,T(e.setting,"preview")],(()=>{!n&&e.setting.preview&&a()}))})(e,a),()=>d(C,null,[e.setting.preview&&d("div",{id:`${t}-preview-wrapper`,class:`${te}-preview-wrapper`,key:"content-preview-wrapper"},[d("div",{key:i.value,id:`${t}-preview`,class:[`${te}-preview`,`${null==o?void 0:o.value}-theme`,n&&`${te}-scrn`],innerHTML:a.value},null)]),!e.previewOnly&&e.setting.htmlPreview&&d("div",{id:`${t}-html-wrapper`,class:`${te}-preview-wrapper`,key:"html-preview-wrapper"},[d("div",{class:`${te}-html`},[a.value])])])}}),at=l=>{const{editorId:o}=l,n=se.editorExtensions.highlight,a=se.editorExtensionsAttrs.highlight;w("editorId",o),w("theme",b((()=>l.theme))),w("language",b((()=>l.language))),w("highlight",b((()=>{const{js:e}=n,t={...re,...n.css},{js:o,css:i={}}=a||{},r=l.codeStyleReverse&&l.codeStyleReverseList.includes(l.previewTheme)?"dark":l.theme;return{js:{src:e,...o},css:{href:t[l.codeTheme]?t[l.codeTheme][r]:re.atom[r],...t[l.codeTheme]&&i[l.codeTheme]?i[l.codeTheme][r]:i.atom?i.atom[r]:{}}}}))),w("showCodeRowNumber",l.showCodeRowNumber);const i=b((()=>{const o={...ie,...se.editorConfig.languageUserDefined};return e(t(ie["en-US"]),o[l.language]||{})}));w("usedLanguageText",i),w("previewTheme",b((()=>l.previewTheme))),w("customIcon",b((()=>l.customIcon)))},it=e=>{v((()=>{const{editorExtensions:t,editorExtensionsAttrs:l,iconfontType:o}=se;e.noIconfont||("svg"===o?Pe("script",{...l.iconfont,src:t.iconfont,id:`${te}-icon`}):Pe("link",{...l.iconfontClass,rel:"stylesheet",href:t.iconfontClass,id:`${te}-icon-class`}))}))},rt={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:()=>Ve("md-editor-v3_")},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:e=>e},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)},codeFoldable:{type:Boolean,default:!0},autoFoldThreshold:{type:Number,default:30}},st={...rt,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:ne},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:ae},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},ct=["onHtmlChanged","onGetCatalog"],dt=[...ct,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],ut=s({name:"MdPreview",props:rt,emits:ct,setup(e,t){const{editorId:l,noKatex:o,noMermaid:n,noHighlight:a}=e;return at(e),it(e),((e,t)=>{const{editorId:l}=e,o={rerender(){he.emit(l,je)}};t.expose(o)})(e,t),h((()=>{he.clear(l)})),()=>d("div",{id:l,class:[te,e.class,"dark"===e.theme&&`${te}-dark`,`${te}-previewOnly`],style:e.style},[d(nt,{modelValue:e.modelValue,onHtmlChanged:l=>{e.onHtmlChanged?e.onHtmlChanged(l):t.emit("onHtmlChanged",l)},onGetCatalog:l=>{e.onGetCatalog?e.onGetCatalog(l):t.emit("onGetCatalog",l)},mdHeadingId:e.mdHeadingId,noMermaid:n,sanitize:e.sanitize,noKatex:o,formatCopiedText:e.formatCopiedText,noHighlight:a,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null)])}});ut.install=e=>(e.component(ut.name,ut),e);const mt=s({props:{tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},setup:e=>()=>{const{tocItem:t,mdHeadingId:l,scrollElement:o,onClick:n,scrollElementOffsetTop:a}=e;return d("div",{class:[`${te}-catalog-link`,t.active&&`${te}-catalog-active`],onClick:e=>{n(e,t),e.stopPropagation();const i=l(t.text,t.level,t.index),r=document.getElementById(i),s=o instanceof Element?o:document.querySelector(o);if(r&&s){let e=r.offsetParent,t=r.offsetTop;if(s.contains(e))for(;e&&s!=e;)t+=null==e?void 0:e.offsetTop,e=null==e?void 0:e.offsetParent;null==s||s.scrollTo({top:t-a,behavior:"smooth"})}}},[d("span",{title:t.text},[t.text]),d("div",{class:`${te}-catalog-wrapper`},[t.children&&t.children.map((e=>d(mt,{mdHeadingId:l,key:`${t.text}-link-${e.level}-${e.text}`,tocItem:e,scrollElement:o,onClick:n,scrollElementOffsetTop:a},null)))])])}}),pt=mt,vt=s({name:"MdCatalog",props:{editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function}},emits:["onClick","onActive"],setup(e,t){const l=e.editorId,o=u({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),n=f(),a=b((()=>{const e=[];return o.list.forEach(((t,l)=>{const{text:o,level:a}=t,i={level:a,text:o,index:l+1,active:n.value===t};if(0===e.length)e.push(i);else{let t=e[e.length-1];if(i.level>t.level)for(let e=t.level+1;e<=6;e++){const{children:e}=t;if(!e){t.children=[i];break}if(t=e[e.length-1],i.level<=t.level){e.push(i);break}}else e.push(i)}})),e})),i=()=>o.scrollElement instanceof HTMLElement?o.scrollElement:document.querySelector(o.scrollElement),r=t=>{if(0===t.length)return o.list=[],!1;const{activeHead:l}=t.reduce(((t,l,o)=>{const n=document.getElementById(e.mdHeadingId(l.text,l.level,o+1));if(n instanceof HTMLElement){const o=((e,t)=>{if(!e||!t)return 0;const l=null==e?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const o=null==t?void 0:t.getBoundingClientRect();return l.top-o.top})(n,i());if(o<e.offsetTop&&o>t.minTop)return{activeHead:l,minTop:o}}return t}),{activeHead:t[0],minTop:Number.MIN_SAFE_INTEGER});n.value=l,o.list=t},s=()=>{r(o.list)};return p((()=>n.value),(l=>{const o=l?{...l}:void 0;e.onActive?e.onActive(o):t.emit("onActive",o)})),v((()=>{let e=window;const t=()=>{const t=i();e=t===document.documentElement?window:t};he.on(l,{name:He,callback:l=>{null==e||e.removeEventListener("scroll",s),r(l),t(),null==e||e.addEventListener("scroll",s)}}),he.emit(l,Me),t(),null==e||e.addEventListener("scroll",s)})),h((()=>{var e;const t=i();null==(e=t===document.documentElement?window:t)||e.removeEventListener("scroll",s)})),()=>d("div",{class:`${te}-catalog${"dark"===e.theme?"-dark":""} ${e.class}`},[a.value.map((l=>d(pt,{mdHeadingId:e.mdHeadingId,tocItem:l,key:`link-${l.level}-${l.text}`,scrollElement:o.scrollElement,onClick:(l,o)=>{e.onClick?e.onClick(l,o):t.emit("onClick",l,o)},scrollElementOffsetTop:e.scrollElementOffsetTop},null)))])}});vt.install=e=>(e.component(vt.name,vt),e);const ht=s({name:"NormalToolbar",props:{title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},emits:["onClick"],setup:(e,t)=>()=>{const l=de({props:e,ctx:t},"trigger");return d("div",{class:`${te}-toolbar-item`,title:e.title,onClick:l=>{e.onClick instanceof Function?e.onClick(l):t.emit("onClick",l)}},[l])}});ht.install=e=>(e.component(ht.name,ht),e);const gt=s({name:"ModalToolbar",props:{title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String}},emits:["onClick","onClose","onAdjust"],setup:(e,t)=>()=>{const l=de({props:e,ctx:t},"trigger"),o=de({props:e,ctx:t},"default");return d(C,null,[d("div",{class:`${te}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[l]),d(We,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:l=>{e.onAdjust instanceof Function?e.onAdjust(l):t.emit("onAdjust",l)}},(n=o,"function"==typeof n||"[object Object]"===Object.prototype.toString.call(n)&&!x(n)?o:{default:()=>[o]}))]);var n}});gt.install=e=>(e.component(gt.name,gt),e);var ft=Object.defineProperty,bt=(e,t,l)=>(((e,t,l)=>{t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l})(e,"symbol"!=typeof t?t+"":t,l),l);const yt=s({setup:()=>()=>d("div",{class:`${te}-divider`},null)}),kt={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},$t=s({name:"TableShape",props:{tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},setup(e){const t=u({x:-1,y:-1}),l=()=>{const t=[...e.tableShape];return(!t[2]||t[2]<t[0])&&(t[2]=t[0]),(!t[3]||t[3]<t[3])&&(t[3]=t[1]),t},o=m(l());return p((()=>e.tableShape),(()=>{o.value=l()})),()=>d("div",{class:`${te}-table-shape`,onMouseleave:()=>{o.value=l(),t.x=-1,t.y=-1}},[new Array(o.value[1]).fill("").map(((l,n)=>d("div",{class:`${te}-table-shape-row`,key:`table-shape-row-${n}`},[new Array(o.value[0]).fill("").map(((l,a)=>d("div",{class:`${te}-table-shape-col`,key:`table-shape-col-${a}`,onMouseenter:()=>{t.x=n,t.y=a,a+1===o.value[0]&&a+1<o.value[2]?o.value[0]++:a+2<o.value[0]&&o.value[0]>e.tableShape[0]&&o.value[0]--,n+1===o.value[1]&&n+1<o.value[3]?o.value[1]++:n+2<o.value[1]&&o.value[1]>e.tableShape[1]&&o.value[1]--},onClick:()=>{e.onSelected(t)}},[d("div",{class:[`${te}-table-shape-col-default`,n<=t.x&&a<=t.y&&`${te}-table-shape-col-include`]},null)])))])))])}}),wt=s({props:{type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},setup(e){const t=c("usedLanguageText"),l=c("editorId"),o=b((()=>{var l,o;switch(e.type){case"link":return null==(l=t.value.linkModalTips)?void 0:l.linkTitle;case"image":return null==(o=t.value.linkModalTips)?void 0:o.imageTitle;default:return""}})),n=u({desc:"",url:""});return p((()=>e.visible),(e=>{e||setTimeout((()=>{n.desc="",n.url=""}),200)})),()=>d(We,{title:o.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var o,a,i,r,s;return[d("div",{class:`${te}-form-item`},[d("label",{class:`${te}-label`,for:`link-desc-${l}`},[null==(o=t.value.linkModalTips)?void 0:o.descLabel]),d("input",{placeholder:null==(a=t.value.linkModalTips)?void 0:a.descLabelPlaceHolder,class:`${te}-input`,id:`link-desc-${l}`,type:"text",value:n.desc,onChange:e=>{n.desc=e.target.value},autocomplete:"off"},null)]),d("div",{class:`${te}-form-item`},[d("label",{class:`${te}-label`,for:`link-url-${l}`},[null==(i=t.value.linkModalTips)?void 0:i.urlLabel]),d("input",{placeholder:null==(r=t.value.linkModalTips)?void 0:r.urlLabelPlaceHolder,class:`${te}-input`,id:`link-url-${l}`,type:"text",value:n.url,onChange:e=>{n.url=e.target.value},autocomplete:"off"},null)]),d("div",{class:`${te}-form-item`},[d("button",{class:[`${te}-btn`,`${te}-btn-row`],type:"button",onClick:()=>{e.onOk(n),n.desc="",n.url=""}},[null==(s=t.value.linkModalTips)?void 0:s.buttonOK])])]}})}}),Ct=s({props:{visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},setup(e){const t=c("usedLanguageText"),l=c("editorId");let o=se.editorExtensions.cropper.instance;const n=m(),a=m(),i=m(),r=u({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let s=null;p((()=>e.visible),(()=>{e.visible&&!r.cropperInited&&(o=o||window.Cropper,n.value.onchange=()=>{if(!o)return void he.emit(l,Se,{name:"Cropper",message:"Cropper is undefined"});const e=n.value.files||[];if(r.imgSelected=!0,(null==e?void 0:e.length)>0){const t=new FileReader;t.onload=e=>{r.imgSrc=e.target.result,y((()=>{s=new o(a.value,{viewMode:2,preview:`.${te}-clip-preview-target`})}))},t.readAsDataURL(e[0])}})})),p((()=>[r.imgSelected]),(()=>{i.value.style=""})),p((()=>r.isFullscreen),(()=>{y((()=>{null==s||s.destroy(),i.value.style="",a.value&&(s=new o(a.value,{viewMode:2,preview:`.${te}-clip-preview-target`}))}))}));const v=()=>{s.clear(),s.destroy(),s=null,n.value.value="",r.imgSelected=!1};return()=>{var o;return d(We,{class:`${te}-modal-clip`,title:null==(o=t.value.clipModalTips)?void 0:o.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:r.isFullscreen,onAdjust:e=>{r.isFullscreen=e},width:"668px",height:"421px"},{default:()=>{var o,c;return[d("div",{class:`${te}-form-item ${te}-clip`},[d("div",{class:`${te}-clip-main`},[r.imgSelected?d("div",{class:`${te}-clip-cropper`},[d("img",{src:r.imgSrc,ref:a,style:{display:"none"},alt:""},null),d("div",{class:`${te}-clip-delete`,onClick:v},[d(qe,{name:"delete"},null)])]):d("div",{class:`${te}-clip-upload`,onClick:()=>{n.value.click()}},[d(qe,{name:"upload"},null)])]),d("div",{class:`${te}-clip-preview`},[d("div",{class:`${te}-clip-preview-target`,ref:i},null)])]),d("div",{class:`${te}-form-item`},[d("button",{class:`${te}-btn`,type:"button",onClick:()=>{if(s){const t=s.getCroppedCanvas();he.emit(l,Ie,[De(t.toDataURL("image/png"))],e.onOk),v()}}},[(null==(o=t.value.clipModalTips)?void 0:o.buttonUpload)||(null==(c=t.value.linkModalTips)?void 0:c.buttonOK)])]),d("input",{ref:n,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),Tt=s({props:{type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},setup:e=>()=>d(C,null,[d(wt,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),d(Ct,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}),xt=s({name:"MDEditorToolbar",props:kt,setup(e){const t=c("editorId"),l=c("usedLanguageText"),o=c("theme"),i=c("previewTheme"),r=c("language"),{fullscreenHandler:s}=(e=>{const t=c("editorId"),{editorExtensions:l,editorExtensionsAttrs:o}=se;let n=l.screenfull.instance;const a=m(!1),i=e=>{n?n.isEnabled&&(a.value=!0,(void 0===e?!n.isFullscreen:e)?n.request():n.exit()):he.emit(t,Se,{name:"fullscreen",message:"fullscreen is undefined"})},r=()=>{n&&n.isEnabled&&n.on("change",(()=>{(a.value||e.setting.fullscreen)&&(a.value=!1,e.updateSetting("fullscreen"))}))},s=()=>{n=window.screenfull,r()};return v((()=>{var e;r(),n||Pe("script",{...null==(e=o.screenfull)?void 0:e.js,src:l.screenfull.js,id:`${te}-screenfull`,onload:s},"screenfull")})),v((()=>{he.on(t,{name:be,callback:i})})),{fullscreenHandler:i}})(e),h=`${t}-toolbar-wrapper`,f=m(),k=u({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),$=(e,l)=>{he.emit(t,Ee,e,l)},w=u({type:"link",linkVisible:!1,clipVisible:!1}),T=m();v((()=>{he.on(t,{name:Fe,callback(e){w.type=e,w.linkVisible=!0}})}));const x=b((()=>{const t=e.toolbars.filter((t=>!e.toolbarsExclude.includes(t))),l=t.indexOf("=");return[-1===l?t:t.slice(0,l+1),-1===l?[]:t.slice(l,Number.MAX_SAFE_INTEGER)]})),S=m(),E=()=>{he.emit(t,Ie,Array.from(S.value.files||[])),S.value.value=""};v((()=>{S.value.addEventListener("change",E)}));const I=n=>{var c,u,m,p,v,f,b,y,C,T,x,E,I,F,A,L,H,M,j,B,O,P,N,D,V,R,z,q,W,_,U,K,G,Z,J,X,Y,Q,ee,le,oe,ae,ie,re,se,ce,de,me,pe,ve,be,ye,ke,$e,we,Ce,Te,xe,Se,Ie,Fe,He,Me,je,Be,Oe,Pe,Ne,De;if(!ne.includes(n)){if(e.defToolbars instanceof Array){const l=e.defToolbars[n];if(l){return g(l,{theme:o.value,previewTheme:i.value,language:r.value,insert(e){he.emit(t,Ee,"universal",{generate:e})}})}return""}if(e.defToolbars&&e.defToolbars.children instanceof Array){const l=e.defToolbars.children[n];if(l){return g(l,{theme:o.value,previewTheme:i.value,language:r.value,insert(e){he.emit(t,Ee,"universal",{generate:e})}})}return""}return""}switch(n){case"-":return d(yt,null,null);case"bold":return d("div",{class:`${te}-toolbar-item`,title:null==(c=l.value.toolbarTips)?void 0:c.bold,onClick:()=>{$("bold")}},[d(qe,{name:"bold"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(u=l.value.toolbarTips)?void 0:u.bold])]);case"underline":return d("div",{class:`${te}-toolbar-item`,title:null==(m=l.value.toolbarTips)?void 0:m.underline,onClick:()=>{$("underline")}},[d(qe,{name:"underline"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(p=l.value.toolbarTips)?void 0:p.underline])]);case"italic":return d("div",{class:`${te}-toolbar-item`,title:null==(v=l.value.toolbarTips)?void 0:v.italic,onClick:()=>{$("italic")}},[d(qe,{name:"italic"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(f=l.value.toolbarTips)?void 0:f.italic])]);case"strikeThrough":return d("div",{class:`${te}-toolbar-item`,title:null==(b=l.value.toolbarTips)?void 0:b.strikeThrough,onClick:()=>{$("strikeThrough")}},[d(qe,{name:"strike-through"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(y=l.value.toolbarTips)?void 0:y.strikeThrough])]);case"title":return d(ue,{relative:`#${h}`,visible:k.title,onChange:e=>{k.title=e},overlay:d("ul",{class:`${te}-menu`,onClick:()=>{k.title=!1}},[d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h1")}},[null==(C=l.value.titleItem)?void 0:C.h1]),d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h2")}},[null==(T=l.value.titleItem)?void 0:T.h2]),d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h3")}},[null==(x=l.value.titleItem)?void 0:x.h3]),d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h4")}},[null==(E=l.value.titleItem)?void 0:E.h4]),d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h5")}},[null==(I=l.value.titleItem)?void 0:I.h5]),d("li",{class:`${te}-menu-item ${te}-menu-item-title`,onClick:()=>{$("h6")}},[null==(F=l.value.titleItem)?void 0:F.h6])])},{default:()=>{var t,o;return[d("div",{class:`${te}-toolbar-item`,title:null==(t=l.value.toolbarTips)?void 0:t.title},[d(qe,{name:"title"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(o=l.value.toolbarTips)?void 0:o.title])])]}});case"sub":return d("div",{class:`${te}-toolbar-item`,title:null==(A=l.value.toolbarTips)?void 0:A.sub,onClick:()=>{$("sub")}},[d(qe,{name:"sub"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(L=l.value.toolbarTips)?void 0:L.sub])]);case"sup":return d("div",{class:`${te}-toolbar-item`,title:null==(H=l.value.toolbarTips)?void 0:H.sup,onClick:()=>{$("sup")}},[d(qe,{name:"sup"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(M=l.value.toolbarTips)?void 0:M.sup])]);case"quote":return d("div",{class:`${te}-toolbar-item`,title:null==(j=l.value.toolbarTips)?void 0:j.quote,onClick:()=>{$("quote")}},[d(qe,{name:"quote"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(B=l.value.toolbarTips)?void 0:B.quote])]);case"unorderedList":return d("div",{class:`${te}-toolbar-item`,title:null==(O=l.value.toolbarTips)?void 0:O.unorderedList,onClick:()=>{$("unorderedList")}},[d(qe,{name:"unordered-list"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(P=l.value.toolbarTips)?void 0:P.unorderedList])]);case"orderedList":return d("div",{class:`${te}-toolbar-item`,title:null==(N=l.value.toolbarTips)?void 0:N.orderedList,onClick:()=>{$("orderedList")}},[d(qe,{name:"ordered-list"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(D=l.value.toolbarTips)?void 0:D.orderedList])]);case"task":return d("div",{class:`${te}-toolbar-item`,title:null==(V=l.value.toolbarTips)?void 0:V.task,onClick:()=>{$("task")}},[d(qe,{name:"task"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(R=l.value.toolbarTips)?void 0:R.task])]);case"codeRow":return d("div",{class:`${te}-toolbar-item`,title:null==(z=l.value.toolbarTips)?void 0:z.codeRow,onClick:()=>{$("codeRow")}},[d(qe,{name:"code-row"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(q=l.value.toolbarTips)?void 0:q.codeRow])]);case"code":return d("div",{class:`${te}-toolbar-item`,title:null==(W=l.value.toolbarTips)?void 0:W.code,onClick:()=>{$("code")}},[d(qe,{name:"code"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(_=l.value.toolbarTips)?void 0:_.code])]);case"link":return d("div",{class:`${te}-toolbar-item`,title:null==(U=l.value.toolbarTips)?void 0:U.link,onClick:()=>{w.type="link",w.linkVisible=!0}},[d(qe,{name:"link"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(K=l.value.toolbarTips)?void 0:K.link])]);case"image":return e.noUploadImg?d("div",{class:`${te}-toolbar-item`,title:null==(G=l.value.toolbarTips)?void 0:G.image,onClick:()=>{w.type="image",w.linkVisible=!0}},[d(qe,{name:"image"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(Z=l.value.toolbarTips)?void 0:Z.image])]):d(ue,{relative:`#${h}`,visible:k.image,onChange:e=>{k.image=e},overlay:d("ul",{class:`${te}-menu`,onClick:()=>{k.title=!1}},[d("li",{class:`${te}-menu-item ${te}-menu-item-image`,onClick:()=>{w.type="image",w.linkVisible=!0}},[null==(J=l.value.imgTitleItem)?void 0:J.link]),d("li",{class:`${te}-menu-item ${te}-menu-item-image`,onClick:()=>{S.value.click()}},[null==(X=l.value.imgTitleItem)?void 0:X.upload]),d("li",{class:`${te}-menu-item ${te}-menu-item-image`,onClick:()=>{w.clipVisible=!0}},[null==(Y=l.value.imgTitleItem)?void 0:Y.clip2upload])])},{default:()=>{var t,o;return[d("div",{class:`${te}-toolbar-item`,title:null==(t=l.value.toolbarTips)?void 0:t.image},[d(qe,{name:"image"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(o=l.value.toolbarTips)?void 0:o.image])])]}});case"table":return d(ue,{relative:`#${h}`,visible:k.table,onChange:e=>{k.table=e},key:"bar-table",overlay:d($t,{tableShape:e.tableShape,onSelected:e=>{$("table",{selectedShape:e})}},null)},{default:()=>{var t,o;return[d("div",{class:`${te}-toolbar-item`,title:null==(t=l.value.toolbarTips)?void 0:t.table},[d(qe,{name:"table"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(o=l.value.toolbarTips)?void 0:o.table])])]}});case"revoke":return d("div",{class:`${te}-toolbar-item`,title:null==(Q=l.value.toolbarTips)?void 0:Q.revoke,onClick:()=>{he.emit(t,Ae)}},[d(qe,{name:"revoke"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(ee=l.value.toolbarTips)?void 0:ee.revoke])]);case"next":return d("div",{class:`${te}-toolbar-item`,title:null==(le=l.value.toolbarTips)?void 0:le.next,onClick:()=>{he.emit(t,Le)}},[d(qe,{name:"next"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(oe=l.value.toolbarTips)?void 0:oe.next])]);case"save":return d("div",{class:`${te}-toolbar-item`,title:null==(ae=l.value.toolbarTips)?void 0:ae.save,onClick:()=>{he.emit(t,ge)}},[d(qe,{name:"baocun"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(ie=l.value.toolbarTips)?void 0:ie.save])]);case"prettier":return e.noPrettier?"":d("div",{class:`${te}-toolbar-item`,title:null==(re=l.value.toolbarTips)?void 0:re.prettier,onClick:()=>{$("prettier")}},[d(qe,{name:"prettier"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(se=l.value.toolbarTips)?void 0:se.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&d("div",{class:`${te}-toolbar-item`,title:null==(ce=l.value.toolbarTips)?void 0:ce.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[d(qe,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(de=l.value.toolbarTips)?void 0:de.pageFullscreen])]);case"fullscreen":return d("div",{class:`${te}-toolbar-item`,title:null==(me=l.value.toolbarTips)?void 0:me.fullscreen,onClick:()=>{s()}},[d(qe,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(pe=l.value.toolbarTips)?void 0:pe.fullscreen])]);case"preview":return d("div",{class:`${te}-toolbar-item`,title:null==(ve=l.value.toolbarTips)?void 0:ve.preview,onClick:()=>{e.updateSetting("preview")}},[d(qe,{name:"preview"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(be=l.value.toolbarTips)?void 0:be.preview])]);case"previewOnly":return d("div",{class:`${te}-toolbar-item`,title:null==(ye=l.value.toolbarTips)?void 0:ye.previewOnly,onClick:()=>{e.updateSetting("previewOnly")}},[d(qe,{name:"preview-only"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(ke=l.value.toolbarTips)?void 0:ke.previewOnly])]);case"htmlPreview":return d("div",{class:`${te}-toolbar-item`,title:null==($e=l.value.toolbarTips)?void 0:$e.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[d(qe,{name:"coding"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(we=l.value.toolbarTips)?void 0:we.htmlPreview])]);case"catalog":return d("div",{class:`${te}-toolbar-item`,title:null==(Ce=l.value.toolbarTips)?void 0:Ce.catalog,onClick:()=>{he.emit(t,fe)},key:"bar-catalog"},[d(qe,{name:"catalog"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(Te=l.value.toolbarTips)?void 0:Te.catalog])]);case"github":return d("div",{class:`${te}-toolbar-item`,title:null==(xe=l.value.toolbarTips)?void 0:xe.github,onClick:()=>a("https://github.com/imzbf/md-editor-v3")},[d(qe,{name:"github"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(Se=l.value.toolbarTips)?void 0:Se.github])]);case"mermaid":return d(ue,{relative:`#${h}`,visible:k.mermaid,onChange:e=>{k.mermaid=e},overlay:d("ul",{class:`${te}-menu`,onClick:()=>{k.mermaid=!1}},[d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("flow")}},[null==(Ie=l.value.mermaid)?void 0:Ie.flow]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("sequence")}},[null==(Fe=l.value.mermaid)?void 0:Fe.sequence]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("gantt")}},[null==(He=l.value.mermaid)?void 0:He.gantt]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("class")}},[null==(Me=l.value.mermaid)?void 0:Me.class]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("state")}},[null==(je=l.value.mermaid)?void 0:je.state]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("pie")}},[null==(Be=l.value.mermaid)?void 0:Be.pie]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("relationship")}},[null==(Oe=l.value.mermaid)?void 0:Oe.relationship]),d("li",{class:`${te}-menu-item ${te}-menu-item-mermaid`,onClick:()=>{$("journey")}},[null==(Pe=l.value.mermaid)?void 0:Pe.journey])]),key:"bar-mermaid"},{default:()=>{var t,o;return[d("div",{class:`${te}-toolbar-item`,title:null==(t=l.value.toolbarTips)?void 0:t.mermaid},[d(qe,{name:"mermaid"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(o=l.value.toolbarTips)?void 0:o.mermaid])])]}});case"katex":return d(ue,{relative:`#${h}`,visible:k.katex,onChange:e=>{k.katex=e},overlay:d("ul",{class:`${te}-menu`,onClick:()=>{k.katex=!1}},[d("li",{class:`${te}-menu-item ${te}-menu-item-katex`,onClick:()=>{$("katexInline")}},[null==(Ne=l.value.katex)?void 0:Ne.inline]),d("li",{class:`${te}-menu-item ${te}-menu-item-katex`,onClick:()=>{$("katexBlock")}},[null==(De=l.value.katex)?void 0:De.block])]),key:"bar-katex"},{default:()=>{var t,o;return[d("div",{class:`${te}-toolbar-item`,title:null==(t=l.value.toolbarTips)?void 0:t.katex},[d(qe,{name:"formula"},null),e.showToolbarName&&d("div",{class:`${te}-toolbar-item-name`},[null==(o=l.value.toolbarTips)?void 0:o.katex])])]}})}};return p((()=>e.toolbars),(()=>{y((()=>{f.value&&n(f.value)}))}),{immediate:!0}),()=>{const t=x.value[0].map((e=>I(e))),l=x.value[1].map((e=>I(e)));return d(C,null,[e.toolbars.length>0&&d("div",{class:`${te}-toolbar-wrapper`,ref:f,id:h},[d("div",{class:[`${te}-toolbar`,e.showToolbarName&&`${te}-stn`]},[d("div",{class:`${te}-toolbar-left`,ref:T},[t]),d("div",{class:`${te}-toolbar-right`},[l])])]),d("input",{ref:S,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),d(Tt,{linkVisible:w.linkVisible,clipVisible:w.clipVisible,type:w.type,onCancel:()=>{w.linkVisible=!1,w.clipVisible=!1},onOk:e=>{e&&$(w.type,{desc:e.desc,url:e.url,transform:"image"===w.type}),w.linkVisible=!1,w.clipVisible=!1}},null)])}}}),St=`.${te}-preview > [data-line]`,Et=(e,t)=>{const o=l((()=>{e.removeEventListener("scroll",n),e.addEventListener("scroll",n),t.removeEventListener("scroll",n),t.addEventListener("scroll",n)}),50),n=l=>{const a=e.clientHeight,i=t.clientHeight,r=(e.scrollHeight-a)/(t.scrollHeight-i);l.target===e?(t.removeEventListener("scroll",n),t.scrollTo({top:e.scrollTop/r}),o()):(e.removeEventListener("scroll",n),e.scrollTo({top:t.scrollTop*r}),o())};return[()=>{o().finally((()=>{e.dispatchEvent(new Event("scroll"))}))},()=>{e.removeEventListener("scroll",n),t.removeEventListener("scroll",n)}]},It=(e,t,l)=>{const{view:o}=l,n=r(),a=e=>o.lineBlockAt(o.state.doc.line(e).from).top,s=e=>o.lineBlockAt(o.state.doc.line(e).from).height;let c=[],d=[],u=[];let m=0,p=0;const v=i((l=>{var i;const{scrollDOM:r,contentHeight:v}=o;return!(v<=r.clientHeight||t.firstElementChild.clientHeight<=t.clientHeight)&&(!(o.state.doc.lines<(null==(i=c[c.length-1])?void 0:i.end))&&void(l.target===e?(()=>{var e,l;if(0!==p)return!1;m++;const{scrollDOM:i,contentHeight:r}=o;let d=+getComputedStyle(t).paddingTop.replace("px","");const u=o.lineBlockAtHeight(i.scrollTop),{number:v}=o.state.doc.lineAt(u.from),h=c[v-1];if(!h)return!1;let g=a(h.end)+s(h.end),f=0;const b=a(h.start),y=t.querySelector(`[data-line="${h.start-1}"]`)||(null==(e=t.firstElementChild)?void 0:e.firstElementChild),k=t.querySelector(`[data-line="${h.end}"]`)||(null==(l=t.lastElementChild)?void 0:l.lastElementChild);let $=0,w=0;0===b?(f=i.scrollTop/g,y===k?(d=0,g=r-i.offsetHeight,$=k.offsetTop+k.offsetHeight-t.clientHeight):$=k.offsetTop):(f=(i.scrollTop-b)/(g-b),w=y.offsetTop,$=k.offsetTop-w),g>=i.scrollHeight-i.clientHeight&&(f=(i.scrollTop-b)/(i.scrollHeight-i.clientHeight-b),w=y.offsetTop,$=t.scrollHeight-t.clientHeight-w+10),n(t,w-d+$*f,(()=>{m--}))})():(()=>{var l,i,r,v,h,g;if(0!==m)return;p++;const{scrollDOM:f}=o,b=t.scrollTop,y=t.scrollHeight;let k=null==(l=t.firstElementChild)?void 0:l.firstElementChild,$=null==(i=t.firstElementChild)?void 0:i.lastElementChild;if(u.length>0){let e=Math.ceil(Number(u[u.length-1])*(b/y)),l=u.findLastIndex((t=>t<=e));l=-1===l?0:l,e=u[l];for(let t=l;t>=0&&t<u.length;){if(d[t].offsetTop>b){if(t-1>=0){t--;continue}e=-1,l=t;break}if(!(t+1<u.length&&d[t+1].offsetTop<b)){e=u[t],l=t;break}t++}switch(e){case-1:k=null==(r=t.firstElementChild)?void 0:r.firstElementChild,$=d[l];break;case u.length-1:k=d[l],$=null==(v=t.firstElementChild)?void 0:v.lastElementChild;break;default:k=d[l],$=d[l+1===d.length?l:l+1]}}const w=k===(null==(h=t.firstElementChild)?void 0:h.firstElementChild)?0:k.offsetTop;let C=$.offsetTop,T=0;const{start:x,end:S}=c[Number(k.dataset.line||0)],E=a(x);let I=a(S===o.state.doc.lines?S:S+1),F=0;I>f.scrollHeight-f.clientHeight||$.scrollTop>t.scrollHeight-t.clientHeight?(T=Math.max((b-w)/(t.scrollHeight-w-t.clientHeight),0),I=a(o.state.doc.lines)+s(o.state.doc.lines),F=8+I-E-e.clientHeight):k===(null==(g=t.firstElementChild)?void 0:g.firstElementChild)?(k===$?(C=$.offsetTop+$.offsetHeight+ +getComputedStyle($).marginBottom.replace("px",""),F=I):F=I,T=Math.max(b/C,0)):(T=Math.max((b-w)/(C-w),0),F=I-E),n(e,E+F*T,(()=>{p--}))})()))}),1);return[()=>{(()=>{c=[],d=[],u=[],d=d.concat(Array.from(t.querySelectorAll(St)));const e=d.map((e=>Number(e.dataset.line)+1));u=u.concat(e);const{lines:l}=o.state.doc;let n=1,a=e.shift()??l;for(let t=1;t<=l;t++)t===a&&(n=t,a=e.shift()||l+1),c.push({start:n,end:a-1})})(),e.addEventListener("scroll",v),t.addEventListener("scroll",v),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",v),t.removeEventListener("scroll",v)}]},Ft=(e,t,l)=>{var o;let n="",a=0,i=0,r=!0,s=!1;const c=t.getSelectedText(),d=se.editorConfig.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const t=e.replace(/^h(\d)/,((e,t)=>new Array(Number(t)).fill("#",0,t).join("")));n=`${t} ${c}`,a=t.length+1}else if("prettier"===e){const e=window.prettier||se.editorExtensions.prettier.prettierInstance,a=[(null==(o=window.prettierPlugins)?void 0:o.markdown)||se.editorExtensions.prettier.parserMarkdownInstance];e&&void 0!==a[0]?n=e.format(t.getValue(),{parser:"markdown",plugins:a}):(he.emit(l.editorId,Se,{name:"prettier",message:"prettier is undefined"}),n=t.getValue()),r=!1,s=!0}else switch(e){case"bold":n=`**${c}**`,a=2,i=-2;break;case"underline":n=`<u>${c}</u>`,a=3,i=-4;break;case"italic":n=`*${c}*`,a=1,i=-1;break;case"strikeThrough":n=`~~${c}~~`,a=2,i=-2;break;case"sub":n=`<sub>${c}</sub>`,a=5,i=-6;break;case"sup":n=`<sup>${c}</sup>`,a=5,i=-6;break;case"codeRow":n="`"+c+"`",a=1,i=-1;break;case"quote":n=`> ${c}`,a=2;break;case"orderedList":n=`1. ${c}`,a=3;break;case"unorderedList":n=`- ${c}`,a=2;break;case"task":n=`- [ ] ${c}`,a=6;break;case"code":{const e=l.text||c||"",t=l.mode||"language";n=`\`\`\`${t}\n${e}\n\`\`\`\n`,a=3,i=3+t.length-n.length;break}case"table":{n="|";const{selectedShape:e={x:1,y:1}}=l,{x:t,y:o}=e;for(let l=0;l<=o;l++)n+=" col |";n+="\n|";for(let l=0;l<=o;l++)n+=" - |";for(let l=0;l<=t;l++){n+="\n|";for(let e=0;e<=o;e++)n+=" content |"}a=2,i=5-n.length;break}case"link":{const{desc:e,url:t}=l;n=`[${e}](${t})`,r=!1;break}case"image":{const{desc:e,url:t,urls:o}=l;n=o instanceof Array?o.reduce(((e,t)=>{const{url:l="",alt:o="",title:n=""}="object"==typeof t?t:{url:t};return e+`![${o}](${l}${n?" '"+n+"'":""})\n`}),""):`![${e}](${t})\n`,r=!1;break}case"flow":n=`\`\`\`mermaid\n${(null==d?void 0:d.flow)||"flowchart TD \n  Start --\x3e Stop"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"sequence":n=`\`\`\`mermaid\n${(null==d?void 0:d.sequence)||"sequenceDiagram\n  A->>B: hello!\n  B--\x3e>A: hi!\n  A-)B: bye!"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"gantt":n=`\`\`\`mermaid\n${(null==d?void 0:d.gantt)||"gantt\ntitle A Gantt Diagram\ndateFormat  YYYY-MM-DD\nsection Section\nA task  :a1, 2014-01-01, 30d\nAnother task  :after a1, 20d"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"class":n=`\`\`\`mermaid\n${(null==d?void 0:d.class)||"classDiagram\n  class Animal\n  Vehicle <|-- Car"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"state":n=`\`\`\`mermaid\n${(null==d?void 0:d.state)||"stateDiagram-v2\n  s1 --\x3e s2"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"pie":n=`\`\`\`mermaid\n${(null==d?void 0:d.pie)||'pie title Pets adopted by volunteers\n  "Dogs" : 386\n  "Cats" : 85\n  "Rats" : 15'}\n\`\`\`\n`,a=3,i=10-n.length;break;case"relationship":n=`\`\`\`mermaid\n${(null==d?void 0:d.relationship)||"erDiagram\n  CAR ||--o{ NAMED-DRIVER : allows\n  PERSON ||--o{ NAMED-DRIVER : is"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"journey":n=`\`\`\`mermaid\n${(null==d?void 0:d.journey)||"journey\n  title My working day\n  section Go to work\n    Make tea: 5: Me\n    Go upstairs: 3: Me\n    Do work: 1: Me, Cat\n  section Go home\n    Go downstairs: 5: Me\n    Sit down: 5: Me"}\n\`\`\`\n`,a=3,i=10-n.length;break;case"katexInline":n="$$",a=1,i=-1;break;case"katexBlock":n="$$\n\n$$\n",a=3,i=-4;break;case"universal":{const{generate:e}=l,t=e(c);n=t.targetValue,r=t.select??!0,a=t.deviationStart||0,i=t.deviationEnd||0}}return{text:n,options:{select:r,deviationStart:a,deviationEnd:i,replaceAll:s}}},At="var(--md-color)",Lt="var(--md-color)",Ht="#e5c07b",Mt="#d19a66",jt="var(--md-bk-color)",Bt="var(--md-bk-color)",Ot="#528bff",Pt=[S.theme({"&":{color:Lt,backgroundColor:jt},".cm-content":{caretColor:Ot},".cm-cursor, .cm-dropCursor":{borderLeftColor:Ot},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#ceedfa33"},".cm-panels":{backgroundColor:"#21252b",color:Lt},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:jt,color:Lt,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:"#2c313a"},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Bt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Bt,borderBottomColor:Bt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:Lt}}},{dark:!0}),I(E.define([{tag:K.keyword,color:"#c678dd"},{tag:[K.name,K.deleted,K.character,K.propertyName,K.macroName],color:At},{tag:[K.function(K.variableName),K.labelName],color:"#e5c07b"},{tag:[K.color,K.constant(K.name),K.standard(K.name)],color:Mt},{tag:[K.definition(K.name),K.separator],color:Lt},{tag:[K.typeName,K.className,K.number,K.changed,K.annotation,K.modifier,K.self,K.namespace],color:"#e5c07b"},{tag:[K.operator,K.operatorKeyword,K.url,K.escape,K.regexp,K.link,K.special(K.string)],color:"#56b6c2"},{tag:[K.meta,K.comment],color:Ht},{tag:K.strong,fontWeight:"bold"},{tag:K.emphasis,fontStyle:"italic"},{tag:K.strikethrough,textDecoration:"line-through"},{tag:K.link,color:Ht,textDecoration:"underline"},{tag:K.heading,fontWeight:"bold",color:At},{tag:[K.atom,K.bool,K.special(K.variableName)],color:Mt},{tag:[K.processingInstruction,K.string,K.inserted],color:"var(--md-color)"},{tag:K.invalid,color:"#ffffff"}]))],Nt="#3f4a54",Dt="#3f4a54",Vt="#2d8cf0",Rt="#d19a66",zt="var(--md-bk-color)",qt="var(--md-bk-color)",Wt="#3f4a54",_t=[S.theme({"&":{color:Dt,backgroundColor:zt},".cm-content":{caretColor:Wt},".cm-cursor, .cm-dropCursor":{borderLeftColor:Wt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#bad5fa"},".cm-panels":{backgroundColor:"#f6f6f6",color:Dt},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:zt,color:Dt,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:"#ceedfa33"},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:qt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:qt,borderBottomColor:qt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:Dt}}}),I(E.define([{tag:K.keyword,color:"#c678dd"},{tag:[K.name,K.deleted,K.character,K.propertyName,K.macroName],color:Nt},{tag:[K.function(K.variableName),K.labelName],color:"#2d8cf0"},{tag:[K.color,K.constant(K.name),K.standard(K.name)],color:Rt},{tag:[K.definition(K.name),K.separator],color:Dt},{tag:[K.typeName,K.className,K.number,K.changed,K.annotation,K.modifier,K.self,K.namespace],color:"#e5c07b"},{tag:[K.operator,K.operatorKeyword,K.url,K.escape,K.regexp,K.link,K.special(K.string)],color:"#56b6c2"},{tag:[K.meta,K.comment],color:Vt},{tag:K.strong,fontWeight:"bold"},{tag:K.emphasis,fontStyle:"italic"},{tag:K.strikethrough,textDecoration:"line-through"},{tag:K.link,color:Vt,textDecoration:"underline"},{tag:K.heading,fontWeight:"bold",color:Nt},{tag:[K.atom,K.bool,K.special(K.variableName)],color:Rt},{tag:[K.processingInstruction,K.string,K.inserted],color:"#3f4a54"},{tag:K.invalid,color:"#fff"}]))],Ut=(e,t,l,o,n)=>(a,i,r,s)=>{const c=`${e}${t}`.slice(s-r);a.dispatch(a.state.replaceSelection(`${c}${l}${o}`));const d=r+i.label.length+("title"===n?l.length:0);a.dispatch({selection:N.create([N.range(r+i.label.length+("title"===n?1:-t.length),d),N.cursor(d)],1)}),a.focus()},Kt=e=>(t,l,o,n)=>{const a=e.slice(n-o);t.dispatch(t.state.replaceSelection(`${a} `))},Gt=e=>{const t=e=>{const t=e.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|\$\$?|!+\s*\w*/);return null===t||t.from==t.to&&e.explicit?null:{from:t.from,options:[...["h1","h2","h3","h4","h5","h6"].map(((e,t)=>{const l=new Array(t+1).fill("#").join("");return{label:l,type:"text",apply:Kt(l)}})),...["unchecked","checked"].map((e=>{const t="checked"===e?"- [x]":"- [ ]";return{label:t,type:"text",apply:Kt(t)}})),...[["`",""],["```","language"],["```mermaid\n",""]].map((e=>({label:`${e[0]}${e[1]}`,type:"text",apply:Ut(e[0],e[1],"","`"===e[0]?"`":"\n```","type")}))),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:"| col | col | col |\n| - | - | - |\n| content | content | content |\n| content | content | content |"},{label:"$",type:"text",apply:Ut("$","","","$","type")},{label:"$$",type:"text",apply:Ut("$$","","\n","\n$$","title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map((e=>({label:`!!! ${e}`,type:"text",apply:Ut("!!!",` ${e}`," Title","\n\n!!!","title")})))]}};return P({override:e?[t,...e]:[t]})},Zt=e=>{const t=new z;return l=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(l)}):e.dispatch({effects:_.appendConfig.of(t.of(l))}),!0)};class Jt{constructor(e){bt(this,"view"),bt(this,"maxLength",Number.MAX_SAFE_INTEGER),bt(this,"toggleTabSize"),bt(this,"togglePlaceholder"),bt(this,"setExtensions"),bt(this,"toggleDisabled"),bt(this,"toggleReadOnly"),bt(this,"toggleMaxlength"),this.view=e,this.toggleTabSize=Zt(this.view),this.togglePlaceholder=Zt(this.view),this.setExtensions=Zt(this.view),this.toggleDisabled=Zt(this.view),this.toggleReadOnly=Zt(this.view),this.toggleMaxlength=Zt(this.view)}getValue(){return this.view.state.doc.toString()}setValue(e,t=0,l=this.view.state.doc.length){this.view.dispatch({changes:{from:t,to:l,insert:e}})}getSelectedText(){const{from:e,to:t}=this.view.state.selection.main;return this.view.state.sliceDoc(e,t)}replaceSelectedText(e,t={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},l){try{if(t.replaceAll){if(this.setValue(e),e.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+e.length>this.maxLength)throw new Error("The input text is too long");const{from:l}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(e)),t.select){const o=l+e.length+t.deviationEnd;this.view.dispatch({selection:N.create([N.range(l+t.deviationStart,o),N.cursor(o)],1)})}this.view.focus()}catch(o){if("The input text is too long"!==o.message)throw o;he.emit(l,Se,{name:"overlength",message:o.message,data:e})}}setTabSize(e){this.toggleTabSize([D.tabSize.of(e),V.of(" ".repeat(e))])}setPlaceholder(e){this.togglePlaceholder(R(e))}focus(e){if(this.view.focus(),!e)return;let t=0,l=0,o=0;switch(e){case"start":break;case"end":t=l=o=this.getValue().length;break;default:t=e.rangeAnchor||e.cursorPos,l=e.rangeHead||e.cursorPos,o=e.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:N.create([N.range(t,l),N.cursor(o)],1)})}setDisabled(e){this.toggleDisabled([S.editable.of(!e)])}setReadOnly(e){this.toggleReadOnly([D.readOnly.of(e)])}setMaxLength(e){this.maxLength=e,this.toggleMaxlength([D.changeFilter.of((t=>t.newDoc.length<=e))])}}const Xt=e=>{const t=c("tabWidth"),l=c("editorId"),o=c("theme"),n=m(),a=f(),r=new z,s=new z,d=new z,u=new z,h=new z,g=(b=l,y=e,[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(he.emit(b,Ee,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:U,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:e=>(he.emit(b,ge,e.state.doc.toString()),!0),shift:()=>(he.emit(b,Ee,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>(he.emit(b,Ee,"underline"),!0),shift:()=>(he.emit(b,Ee,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>(he.emit(b,Ee,"italic"),!0),shift:()=>(he.emit(b,Fe,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(he.emit(b,Ee,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(he.emit(b,Ee,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(he.emit(b,Ee,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(he.emit(b,Ee,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(he.emit(b,Ee,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(he.emit(b,Ee,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(he.emit(b,Ee,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(he.emit(b,Ee,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(he.emit(b,Ee,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(he.emit(b,Ee,"code"),!0),any:(e,t)=>!(!t.ctrlKey&&!t.metaKey||!t.altKey||"KeyC"!==t.code||(he.emit(b,Ee,"codeRow"),0))},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(he.emit(b,Fe,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>!y.noPrettier&&(he.emit(b,Ee,"prettier"),!0)},{any:(e,t)=>!(!t.ctrlKey&&!t.metaKey||!t.altKey||!t.shiftKey||"KeyT"!==t.code||(he.emit(b,Ee,"table"),0))},...W]);var b,y;const k=m(!1),$=((e,t)=>{const l=c("editorId"),o=e=>{e instanceof Promise?e.then((e=>{he.emit(l,Ee,"universal",{generate:()=>({targetValue:e})})})).catch((e=>{})):he.emit(l,Ee,"universal",{generate:()=>({targetValue:e})})};return n=>{var a,i,r;if(!n.clipboardData)return;if(n.clipboardData.files.length>0){const{files:e}=n.clipboardData;return he.emit(l,Ie,Array.from(e).filter((e=>/image\/.*/.test(e.type)))),void n.preventDefault()}const s=n.clipboardData.getData("text/plain"),c=(null==(a=t.value)?void 0:a.view.state.selection.main.to)||0,d=(null==(i=t.value)?void 0:i.view.state.doc.lineAt(c).from)||0,u=(null==(r=t.value)?void 0:r.view.state.doc.sliceString(d,c))||"",m=/!\[.*\]\(\s*$/.test(u),p=/!\[.*\]\((.*)\s?.*\)/.test(s);if(m){const t=e.transformImgUrl(s);return o(t),void n.preventDefault()}if(p){const t=s.match(new RegExp("(?<=!\\[.*\\]\\()([^)\\s]+)(?=\\s?[\"']?.*[\"']?\\))","g"));return t?Promise.all(t.map((t=>e.transformImgUrl(t)))).then((e=>{o(e.reduce(((e,l,o)=>e.replace(t[o],l)),s))})):o(s),void n.preventDefault()}if(e.autoDetectCode&&n.clipboardData.types.includes("vscode-editor-data")){const e=JSON.parse(n.clipboardData.getData("vscode-editor-data"));return he.emit(l,Ee,"code",{mode:e.mode,text:n.clipboardData.getData("text/plain")}),void n.preventDefault()}e.maxlength&&s.length+e.modelValue.length>e.maxlength&&he.emit(l,Se,{name:"overlength",message:"The input text is too long",data:s})}})(e,a),w={paste:$,blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,compositionstart:()=>{k.value=!0},compositionend:(t,l)=>{k.value=!1,e.updateModelValue(l.state.doc.toString())},input:t=>{e.onInput&&e.onInput(t);const{data:o}=t;e.maxlength&&e.modelValue.length+o.length>e.maxlength&&he.emit(l,Se,{name:"overlength",message:"The input text is too long",data:o})}},C=[F.of([...A,...L,...g,H]),u.of(M()),r.of(j({codeLanguages:q})),S.lineWrapping,S.updateListener.of((t=>{t.docChanged&&(e.onChange(t.state.doc.toString()),k.value||e.updateModelValue(t.state.doc.toString()))})),h.of(S.domEventHandlers(w))],T=()=>{const t=[...C,s.of("light"===o.value?_t:Pt),d.of(Gt(e.completions))];return se.codeMirrorExtensions(o.value,t,[...g])};return v((()=>{const o=new S({doc:e.modelValue,parent:n.value,extensions:[T()]}),r=new Jt(o);a.value=r,setTimeout((()=>{r.setTabSize(t),r.setDisabled(e.disabled),r.setReadOnly(e.readonly),e.placeholder&&r.setPlaceholder(e.placeholder),"number"==typeof e.maxlength&&r.setMaxLength(e.maxlength),e.autofocus&&o.focus()}),0),he.on(l,{name:Ae,callback(){B(o)}}),he.on(l,{name:Le,callback(){O(o)}}),he.on(l,{name:Ee,callback(t,o={}){var n,i;if("image"===t&&o.transform){const i=e.transformImgUrl(o.url);if(i instanceof Promise)i.then((e=>{var n;const{text:i,options:r}=Ft(t,a.value,{...o,url:e});null==(n=a.value)||n.replaceSelectedText(i,r,l)})).catch((e=>{}));else{const{text:e,options:r}=Ft(t,a.value,{...o,url:i});null==(n=a.value)||n.replaceSelectedText(e,r,l)}}else{const{text:e,options:n}=Ft(t,a.value,o);null==(i=a.value)||i.replaceSelectedText(e,n,l)}}}),he.on(l,{name:Be,callback:i((e=>{var t;const l={...w},o=Object.keys(w);for(const n in e){const t=n;o.includes(t)?l[t]=(l,o)=>{e[t](l,o),l.defaultPrevented||w[t](l,o)}:l[t]=e[t]}null==(t=a.value)||t.view.dispatch({effects:h.reconfigure(S.domEventHandlers(l))})}))})})),p(o,(()=>{var e;null==(e=a.value)||e.view.dispatch({effects:s.reconfigure("light"===o.value?_t:Pt)})}),{deep:!0}),p((()=>e.completions),(()=>{var t;null==(t=a.value)||t.view.dispatch({effects:d.reconfigure(Gt(e.completions))})}),{deep:!0}),p((()=>e.modelValue),(()=>{var t,l;(null==(t=a.value)?void 0:t.getValue())!==e.modelValue&&(null==(l=a.value)||l.setValue(e.modelValue))})),p((()=>e.placeholder),(()=>{var t;null==(t=a.value)||t.setPlaceholder(e.placeholder)})),p((()=>e.disabled),(()=>{var t;null==(t=a.value)||t.setDisabled(e.disabled)})),p((()=>e.readonly),(()=>{var t;null==(t=a.value)||t.setDisabled(e.readonly)})),p((()=>e.maxlength),(()=>{var t;e.maxlength&&(null==(t=a.value)||t.setMaxLength(e.maxlength))})),{inputWrapperRef:n,codeMirrorUt:a,resetHistory(){var e,t;null==(e=a.value)||e.view.dispatch({effects:u.reconfigure([])}),null==(t=a.value)||t.view.dispatch({effects:u.reconfigure(M())})}}},Yt=s({name:"MDEditorContent",props:ot,setup(e,t){const l=c("editorId"),o=m(""),n=m(),a=m(),{inputWrapperRef:i,codeMirrorUt:r,resetHistory:s}=Xt(e),{inputWrapperStyle:g,resizeOperateStyle:f}=((e,t,l)=>{const o=u({resizedWidth:e.inputBoxWitdh}),n=u({width:e.inputBoxWitdh}),a=u({left:e.inputBoxWitdh,display:"initial"}),i=l=>{var i,r,s;const c=(null==(i=t.value)?void 0:i.offsetWidth)||0,d=(null==(r=t.value)?void 0:r.getBoundingClientRect().x)||0;let u=l.x-d;u<ce?u=ce:u>c-ce&&(u=c-ce);const m=`${u}px`;n.width=m,a.left=m,o.resizedWidth=m,null==(s=e.onInputBoxWitdhChange)||s.call(e,m)},r=()=>{document.addEventListener("mousemove",i)},s=()=>{document.removeEventListener("mousemove",i)};return p([l],(()=>{var e,t;null==(e=l.value)||e.addEventListener("mousedown",r),null==(t=l.value)||t.addEventListener("mouseup",s)}),{immediate:!0}),h((()=>{var e,t;null==(e=l.value)||e.removeEventListener("mousedown",r),null==(t=l.value)||t.removeEventListener("mouseup",s)})),p((()=>e.inputBoxWitdh),(e=>{e&&(n.width=e,a.left=e)})),p([T(e.setting,"htmlPreview"),T(e.setting,"preview")],(()=>{e.setting.htmlPreview||e.setting.preview?(n.width=o.resizedWidth,a.display="initial"):(n.width="100%",a.display="none")}),{immediate:!0}),p((()=>e.setting.previewOnly),(e=>{e?(n.width="0%",a.display="none"):(n.width=o.resizedWidth,a.display="initial")})),{inputWrapperStyle:n,resizeOperateStyle:a}})(e,n,a);return((e,t,l)=>{const o=c("editorId");let n=()=>{},a=()=>{};const i=()=>{n();const t=document.querySelector(`#${o} .cm-scroller`),i=document.querySelector(`[id="${o}-preview-wrapper"]`),r=document.querySelector(`[id="${o}-html-wrapper"]`);if(i||r){const o=i?It:Et,s=i||r;[a,n]=o(t,s,l.value),e.scrollAuto&&a()}};p([t,T(e.setting,"preview"),T(e.setting,"htmlPreview"),T(e.setting,"fullscreen"),T(e.setting,"pageFullscreen")],(()=>{y(i)})),p((()=>e.scrollAuto),(e=>{e?a():n()})),p((()=>e.setting.previewOnly),(e=>{e?n():a()})),v(i)})(e,o,r),t.expose({getSelectedText(){var e;return null==(e=r.value)?void 0:e.getSelectedText()},focus(e){var t;null==(t=r.value)||t.focus(e)},resetHistory:s}),()=>d("div",{class:`${te}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:n},[d("div",{class:`${te}-input-wrapper`,style:g,ref:i},null),(e.setting.htmlPreview||e.setting.preview)&&d("div",{class:`${te}-resize-operate`,style:f,ref:a},null),d(nt,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:t=>{o.value=t,e.onHtmlChanged(t)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.catalogVisible&&d(vt,{theme:e.theme,class:`${te}-catalog-editor`,editorId:l,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),Qt=s({props:{modelValue:{type:String,default:""}},setup(e){const t=c("usedLanguageText");return()=>{var l,o;return d("div",{class:`${te}-footer-item`},[d("label",{class:`${te}-footer-label`},[`${null==(l=t.value.footer)?void 0:l.markdownTotal}:`]),d("span",null,[(null==(o=e.modelValue)?void 0:o.length)||0])])}}}),el=s({props:{checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},setup:e=>()=>d("div",{class:[`${te}-checkbox`,e.checked&&`${te}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}),tl=s({props:{scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},setup(e){const t=c("usedLanguageText");return()=>{var l;return d("div",{class:`${te}-footer-item`},[d("label",{class:`${te}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[null==(l=t.value.footer)?void 0:l.scrollAuto]),d(el,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),ll=s({name:"MDEditorFooter",props:{modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},setup(e){const t=b((()=>{const t=e.footers.indexOf("=");return[-1===t?e.footers:e.footers.slice(0,t),-1===t?[]:e.footers.slice(t,Number.MAX_SAFE_INTEGER)]})),l=t=>{if(!ae.includes(t))return e.defFooters instanceof Array?e.defFooters[t]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[t]||"";switch(t){case"markdownTotal":return d(Qt,{modelValue:e.modelValue},null);case"scrollSwitch":return d(tl,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}};return()=>{const e=t.value[0].map((e=>l(e))),o=t.value[1].map((e=>l(e)));return d("div",{class:`${te}-footer`},[d("div",{class:`${te}-footer-left`},[e]),d("div",{class:`${te}-footer-right`},[o])])}}}),ol=s({name:"MdEditorV3",props:st,emits:dt,setup(e,t){const{editorId:l,noKatex:o,noMermaid:n,noPrettier:a,noUploadImg:i,noHighlight:r}=e,s=u({scrollAuto:e.scrollAuto}),c=m();((e,t)=>{const{editorId:l}=e,o=u({buildFinished:!1,html:""});p((()=>e.modelValue),(()=>{o.buildFinished=!1})),v((()=>{he.on(l,{name:xe,callback(e){o.buildFinished=!0,o.html=e}}),he.on(l,{name:ge,callback(){const n=new Promise((e=>{if(o.buildFinished)e(o.html);else{const t=o=>{e(o),he.remove(l,xe,t)};he.on(l,{name:xe,callback:t})}}));e.onSave?e.onSave(e.modelValue,n):t.emit("onSave",e.modelValue,n)}})}))})(e,t),(e=>{at(e),w("tabWidth",e.tabWidth)})(e),(e=>{const{noPrettier:t,noUploadImg:l}=e,{editorExtensions:o,editorExtensionsAttrs:n}=se,a=t||o.prettier.prettierInstance,i=t||o.prettier.parserMarkdownInstance,r=l||o.cropper.instance;v((()=>{if(!r){const{js:e={},css:t={}}=n.cropper||{};Pe("link",{...t,rel:"stylesheet",href:o.cropper.css,id:`${te}-cropperCss`}),Pe("script",{...e,src:o.cropper.js,id:`${te}-cropper`})}if(!a){const{standaloneJs:e={}}=n.prettier||{};Pe("script",{...e,src:o.prettier.standaloneJs,id:`${te}-prettier`})}if(!i){const{parserMarkdownJs:e={}}=n.prettier||{};Pe("script",{...e,src:o.prettier.parserMarkdownJs,id:`${te}-prettierMD`})}})),it(e)})(e),((e,t)=>{const{editorId:l}=e;v((()=>{he.on(l,{name:Se,callback:l=>{e.onError instanceof Function?e.onError(l):t.emit("onError",l)}})}))})(e,t);const[g,f]=((e,t)=>{const{editorId:l}=e,o=u({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:!e.preview&&e.htmlPreview,previewOnly:!1});let n="";const a=()=>{o.pageFullscreen||o.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=n};return p((()=>[o.pageFullscreen,o.fullscreen]),a),v((()=>{he.on(l,{name:Ie,callback(o,n){const a=e=>{he.emit(l,Ee,"image",{desc:"",urls:e}),n&&n()};e.onUploadImg?e.onUploadImg(o,a):t.emit("onUploadImg",o,a)}}),n=document.body.style.overflow,a()})),[o,(e,t)=>{o[e]=void 0===t?!o[e]:t,"preview"===e?(o.htmlPreview=!1,o.previewOnly=!1):"htmlPreview"===e?(o.preview=!1,o.previewOnly=!1):"previewOnly"!==e||o.preview||o.htmlPreview||(o.preview=!0)}]})(e,t),y=(e=>{const{editorId:t}=e,l=m(!1);return v((()=>{he.on(t,{name:fe,callback:e=>{l.value=void 0===e?!l.value:e}})})),b((()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&l.value))})(e);return h((()=>{he.clear(l)})),((e,t,l,o,n,a)=>{const{editorId:i}=e;p((()=>o.pageFullscreen),(e=>{he.emit(i,ye,e)})),p((()=>o.fullscreen),(e=>{he.emit(i,ke,e)})),p((()=>o.preview),(e=>{he.emit(i,$e,e)})),p((()=>o.previewOnly),(e=>{he.emit(i,we,e)})),p((()=>o.htmlPreview),(e=>{he.emit(i,Ce,e)})),p(l,(e=>{he.emit(i,Te,e)}));const r={on(e,t){switch(e){case"pageFullscreen":he.on(i,{name:ye,callback(e){t(e)}});break;case"fullscreen":he.on(i,{name:ke,callback(e){t(e)}});break;case"preview":he.on(i,{name:$e,callback(e){t(e)}});break;case"previewOnly":he.on(i,{name:we,callback(e){t(e)}});break;case"htmlPreview":he.on(i,{name:Ce,callback(e){t(e)}});break;case"catalog":he.on(i,{name:Te,callback(e){t(e)}})}},togglePageFullscreen(e){n("pageFullscreen",e)},toggleFullscreen(e){he.emit(i,be,e)},togglePreview(e){n("preview",e)},togglePreviewOnly(e){n("previewOnly",e)},toggleHtmlPreview(e){n("htmlPreview",e)},toggleCatalog(e){he.emit(i,fe,e)},triggerSave(){he.emit(i,ge)},insert(e){he.emit(i,Ee,"universal",{generate:e})},focus(e){var t;null==(t=a.value)||t.focus(e)},rerender(){he.emit(i,je)},getSelectedText(){var e;return null==(e=a.value)?void 0:e.getSelectedText()},resetHistory(){var e;null==(e=a.value)||e.resetHistory()},domEventHandlers(e){he.emit(i,Be,e)},execCommand(e){he.emit(i,Ee,e)}};t.expose(r)})(e,t,y,g,f,c),()=>{const u=de({props:e,ctx:t},"defToolbars"),m=de({props:e,ctx:t},"defFooters");return d("div",{id:l,class:[te,e.class,"dark"===e.theme&&`${te}-dark`,g.fullscreen||g.pageFullscreen?`${te}-fullscreen`:""],style:e.style},[e.toolbars.length>0&&d(xt,{noPrettier:a,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:g,updateSetting:f,tableShape:e.tableShape,defToolbars:u,noUploadImg:i,showToolbarName:e.showToolbarName},null),d(Yt,{ref:c,modelValue:e.modelValue,setting:g,mdHeadingId:e.mdHeadingId,noMermaid:n,noPrettier:a,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:o,scrollAuto:s.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:r,updateModelValue:e=>{t.emit("update:modelValue",e)},onChange:l=>{e.onChange&&e.onChange(l),t.emit("onChange",l)},onHtmlChanged:l=>{e.onHtmlChanged&&e.onHtmlChanged(l),t.emit("onHtmlChanged",l)},onGetCatalog:l=>{e.onGetCatalog&&e.onGetCatalog(l),t.emit("onGetCatalog",l)},onBlur:l=>{e.onBlur&&e.onBlur(l),t.emit("onBlur",l)},onFocus:l=>{e.onFocus&&e.onFocus(l),t.emit("onFocus",l)},onInput:l=>{e.onInput&&e.onInput(l),t.emit("onInput",l)},completions:e.completions,catalogVisible:y.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:l=>{e.onDrop&&e.onDrop(l),t.emit("onDrop",l)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:l=>{e.onInputBoxWitdhChange&&e.onInputBoxWitdhChange(l),t.emit("onInputBoxWitdhChange",l)},sanitizeMermaid:e.sanitizeMermaid,transformImgUrl:e.transformImgUrl,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.footers.length>0&&d(ll,{modelValue:e.modelValue,footers:e.footers,defFooters:m,scrollAuto:s.scrollAuto,onScrollAutoChange:e=>s.scrollAuto=e},null)])}}});ol.install=e=>(e.component(ol.name,ol),e.use(ht).use(me).use(gt).use(vt).use(ut),e);export{ol as E};
