import{k as _e,p as U,a as fe}from"./index-DQwUUgFs.js";import{_ as ve,u as ge,a as be}from"./index-CGrgovxm.js";import{_ as ke,a as ye}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-DZYHg8pM.js";import{u as D,a as he,s as we,b as Re,d as Ue}from"./role-1aTnwwbQ.js";import{u as De}from"./useDict-CKDIK2gv.js";import{X as x,B as xe,j as Be,Y as Ce,T as Se,L as Ve,W as Ke,n as Me,M as Ee,G as Fe,a2 as Le,m as Ne,H as $e}from"./naive-ui-ItunR-2b.js";import{d as V,a as r,h as B,j as C,l as qe,m as Ae,q as n,by as o,u as e,f as S,B as He}from"./@vue-CRj7PaMA.js";import"./@vueuse-Bot-wEr0.js";import"./pinia-B-btkknc.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-i18n-BZ7cv-U7.js";import"./@intlify-Y34EtYYP.js";import"./vue-echarts-C0IzmTCj.js";import"./resize-detector-G6vbKCU7.js";import"./echarts-BhkYWNed.js";import"./zrender-DGIA2jg-.js";import"./tslib-BDyQ-Jie.js";import"./vue-router-DYGa2EEA.js";import"./@iconify-D4xAYz74.js";import"./axios-B4uVmeYG.js";import"./@codemirror-uT1p_ncg.js";import"./@lezer-COsil1JX.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./lodash-es-q_UuXcXk.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./vite-plugin-mock-CVu1TUMM.js";import"./mockjs-SqilSaKE.js";import"./@babel-dN-1QE0A.js";import"./path-to-regexp-D27XTR3m.js";import"./date-fns-BAYWyKT4.js";import"./vueuc-DHpchg3q.js";import"./evtd-CI_DDEu_.js";import"./seemly-pQYQdLy2.js";import"./@css-render-CcHFHqZ8.js";import"./vooks-Vv8Q4iio.js";import"./vdirs-Bxp-63WN.js";import"./@juggle-C8OzoCMD.js";import"./css-render-BDrvWz3H.js";import"./@emotion-WldOFDRm.js";import"./treemate-DKekKYbv.js";import"./async-validator-DKvM95Vc.js";import"./dict-CNGvzHPQ.js";const Ie=V({name:"UserRole"}),Et=V({...Ie,setup(je){const v={add:["admin","role:add"],del:["admin","role:del"],edit:["admin","role:edit"],download:["admin","role:download"]},{dict:K}=De(["status"]),u=r([{type:"selection",disabled:t=>t.id===1},{title:"ID",key:"id"},{title:"角色名称",key:"name"},{title:"角色排序",key:"sort"},{title:"角色状态",key:"status",render(t){return B(x,{rubberBand:!1,value:Number(t.status),loading:!!t.loading,checkedValue:1,uncheckedValue:0,disabled:t.id===1,onUpdateValue:()=>M(t)})}},{title:"备注",key:"remark"},{title:"操作",key:"actions",align:"center",fixed:"right",render(t){return[B(ve,{permission:v,disabled:t.id===1,onHandleDelete:()=>k(t.id),onHandleEdit:()=>y(t),onHandleView:()=>T(t)})]}}]),M=async t=>{try{t.loading=!0;const a={...t,status:t.status===0?1:0};await D(a),await h(),t.loading=!1}catch{t.loading=!1}},i=r(),E=t=>({style:"cursor: pointer;",onClick:async()=>{var a;t.id&&t.id!==1&&t.id!==((a=i.value)==null?void 0:a.id)&&(d.value=await F(t.id)||[],i.value=t)}}),F=async t=>(await he(t)).data,L=C(()=>t=>{var a;return t.id===((a=i.value)==null?void 0:a.id)?"selected-row":""}),g=r(),d=r([]),b=C(()=>{var t;return((t=i.value)==null?void 0:t.id)===void 0});_e().then(t=>{g.value=t.data});const N=t=>{d.value=t},m=r(!1),$=()=>{var t;i.value&&d.value?(m.value=!0,we((t=i.value)==null?void 0:t.id,d.value).then(a=>{m.value=!1,U.success(a.message)}).catch(()=>{m.value=!1})):U.warning("请选择数据")},q={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{modalVisible:_,modalAction:A,modalShowFooter:H,modalTitle:I,modalLoading:j,handleAdd:z,handleDelete:k,handleEdit:y,handleDownload:Q,handleView:T,handleSave:G,handlereset:P,defualtQuery:p,modalForm:s,modalFormRef:W,changeCheckRow:X,listQuery:h,listData:Y,pagination:J,loading:O,rowKey:Z,btnDisabled:ee,checkedRowKeys:te}=ge({name:"角色",url:"/role",key:"id",initForm:{name:"",status:1,sort:null,remark:""},initQuery:{name:"",status:null},doCreate:Re,doDelete:Ue,doUpdate:D,beforeSave:t=>(console.log(t),t),beforeRefresh:()=>(i.value=void 0,d.value=[],!0)});return(t,a)=>{const f=Be,w=ke,ae=Ce,ne=Se,oe=ye,c=Ve,le=Ke,se=Me,ie=Ee,de=be,R=Fe,re=fe,ue=Le,me=Ne,pe=$e;return qe(),Ae("div",null,[n(pe,{cols:"3","item-responsive":"","y-gap":8,"x-gap":10,responsive:"screen"},{default:o(()=>[n(R,{span:"3 m:2 l:2 xl:2"},{default:o(()=>[n(oe,{columns:e(u),"onUpdate:columns":a[2]||(a[2]=l=>S(u)?u.value=l:null),btnDisabled:e(ee),permission:v,onSearch:e(h),onReset:e(P),onAdd:e(z),onDelete:e(k),onEdit:e(y),onDownload:e(Q)},{queryBar:o(()=>[n(w,{label:"角色名称"},{default:o(()=>[n(f,{value:e(p).name,"onUpdate:value":a[0]||(a[0]=l=>e(p).name=l),size:"small",placeholder:"输入角色名称"},null,8,["value"])]),_:1}),n(w,{label:"角色状态"},{default:o(()=>{var l;return[n(ae,{value:e(p).status,"onUpdate:value":a[1]||(a[1]=ce=>e(p).status=ce),placeholder:"选择角色状态",clearable:"",options:(l=e(K))==null?void 0:l.status},null,8,["value","options"])]}),_:1})]),default:o(()=>[n(ne,{columns:e(u),data:e(Y),pagination:e(J),loading:e(O),"row-key":e(Z),"row-props":E,"row-class-name":e(L),striped:"",remote:!0,"checked-row-keys":e(te),"onUpdate:checkedRowKeys":e(X)},null,8,["columns","data","pagination","loading","row-key","row-class-name","checked-row-keys","onUpdate:checkedRowKeys"])]),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),n(de,{visible:e(_),"onUpdate:visible":a[7]||(a[7]=l=>S(_)?_.value=l:null),title:e(I),loading:e(j),"show-footer":e(H),width:"550px",onSave:e(G)},{default:o(()=>[n(ie,{ref_key:"modalFormRef",ref:W,"label-placement":"left","label-align":"right","label-width":80,model:e(s),rules:q,disabled:e(A)==="view"},{default:o(()=>[n(c,{label:"角色名称",path:"name"},{default:o(()=>[n(f,{value:e(s).name,"onUpdate:value":a[3]||(a[3]=l=>e(s).name=l)},null,8,["value"])]),_:1}),n(se,{justify:"space-between"},{default:o(()=>[n(c,{label:"角色排序",path:"sort"},{default:o(()=>[n(le,{value:e(s).sort,"onUpdate:value":a[4]||(a[4]=l=>e(s).sort=l),clearable:""},null,8,["value"])]),_:1}),n(c,{label:"角色状态",path:"status"},{default:o(()=>[n(e(x),{"checked-value":1,"unchecked-value":0,value:e(s).status,"onUpdate:value":a[5]||(a[5]=l=>e(s).status=l)},null,8,["value"])]),_:1})]),_:1}),n(c,{label:"备注",path:"remark"},{default:o(()=>[n(f,{value:e(s).remark,"onUpdate:value":a[6]||(a[6]=l=>e(s).remark=l)},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","show-footer","onSave"])]),_:1}),n(R,{span:"3 m:1 l:1 xl:1"},{default:o(()=>[n(me,{title:"菜单分配",size:"small",segmented:!0},{"header-extra":o(()=>[n(e(xe),{type:"primary",size:"small",loading:e(m),disabled:e(b),onClick:$},{icon:o(()=>[n(re,{icon:"mingcute:save-2-line"})]),default:o(()=>[He(" 保存 ")]),_:1},8,["loading","disabled"])]),default:o(()=>[n(ue,{data:e(g),"checked-keys":e(d),disabled:e(b),"key-field":"id","label-field":"title",selectable:!1,"show-line":!0,"block-line":"",multiple:"",checkable:"","expand-on-click":"","onUpdate:checkedKeys":N},null,8,["data","checked-keys","disabled"])]),_:1})]),_:1})]),_:1})])}}});export{Et as default};
