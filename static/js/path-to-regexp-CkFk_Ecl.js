function b(r){for(var a=[],e=0;e<r.length;){var c=r[e];if(c==="*"||c==="+"||c==="?"){a.push({type:"MODIFIER",index:e,value:r[e++]});continue}if(c==="\\"){a.push({type:"ESCAPED_CHAR",index:e++,value:r[e++]});continue}if(c==="{"){a.push({type:"OPEN",index:e,value:r[e++]});continue}if(c==="}"){a.push({type:"CLOSE",index:e,value:r[e++]});continue}if(c===":"){for(var h="",n=e+1;n<r.length;){var v=r.charCodeAt(n);if(v>=48&&v<=57||v>=65&&v<=90||v>=97&&v<=122||v===95){h+=r[n++];continue}break}if(!h)throw new TypeError("Missing parameter name at ".concat(e));a.push({type:"NAME",index:e,value:h}),e=n;continue}if(c==="("){var f=1,g="",n=e+1;if(r[n]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<r.length;){if(r[n]==="\\"){g+=r[n++]+r[n++];continue}if(r[n]===")"){if(f--,f===0){n++;break}}else if(r[n]==="("&&(f++,r[n+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(n));g+=r[n++]}if(f)throw new TypeError("Unbalanced pattern at ".concat(e));if(!g)throw new TypeError("Missing pattern at ".concat(e));a.push({type:"PATTERN",index:e,value:g}),e=n;continue}a.push({type:"CHAR",index:e,value:r[e++]})}return a.push({type:"END",index:e,value:""}),a}function H(r,a){a===void 0&&(a={});for(var e=b(r),c=a.prefixes,h=c===void 0?"./":c,n=a.delimiter,v=n===void 0?"/#?":n,f=[],g=0,x=0,l="",u=function(d){if(x<e.length&&e[x].type===d)return e[x++].value},O=function(d){var i=u(d);if(i!==void 0)return i;var E=e[x],M=E.type,S=E.index;throw new TypeError("Unexpected ".concat(M," at ").concat(S,", expected ").concat(d))},C=function(){for(var d="",i;i=u("CHAR")||u("ESCAPED_CHAR");)d+=i;return d},P=function(d){for(var i=0,E=v;i<E.length;i++){var M=E[i];if(d.indexOf(M)>-1)return!0}return!1},R=function(d){var i=f[f.length-1],E=d||(i&&typeof i=="string"?i:"");if(i&&!E)throw new TypeError('Must have text between two parameters, missing text after "'.concat(i.name,'"'));return!E||P(E)?"[^".concat(w(v),"]+?"):"(?:(?!".concat(w(E),")[^").concat(w(v),"])+?")};x<e.length;){var y=u("CHAR"),o=u("NAME"),T=u("PATTERN");if(o||T){var p=y||"";h.indexOf(p)===-1&&(l+=p,p=""),l&&(f.push(l),l=""),f.push({name:o||g++,prefix:p,suffix:"",pattern:T||R(p),modifier:u("MODIFIER")||""});continue}var t=y||u("ESCAPED_CHAR");if(t){l+=t;continue}l&&(f.push(l),l="");var m=u("OPEN");if(m){var p=C(),s=u("NAME")||"",N=u("PATTERN")||"",A=C();O("CLOSE"),f.push({name:s||(N?g++:""),pattern:s&&!N?R(p):N,prefix:p,suffix:A,modifier:u("MODIFIER")||""});continue}O("END")}return f}function w(r){return r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function D(r){return r&&r.sensitive?"":"i"}function I(r,a){return r}function W(r,a,e){var c=r.map(function(h){return _(h,a,e).source});return new RegExp("(?:".concat(c.join("|"),")"),D(e))}function $(r,a,e){return F(H(r,e),a,e)}function F(r,a,e){e===void 0&&(e={});for(var c=e.strict,h=c===void 0?!1:c,n=e.start,v=n===void 0?!0:n,f=e.end,g=f===void 0?!0:f,x=e.encode,l=x===void 0?function(i){return i}:x,u=e.delimiter,O=u===void 0?"/#?":u,C=e.endsWith,P=C===void 0?"":C,R="[".concat(w(P),"]|$"),y="[".concat(w(O),"]"),o=v?"^":"",T=0,p=r;T<p.length;T++){var t=p[T];if(typeof t=="string")o+=w(l(t));else{var m=w(l(t.prefix)),s=w(l(t.suffix));if(t.pattern)if(m||s)if(t.modifier==="+"||t.modifier==="*"){var N=t.modifier==="*"?"?":"";o+="(?:".concat(m,"((?:").concat(t.pattern,")(?:").concat(s).concat(m,"(?:").concat(t.pattern,"))*)").concat(s,")").concat(N)}else o+="(?:".concat(m,"(").concat(t.pattern,")").concat(s,")").concat(t.modifier);else{if(t.modifier==="+"||t.modifier==="*")throw new TypeError('Can not repeat "'.concat(t.name,'" without a prefix and suffix'));o+="(".concat(t.pattern,")").concat(t.modifier)}else o+="(?:".concat(m).concat(s,")").concat(t.modifier)}}if(g)h||(o+="".concat(y,"?")),o+=e.endsWith?"(?=".concat(R,")"):"$";else{var A=r[r.length-1],d=typeof A=="string"?y.indexOf(A[A.length-1])>-1:A===void 0;h||(o+="(?:".concat(y,"(?=").concat(R,"))?")),d||(o+="(?=".concat(y,"|").concat(R,")"))}return new RegExp(o,D(e))}function _(r,a,e){return r instanceof RegExp?I(r):Array.isArray(r)?W(r,a,e):$(r,a,e)}export{_ as p};
