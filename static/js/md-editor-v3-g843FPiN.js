import{x as El,f as Il,R as Ve,h as je,$ as Ll,C as Hl,F as ul,L as Al}from"./@vavt-PwnvuMkC.js";import{d as j,i as L,q as s,v as X,a as N,w as S,o as O,x as pe,y as Oe,s as ce,j as J,n as le,T as Fl,h as Ml,z as ne,F as Ee,t as se,A as Pl}from"./@vue-CRj7PaMA.js";import{E as re,H as ml,s as gl,k as Bl,d as Nl,h as jl,i as Ol,a as Ot,m as Rl,u as Dl,r as Vl,b as Wl,c as ae,e as Fe,f as Ul,p as zl,C as me,l as ql,g as Gl,S as Kl,j as Zl}from"./@codemirror-DRVzKoOo.js";import{a as v}from"./@lezer-COsil1JX.js";import{m as Xl}from"./medium-zoom-bWEtUbjf.js";import{c as Jl}from"./copy-to-clipboard-C1SuVluP.js";import{M as Yl}from"./markdown-it-DI8MEbma.js";import{r as Ql}from"./markdown-it-image-figures-BD49Kf-b.js";import{T as eo}from"./markdown-it-task-lists-Bk_P1Bh3.js";import{X as to}from"./markdown-it-xss-S5L45IPD.js";import{L as lo}from"./lru-cache-DBLXwll_.js";const r="md-editor",oo="https://at.alicdn.com/t/c/font_2605852_rfu1p40qggh.js",no="https://at.alicdn.com/t/c/font_2605852_rfu1p40qggh.css",B="https://cdnjs.cloudflare.com/ajax/libs",ao=`${B}/highlight.js/11.8.0/highlight.min.js`,Rt={main:`${B}/prettier/2.8.0/standalone.js`,markdown:`${B}/prettier/2.8.0/parser-markdown.js`},io={css:`${B}/cropperjs/1.5.13/cropper.min.css`,js:`${B}/cropperjs/1.5.13/cropper.min.js`},ro=`${B}/screenfull.js/5.2.0/screenfull.min.js`,fl=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","previewOnly","htmlPreview","catalog","github"],hl=["markdownTotal","=","scrollSwitch"],Dt={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",previewOnly:"仅预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",previewOnly:"preview only",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},so=`${B}/mermaid/10.6.1/mermaid.esm.min.mjs`,co={js:`${B}/KaTeX/0.16.9/katex.min.js`,css:`${B}/KaTeX/0.16.9/katex.min.css`},Re={a11y:{light:`${B}/highlight.js/11.8.0/styles/a11y-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/a11y-dark.min.css`},atom:{light:`${B}/highlight.js/11.8.0/styles/atom-one-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/atom-one-dark.min.css`},github:{light:`${B}/highlight.js/11.8.0/styles/github.min.css`,dark:`${B}/highlight.js/11.8.0/styles/github-dark.min.css`},gradient:{light:`${B}/highlight.js/11.8.0/styles/gradient-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/gradient-dark.min.css`},kimbie:{light:`${B}/highlight.js/11.8.0/styles/kimbie-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/kimbie-dark.min.css`},paraiso:{light:`${B}/highlight.js/11.8.0/styles/paraiso-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${B}/highlight.js/11.8.0/styles/qtcreator-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${B}/highlight.js/11.8.0/styles/stackoverflow-light.min.css`,dark:`${B}/highlight.js/11.8.0/styles/stackoverflow-dark.min.css`}},V={editorExtensions:{highlight:{js:ao,css:Re},prettier:{standaloneJs:Rt.main,parserMarkdownJs:Rt.markdown},cropper:{...io},iconfont:oo,iconfontClass:no,screenfull:{js:ro},mermaid:{js:so},katex:{...co}},editorExtensionsAttrs:{},editorConfig:{languageUserDefined:{},mermaidTemplate:{},renderDelay:500,zIndex:2e4},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e},ye=170,Q=({instance:e,ctx:t,props:l={}},n="default")=>{const o=(e==null?void 0:e.$slots[n])||(t==null?void 0:t.slots[n]);return(o?o(e):"")||l[n]},uo={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},ge=j({props:uo,setup(e,t){const l=`${r}-dropdown-hidden`,n=X({overlayClass:[l],overlayStyle:{},triggerHover:!1,overlayHover:!1}),o=N(),i=N(),d=()=>{var a,m;n.triggerHover=!0;const y=o.value,C=i.value;if(!y||!C)return;const h=y.getBoundingClientRect(),f=y.offsetTop,$=y.offsetLeft,b=h.height,p=h.width,w=((a=document.querySelector(e.relative))==null?void 0:a.scrollLeft)||0,T=((m=document.querySelector(e.relative))==null?void 0:m.clientWidth)||0;let x=$-C.offsetWidth/2+p/2-w;x+C.offsetWidth>w+T&&(x=w+T-C.offsetWidth),x<0&&(x=0),n.overlayStyle={...n.overlayStyle,top:f+b+"px",left:x+"px"},e.onChange(!0)},g=()=>{n.overlayHover=!0};S(()=>e.visible,a=>{a?n.overlayClass=n.overlayClass.filter(m=>m!==l):n.overlayClass.push(l)});let u=-1;const c=a=>{o.value===a.target?n.triggerHover=!1:n.overlayHover=!1,clearTimeout(u),u=window.setTimeout(()=>{!n.overlayHover&&!n.triggerHover&&e.onChange(!1)},10)};return O(()=>{o.value.addEventListener("mouseenter",d),o.value.addEventListener("mouseleave",c),i.value.addEventListener("mouseenter",g),i.value.addEventListener("mouseleave",c)}),pe(()=>{o.value.removeEventListener("mouseenter",d),o.value.removeEventListener("mouseleave",c),i.value.removeEventListener("mouseenter",g),i.value.removeEventListener("mouseleave",c)}),()=>{const a=Q({ctx:t}),m=Q({props:e,ctx:t},"overlay"),y=Oe(a instanceof Array?a[0]:a,{ref:o,key:"cloned-dropdown-trigger"}),C=s("div",{class:[`${r}-dropdown`,n.overlayClass],style:n.overlayStyle,ref:i},[s("div",{class:`${r}-dropdown-overlay`},[m instanceof Array?m[0]:m])]);return[y,C]}}}),mo={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String},default:{type:[String,Object]}},Ce=j({name:"DropdownToolbar",props:mo,emits:["onChange"],setup(e,t){const l=L("editorId");return()=>{const n=Q({props:e,ctx:t},"trigger"),o=Q({props:e,ctx:t},"overlay"),i=Q({props:e,ctx:t});return s(ge,{relative:`#${l}-toolbar-wrapper`,visible:e.visible,onChange:d=>{e.onChange instanceof Function?e.onChange(d):t.emit("onChange",d)},overlay:o},{default:()=>[s("div",{class:`${r}-toolbar-item`,title:e.title||""},[n,i])]})}}});Ce.install=e=>(e.component(Ce.name,Ce),e);var go=Object.defineProperty,fo=(e,t,l)=>t in e?go(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,ho=(e,t,l)=>(fo(e,t+"",l),l);class vo{constructor(){ho(this,"pools",{})}remove(t,l,n){const i=this.pools[t]&&this.pools[t][l];i&&(this.pools[t][l]=i.filter(d=>d!==n))}clear(t){this.pools[t]={}}on(t,l){return this.pools[t]||(this.pools[t]={}),this.pools[t][l.name]||(this.pools[t][l.name]=[]),this.pools[t][l.name].push(l.callback),this.pools[t][l.name].includes(l.callback)}emit(t,l,...n){this.pools[t]||(this.pools[t]={});const i=this.pools[t][l];i&&i.forEach(d=>{try{d(...n)}catch(g){console.error(`${l} monitor event exception！`,g)}})}}const k=new vo,Ie="onSave",We="changeCatalogVisible",vl="changeFullscreen",Vt="pageFullscreenChanged",Wt="fullscreenChanged",Ut="previewChanged",zt="previewOnlyChanged",qt="htmlPreviewChanged",Gt="catalogVisibleChanged",$e="buildFinished",de="errorCatcher",M="replace",Le="uploadImage",De="openModals",bl="ctrlZ",pl="ctrlShiftZ",we="catalogChanged",yl="pushCatalog",Ue="rerender",kl="eventListener",Kt=(e,t)=>{const l=n=>{const o=e.parentElement||document.body,i=o.offsetWidth,d=o.offsetHeight,{clientWidth:g}=document.documentElement,{clientHeight:u}=document.documentElement,c=n.offsetX,a=n.offsetY,m=C=>{let h=C.x+document.body.scrollLeft-document.body.clientLeft-c,f=C.y+document.body.scrollTop-document.body.clientTop-a;h=h<1?1:h<g-i-1?h:g-i-1,f=f<1?1:f<u-d-1?f:u-d-1,t?t(h,f):(o.style.left=`${h}px`,o.style.top=`${f}px`)};document.addEventListener("mousemove",m);const y=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y)};document.addEventListener("mouseup",y)};return e.addEventListener("mousedown",l),()=>{e.removeEventListener("mousedown",l)}},Z=(e,t,l="")=>{var n;const o=document.getElementById(t.id);if(o)l!==""&&(Reflect.get(window,l)?(n=t.onload)==null||n.call(o,new Event("load")):t.onload&&o.addEventListener("load",t.onload));else{const i={...t};i.onload=null;const d=po(e,i);t.onload&&d.addEventListener("load",t.onload),document.head.appendChild(d)}},bo=(e,t)=>{const l=document.getElementById(t.id);l==null||l.remove(),Z(e,t)},po=(e,t)=>{const l=document.createElement(e);return Object.keys(t).forEach(n=>{t[n]!==void 0&&(l[n]=t[n])}),l},yo=(e,t="image.png")=>{const l=e.split(","),n=l[0].match(/:(.*?);/);if(n){const o=n[1],i=atob(l[1]);let d=i.length;const g=new Uint8Array(d);for(;d--;)g[d]=i.charCodeAt(d);return new File([g],t,{type:o})}return null},ko=e=>{if(!e)return e;const t=e.split(`
`),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{l.push("<span></span>")}),l.push("</span>"),`<span class="${r}-code-block">${e}</span>${l.join("")}`},Co=(e,t)=>{if(!e||!t)return 0;const l=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const n=t==null?void 0:t.getBoundingClientRect();return l.top-n.top},$o=(()=>{let e=0;return t=>t+ ++e})(),Zt=(()=>{let e=0;return()=>++e})(),wo=j({props:{name:{type:String,default:""}},setup(e){return()=>s("svg",{class:`${r}-icon`,"aria-hidden":"true"},[s("use",{"xlink:href":`#${r}-icon-${e.name}`},null)])}}),E=j({props:{name:{type:String,default:""}},setup(e){const t=L("customIcon");return()=>{const l=t.value[e.name];return typeof l=="object"?typeof l.component=="object"?Ml(l.component,l.props):s("span",{innerHTML:l.component},null):s(wo,{name:e.name},null)}}}),To={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String},style:{type:Object,default:()=>({})}},fe=j({name:"MdModal",props:To,emits:["onClose"],setup(e,t){const l=L("theme"),n=N(e.visible),o=N([`${r}-modal`]),i=N(),d=N(),g=N(),u=ce();let c=()=>{};const a=X({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),m=J(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});return S(()=>e.isFullscreen,y=>{y?c():le(()=>{c=Kt(d.value,(C,h)=>{a.initPos.left=C+"px",a.initPos.top=h+"px"})})}),S(()=>e.visible,y=>{y?(a.maskStyle.zIndex=V.editorConfig.zIndex+Zt(),a.modalStyle.zIndex=V.editorConfig.zIndex+Zt(),o.value.push("zoom-in"),n.value=y,le(()=>{const C=i.value.offsetWidth/2,h=i.value.offsetHeight/2,f=document.documentElement.clientWidth/2,$=document.documentElement.clientHeight/2;a.initPos.left=f-C+"px",a.initPos.top=$-h+"px",e.isFullscreen||(c=Kt(d.value,(b,p)=>{a.initPos.left=b+"px",a.initPos.top=p+"px"}))}),setTimeout(()=>{o.value=o.value.filter(C=>C!=="zoom-in")},140)):(o.value.push("zoom-out"),c(),setTimeout(()=>{o.value=o.value.filter(C=>C!=="zoom-out"),n.value=y},130))}),O(()=>{g.value=document.body}),()=>{const y=Q({ctx:t}),C=Q({props:e,ctx:t},"title");return g.value?s(Fl,{to:g.value},{default:()=>[s("div",{ref:u,class:`${r}-modal-container`,"data-theme":l.value},[s("div",{class:e.class,style:{...e.style,display:n.value?"block":"none"}},[s("div",{class:`${r}-modal-mask`,style:a.maskStyle,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),s("div",{class:o.value,style:{...a.modalStyle,...a.initPos,...m.value},ref:i},[s("div",{class:`${r}-modal-header`,ref:d},[C||""]),s("div",{class:`${r}-modal-body`},[y]),s("div",{class:`${r}-modal-func`},[e.showAdjust&&s("div",{class:`${r}-modal-adjust`,onClick:h=>{h.stopPropagation(),e.isFullscreen?a.initPos=a.historyPos:(a.historyPos=a.initPos,a.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[s(E,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),s("div",{class:`${r}-modal-close`,onClick:h=>{h.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[s(E,{name:"close"},null)])])])])])]}):""}}});fe.install=e=>(e.component(fe.name,fe),e);const xo=(e,t)=>{const l=L("editorId"),{noImgZoomIn:n}=e,o=Ve(()=>{const i=document.querySelectorAll(`#${l}-preview img`);i.length!==0&&Xl(i,{background:"#00000073"})});O(()=>{o()}),S([t,se(e.setting,"preview")],()=>{!n&&e.setting.preview&&o()})},So=(e,t,l)=>{const n=L("editorId"),o=L("usedLanguageText"),i=()=>{document.querySelectorAll(`#${n} .${r}-preview .${r}-code`).forEach(u=>{let c=-1;const a=u.querySelector(`.${r}-copy-button`);a&&(a.onclick=m=>{m.preventDefault(),clearTimeout(c);const C=(u.querySelector("input:checked + pre code")||u.querySelector("pre code")).textContent,h=Jl(e.formatCopiedText(C)),{text:f,successTips:$,failTips:b}=o.value.copyCode;a.innerHTML=h?$:b,c=window.setTimeout(()=>{a.innerHTML=f},1500)})})},d=()=>{le(i)},g=u=>{u&&le(i)};S([t,l],d),S(()=>e.setting.preview,g),S(()=>e.setting.htmlPreview,g),S(()=>o.value,i),O(i)},_o=e=>{const t=L("highlight"),l=ce(V.editorExtensions.highlight.instance);return O(()=>{e.noHighlight||l.value||(Z("link",{...t.value.css,rel:"stylesheet",id:`${r}-hlCss`}),Z("script",{...t.value.js,id:`${r}-hljs`,onload(){l.value=window.hljs}},"hljs"))}),S(()=>t.value.css,()=>{bo("link",{...t.value.css,rel:"stylesheet",id:`${r}-hlCss`})}),l},Eo=e=>{const t=L("theme"),{editorExtensions:l,editorExtensionsAttrs:n,mermaidConfig:o}=V,i=ce(l.mermaid.instance),d=ce(-1),g=new lo({max:1e3,ttl:6e5}),u=()=>{const a=i.value;!e.noMermaid&&a&&(a.initialize(o({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"})),d.value=d.value+1)};return S(()=>t.value,()=>{g.clear(),u()}),O(()=>{var a,m,y;if(e.noMermaid||(a=i.value)!=null&&a.instance)return;const C=l.mermaid.js;/\.mjs/.test(C)?(Z("link",{...(m=n.mermaid)==null?void 0:m.js,rel:"modulepreload",href:C,id:`${r}-mermaid-m`}),import(C).then(h=>{i.value=h.default,u()})):Z("script",{...(y=n.mermaid)==null?void 0:y.js,src:C,id:`${r}-mermaid`,onload(){i.value=window.mermaid,u()}},"mermaid")}),{mermaidRef:i,reRenderRef:d,replaceMermaid:()=>{le(()=>{if(!e.noMermaid&&i.value){const a=document.querySelectorAll(`div.${r}-mermaid`),m=document.createElement("div");m.style.width=document.body.offsetWidth+"px",m.style.height=document.body.offsetHeight+"px",m.style.position="fixed",m.style.zIndex="-10000",m.style.top="-10000";let y=a.length;y>0&&document.body.appendChild(m),a.forEach(async C=>{let h=g.get(C.innerText);if(!h){const $=je(),b=i.value.renderAsync||i.value.render;let p="";try{p=await b($,C.innerText,m)}catch{}h=await e.sanitizeMermaid(typeof p=="string"?p:p.svg),g.set(C.innerText,h)}const f=document.createElement("p");f.className=`${r}-mermaid`,f.setAttribute("data-processed",""),f.innerHTML=h,C.dataset.line!==void 0&&(f.dataset.line=C.dataset.line),C.replaceWith(f),--y===0&&m.remove()})}})}}},Io=e=>{const t=ce(V.editorExtensions.katex.instance);return O(()=>{if(e.noKatex||t.value)return;const{editorExtensions:l}=V;Z("script",{src:l.katex.js,id:`${r}-katex`,onload(){t.value=window.katex}},"katex"),Z("link",{rel:"stylesheet",href:l.katex.css,id:`${r}-katexCss`})}),t},Lo=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(n,o,i,d,g)=>{const u=n[o],c=u.content.trim();if(u.info==="mermaid"){let a;return n[o].map&&n[o].level===0&&(a=n[o].map[0],n[o].attrSet("data-line",String(a))),`<div class="${r}-mermaid" ${a!==void 0?"data-line="+a:""} data-mermaid-theme=${t.themeRef.value}>${c}</div>`}return l(n,o,i,d,g)}},Ho=Lo,_e=(e,t)=>{const l=e.attrs?e.attrs.slice():[];return t.forEach(n=>{const o=e.attrIndex(n[0]);o<0?l.push(n):(l[o]=l[o].slice(),l[o][1]+=` ${n[1]}`)}),l},Xt=(e,t)=>{let l=!0,n=!0;const o=e.posMax,i=t>0?e.src.charCodeAt(t-1):-1,d=t+1<=o?e.src.charCodeAt(t+1):-1;return(i===32||i===9||d>=48&&d<=57)&&(n=!1),(d===32||d===9)&&(l=!1),{can_open:l,can_close:n}},Ao=(e,t)=>{let l,n,o,i;if(e.src[e.pos]!=="$")return!1;if(o=Xt(e,e.pos),!o.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const d=e.pos+1;for(l=d;(l=e.src.indexOf("$",l))!==-1;){for(i=l-1;e.src[i]==="\\";)i-=1;if((l-i)%2==1)break;l+=1}return l===-1?(t||(e.pending+="$"),e.pos=d,!0):l-d===0?(t||(e.pending+="$$"),e.pos=d+1,!0):(o=Xt(e,l),o.can_close?(t||(n=e.push("math_inline","math",0),n.markup="$",n.content=e.src.slice(d,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=d,!0))},Fo=(e,t,l,n)=>{let o,i,d,g,u=!1,c=e.bMarks[t]+e.tShift[t],a=e.eMarks[t];if(c+2>a||e.src.slice(c,c+2)!=="$$")return!1;if(c+=2,o=e.src.slice(c,a),n)return!0;for(o.trim().slice(-2)==="$$"&&(o=o.trim().slice(0,-2),u=!0),d=t;!u&&(d++,!(d>=l||(c=e.bMarks[d]+e.tShift[d],a=e.eMarks[d],c<a&&e.tShift[d]<e.blkIndent)));)e.src.slice(c,a).trim().slice(-2)==="$$"&&(g=e.src.slice(0,a).lastIndexOf("$$"),i=e.src.slice(c,g),u=!0);e.line=d+1;const m=e.push("math_block","math",0);return m.block=!0,m.content=(o&&o.trim()?o+`
`:"")+e.getLines(t+1,d,e.tShift[t],!0)+(i&&i.trim()?i:""),m.map=[t,e.line],m.markup="$$",!0},Mo=(e,{katexRef:t})=>{const l=(o,i,d,g,u)=>{const c=o[i],a={attrs:_e(c,[["class",`${r}-katex-inline`]])};if(t.value){const m=t.value.renderToString(c.content,{throwOnError:!1});return`<span ${u.renderAttrs(a)} data-processed>${m}</span>`}else return`<span ${u.renderAttrs(a)}>${c.content}</span>`},n=(o,i,d,g,u)=>{const c=o[i],a={attrs:_e(c,[["class",`${r}-katex-block`]])};if(t.value){const m=t.value.renderToString(c.content,{throwOnError:!1,displayMode:!0});return`<p ${u.renderAttrs(a)} data-processed>${m}</p>`}else return`<p ${u.renderAttrs(a)}>${c.content}</p>`};e.inline.ruler.after("escape","math_inline",Ao),e.block.ruler.after("blockquote","math_block",Fo,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=l,e.renderer.rules.math_block=n},Po=Mo,Bo=(e,t)=>{t=t||{};const l=3,n=t.marker||"!",o=n.charCodeAt(0),i=n.length;let d="",g="";const u=(a,m,y,C,h)=>{const f=a[m];return f.type==="admonition_open"?a[m].attrPush(["class",`${r}-admonition ${r}-admonition-${f.info}`]):f.type==="admonition_title_open"&&a[m].attrPush(["class",`${r}-admonition-title`]),h.renderToken(a,m,y)},c=a=>{const m=a.trim().split(" ",2);g="",d=m[0],m.length>1&&(g=a.substring(d.length+2)),(g===""||!g)&&(g=d)};e.block.ruler.before("code","admonition",(a,m,y,C)=>{let h,f,$,b=!1,p=a.bMarks[m]+a.tShift[m],w=a.eMarks[m];if(o!==a.src.charCodeAt(p))return!1;for(h=p+1;h<=w&&n[(h-p)%i]===a.src[h];h++);const T=Math.floor((h-p)/i);if(T!==l)return!1;h-=(h-p)%i;const x=a.src.slice(p,h),P=a.src.slice(h,w);if(c(P),C)return!0;for(f=m;f++,!(f>=y||(p=a.bMarks[f]+a.tShift[f],w=a.eMarks[f],p<w&&a.sCount[f]<a.blkIndent));)if(o===a.src.charCodeAt(p)&&!(a.sCount[f]-a.blkIndent>=4)){for(h=p+1;h<=w&&n[(h-p)%i]===a.src[h];h++);if(!(Math.floor((h-p)/i)<T)&&(h-=(h-p)%i,h=a.skipSpaces(h),!(h<w))){b=!0;break}}const _=a.parentType,A=a.lineMax;return a.parentType="root",a.lineMax=f,$=a.push("admonition_open","div",1),$.markup=x,$.block=!0,$.info=d,$.map=[m,f],$=a.push("admonition_title_open","p",1),$.markup=x+" "+d,$.map=[m,f],$=a.push("inline","",0),$.content=g,$.map=[m,a.line-1],$.children=[],$=a.push("admonition_title_close","p",-1),$.markup=x+" "+d,a.md.block.tokenize(a,m+1,f),$=a.push("admonition_close","div",-1),$.markup=a.src.slice(p,h),$.block=!0,a.parentType=_,a.lineMax=A,a.line=f+(b?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=u,e.renderer.rules.admonition_title_open=u,e.renderer.rules.admonition_title_close=u,e.renderer.rules.admonition_close=u},No=Bo,jo=(e,t)=>{e.renderer.rules.heading_open=(l,n)=>{var o;const i=l[n],d=((o=l[n+1].children)==null?void 0:o.reduce((u,c)=>u+(["text","code_inline"].includes(c.type)&&c.content||""),""))||"",g=i.markup.length;return t.headsRef.value.push({text:d,level:g}),i.map&&i.level===0&&i.attrSet("id",t.mdHeadingId(d,g,t.headsRef.value.length)),e.renderer.renderToken(l,n,t)},e.renderer.rules.heading_close=(l,n,o,i,d)=>d.renderToken(l,n,o)},Oo=jo,Ro=(e,t)=>{const l=e.renderer.rules.fence,n=e.utils.unescapeAll,o=/\[(\w*)(?::([\w ]*))?\]/,i=a=>a.info?n(a.info).trim():"",d=a=>{const m=i(a),[y=null,C=""]=(o.exec(m)||[]).slice(1);return[y,C]},g=a=>{const m=i(a);return m?m.split(/(\s+)/g)[0]:""},u=a=>{const m=a.content.trim().split(`
`).length<t.autoFoldThreshold,y=t.codeFoldable?"details":"div",C=t.codeFoldable?"summary":"div";return{open:m,tagContainer:y,tagHeader:C}},c=(a,m,y,C,h)=>{var f,$;if(a[m].hidden)return"";const[b]=d(a[m]);if(b===null){const{open:D,tagContainer:W,tagHeader:oe}=u(a[m]),Y=[["class",`${r}-code`]];D&&Y.push(["open",""]);const ee={attrs:_e(a[m],Y)},te=l(a,m,y,C,h);return`<${W} ${h.renderAttrs(ee)}>
    <${oe} class="${r}-code-head">
      <div class="${r}-code-flag">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div>
        <span class="${r}-code-lang">${a[m].info.trim()}</span>
        <span class="${r}-copy-button">${(f=t.usedLanguageTextRef.value)==null?void 0:f.copyCode.text}</span>
      </div>
    </${oe}>${te}</${W}>`}let p,w,T,x,P="",_="",A="";const{open:I,tagContainer:F,tagHeader:R}=u(a[m]),G=[["class",`${r}-code`]];I&&G.push(["open",""]);const K={attrs:_e(a[m],G)};for(let D=m;D<a.length&&(p=a[D],[w,T]=d(p),w===b);D++){p.info=p.info.replace(o,""),p.hidden=!0;const W=`${r}-codetab-${t.editorId}-${m}-${D-m}`;x=D-m>0?"":"checked",P+=`<li>
          <input type="radio" name="${r}-codetab-label-${t.editorId}-${m}" class="${W}" ${x}>
          <label onclick="document.querySelectorAll('.${W}').forEach(e => e.click())">${T||g(p)}</label>
        </li>`,_+=`<input type="radio" name="${r}-codetab-pre-${t.editorId}-${m}" class="${W}" ${x}>
      ${l(a,D,y,C,h)}`,A+=`<input type="radio" name="${r}-codetab-lang-${t.editorId}-${m}" class="${W}" ${x}>
      <span class=${r}-code-lang>${g(p)}</span>`}return`<${F} ${h.renderAttrs(K)}>
    <${R} class="${r}-code-head">
      <div class="${r}-code-flag">
        <ul class="${r}-codetab-label">${P}</ul>
      </div>
      <div>
        <span class="${r}-codetab-lang">${A}</span>
        <span class="${r}-copy-button">${($=t.usedLanguageTextRef.value)==null?void 0:$.copyCode.text}</span>
      </div>
    </${R}>${_}</${F}>`};e.renderer.rules.fence=c},Do=Ro,Vo=e=>{e.core.ruler.push("init-line-number",t=>(t.tokens.forEach(l=>{l.map&&(l.attrs||(l.attrs=[]),l.attrs.push(["data-line",l.map[0].toString()]))}),!0))},Wo=(e,t)=>{const{editorConfig:l,markdownItConfig:n,markdownItPlugins:o}=V,i=L("editorId"),d=L("usedLanguageText"),g=L("showCodeRowNumber"),u=L("theme"),c=N([]),a=_o(e),m=Io(e),{reRenderRef:y,replaceMermaid:C}=Eo(e),h=Yl({html:!0,breaks:!0,linkify:!0});n(h,{editorId:i});const f=[{type:"image",plugin:Ql,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:No,options:{}},{type:"taskList",plugin:eo,options:{}},{type:"heading",plugin:Oo,options:{mdHeadingId:e.mdHeadingId,headsRef:c}},{type:"code",plugin:Do,options:{editorId:i,usedLanguageTextRef:d,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold}},{type:"xss",plugin:to,options:{xss(P){return{whiteList:Object.assign({},P.getDefaultWhiteList(),{input:["class","disabled","type","checked"],iframe:["class","width","height","src","title","border","frameborder","framespacing","allow","allowfullscreen"]})}}}}];e.noKatex||f.push({type:"katex",plugin:Po,options:{katexRef:m}}),e.noMermaid||f.push({type:"mermaid",plugin:Ho,options:{themeRef:u}}),o(f,{editorId:i}).forEach(P=>{h.use(P.plugin,P.options)});const $=h.options.highlight;h.set({highlight:(P,_,A)=>{if($){const R=$(P,_,A);if(R)return R}let I;!e.noHighlight&&a.value?a.value.getLanguage(_)?I=a.value.highlight(P,{language:_,ignoreIllegals:!0}).value:I=a.value.highlightAuto(P).value:I=h.utils.escapeHtml(P);const F=g?ko(I.replace(/^\n+|\n+$/g,"")):`<span class="${r}-code-block">${I.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${_}" language=${_}>${F}</code></pre>`}}),e.previewOnly||Vo(h);const b=N(`_article-key_${je()}`),p=N(e.sanitize(h.render(e.modelValue))),w=()=>{k.emit(i,$e,p.value),e.onHtmlChanged(p.value),e.onGetCatalog(c.value),k.emit(i,we,c.value),C()};O(w);const T=()=>{c.value=[],p.value=e.sanitize(h.render(e.modelValue)),w()},x=J(()=>(e.noKatex||m.value)&&(e.noHighlight||a.value));return S([se(e,"modelValue"),x,y],Ve(T,t?0:l.renderDelay)),S(()=>e.setting.preview,()=>{e.setting.preview&&le(()=>{k.emit(i,we,c.value)})}),O(()=>{k.on(i,{name:yl,callback(){k.emit(i,we,c.value)}}),k.on(i,{name:Ue,callback:()=>{b.value=`_article-key_${je()}`,T()}})}),{html:p,key:b}},Uo=Wo,Cl={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function},codeFoldable:{type:Boolean},autoFoldThreshold:{type:Number}},zo={...Cl,updateModelValue:{type:Function,default:()=>{}},onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},$l=j({name:"ContentPreview",props:Cl,setup(e){const t=L("editorId"),l=L("previewTheme"),n=L("showCodeRowNumber"),{html:o,key:i}=Uo(e,e.previewOnly);return So(e,o,i),xo(e,o),()=>s(Ee,null,[e.setting.preview&&s("div",{id:`${t}-preview-wrapper`,class:`${r}-preview-wrapper`,key:"content-preview-wrapper"},[s("div",{key:i.value,id:`${t}-preview`,class:[`${r}-preview`,`${l==null?void 0:l.value}-theme`,n&&`${r}-scrn`],innerHTML:o.value},null)]),!e.previewOnly&&e.setting.htmlPreview&&s("div",{id:`${t}-html-wrapper`,class:`${r}-preview-wrapper`,key:"html-preview-wrapper"},[s("div",{class:`${r}-html`},[o.value])])])}}),qo=(e,t)=>{const{editorId:l}=e,n=X({buildFinished:!1,html:""});S(()=>e.modelValue,()=>{n.buildFinished=!1}),O(()=>{k.on(l,{name:$e,callback(o){n.buildFinished=!0,n.html=o}}),k.on(l,{name:Ie,callback(){const o=new Promise(i=>{if(n.buildFinished)i(n.html);else{const d=g=>{i(g),k.remove(l,$e,d)};k.on(l,{name:$e,callback:d})}});e.onSave?e.onSave(e.modelValue,o):t.emit("onSave",e.modelValue,o)}})})},wl=e=>{const{editorId:t}=e,l=V.editorExtensions.highlight,n=V.editorExtensionsAttrs.highlight;ne("editorId",t),ne("theme",J(()=>e.theme)),ne("language",J(()=>e.language)),ne("highlight",J(()=>{const{js:i}=l,d={...Re,...l.css},{js:g,css:u={}}=n||{},c=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme,a=d[e.codeTheme]?d[e.codeTheme][c]:Re.atom[c],m=d[e.codeTheme]&&u[e.codeTheme]?u[e.codeTheme][c]:u.atom?u.atom[c]:{};return{js:{src:i,...g},css:{href:a,...m}}})),ne("showCodeRowNumber",e.showCodeRowNumber);const o=J(()=>{const i={...Dt,...V.editorConfig.languageUserDefined};return El(Il(Dt["en-US"]),i[e.language]||{})});ne("usedLanguageText",o),ne("previewTheme",J(()=>e.previewTheme)),ne("customIcon",J(()=>e.customIcon))},Go=e=>{wl(e),ne("tabWidth",e.tabWidth)},Tl=e=>{O(()=>{const{editorExtensions:t,editorExtensionsAttrs:l,iconfontType:n}=V;e.noIconfont||(n==="svg"?Z("script",{...l.iconfont,src:t.iconfont,id:`${r}-icon`}):Z("link",{...l.iconfontClass,rel:"stylesheet",href:t.iconfontClass,id:`${r}-icon-class`}))})},Ko=e=>{const{noPrettier:t,noUploadImg:l}=e,{editorExtensions:n,editorExtensionsAttrs:o}=V,i=t||n.prettier.prettierInstance,d=t||n.prettier.parserMarkdownInstance,g=l||n.cropper.instance;O(()=>{if(!g){const{js:u={},css:c={}}=o.cropper||{};Z("link",{...c,rel:"stylesheet",href:n.cropper.css,id:`${r}-cropperCss`}),Z("script",{...u,src:n.cropper.js,id:`${r}-cropper`})}if(!i){const{standaloneJs:u={}}=o.prettier||{};Z("script",{...u,src:n.prettier.standaloneJs,id:`${r}-prettier`})}if(!d){const{parserMarkdownJs:u={}}=o.prettier||{};Z("script",{...u,src:n.prettier.parserMarkdownJs,id:`${r}-prettierMD`})}}),Tl(e)},Zo=(e,t)=>{const{editorId:l}=e;O(()=>{k.on(l,{name:de,callback:n=>{e.onError instanceof Function?e.onError(n):t.emit("onError",n)}})})},Xo=(e,t)=>{const{editorId:l}=e,n=X({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview,previewOnly:!1}),o=(g,u)=>{n[g]=u===void 0?!n[g]:u,g==="preview"?(n.htmlPreview=!1,n.previewOnly=!1):g==="htmlPreview"?(n.preview=!1,n.previewOnly=!1):g==="previewOnly"&&!n.preview&&!n.htmlPreview&&(n.preview=!0)};let i="";const d=()=>{n.pageFullscreen||n.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=i};return S(()=>[n.pageFullscreen,n.fullscreen],d),O(()=>{k.on(l,{name:Le,callback(g,u){const c=a=>{k.emit(l,M,"image",{desc:"",urls:a}),u&&u()};e.onUploadImg?e.onUploadImg(g,c):t.emit("onUploadImg",g,c)}}),i=document.body.style.overflow,d()}),[n,o]},Jo=e=>{const{editorId:t}=e,l=N(!1);return O(()=>{k.on(t,{name:We,callback:o=>{o===void 0?l.value=!l.value:l.value=o}})}),J(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&l.value)},Yo=(e,t,l,n,o,i)=>{const{editorId:d}=e;S(()=>n.pageFullscreen,u=>{k.emit(d,Vt,u)}),S(()=>n.fullscreen,u=>{k.emit(d,Wt,u)}),S(()=>n.preview,u=>{k.emit(d,Ut,u)}),S(()=>n.previewOnly,u=>{k.emit(d,zt,u)}),S(()=>n.htmlPreview,u=>{k.emit(d,qt,u)}),S(l,u=>{k.emit(d,Gt,u)});const g={on(u,c){switch(u){case"pageFullscreen":{k.on(d,{name:Vt,callback(a){c(a)}});break}case"fullscreen":{k.on(d,{name:Wt,callback(a){c(a)}});break}case"preview":{k.on(d,{name:Ut,callback(a){c(a)}});break}case"previewOnly":{k.on(d,{name:zt,callback(a){c(a)}});break}case"htmlPreview":{k.on(d,{name:qt,callback(a){c(a)}});break}case"catalog":{k.on(d,{name:Gt,callback(a){c(a)}});break}}},togglePageFullscreen(u){o("pageFullscreen",u)},toggleFullscreen(u){k.emit(d,vl,u)},togglePreview(u){o("preview",u)},togglePreviewOnly(u){o("previewOnly",u)},toggleHtmlPreview(u){o("htmlPreview",u)},toggleCatalog(u){k.emit(d,We,u)},triggerSave(){k.emit(d,Ie)},insert(u){k.emit(d,M,"universal",{generate:u})},focus(u){var c;(c=i.value)==null||c.focus(u)},rerender(){k.emit(d,Ue)},getSelectedText(){var u;return(u=i.value)==null?void 0:u.getSelectedText()},resetHistory(){var u;(u=i.value)==null||u.resetHistory()},domEventHandlers(u){k.emit(d,kl,u)},execCommand(u){k.emit(d,M,u)}};t.expose(g)},Qo=e=>e,xl={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:()=>$o("md-editor-v3_")},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:Qo},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)},codeFoldable:{type:Boolean,default:!0},autoFoldThreshold:{type:Number,default:30}},en={...xl,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:fl},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:hl},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},Sl=["onHtmlChanged","onGetCatalog"],tn=[...Sl,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],ln=(e,t)=>{const{editorId:l}=e,n={rerender(){k.emit(l,Ue)}};t.expose(n)},Te=j({name:"MdPreview",props:xl,emits:Sl,setup(e,t){const{editorId:l,noKatex:n,noMermaid:o,noHighlight:i}=e;return wl(e),Tl(e),ln(e,t),pe(()=>{k.clear(l)}),()=>s("div",{id:l,class:[r,e.class,e.theme==="dark"&&`${r}-dark`,`${r}-previewOnly`],style:e.style},[s($l,{modelValue:e.modelValue,onHtmlChanged:d=>{e.onHtmlChanged?e.onHtmlChanged(d):t.emit("onHtmlChanged",d)},onGetCatalog:d=>{e.onGetCatalog?e.onGetCatalog(d):t.emit("onGetCatalog",d)},mdHeadingId:e.mdHeadingId,noMermaid:o,sanitize:e.sanitize,noKatex:n,formatCopiedText:e.formatCopiedText,noHighlight:i,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null)])}});Te.install=e=>(e.component(Te.name,Te),e);const on={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},_l=j({props:on,setup(e){return()=>{const{tocItem:t,mdHeadingId:l,scrollElement:n,onClick:o,scrollElementOffsetTop:i}=e;return s("div",{class:[`${r}-catalog-link`,t.active&&`${r}-catalog-active`],onClick:d=>{o(d,t),d.stopPropagation();const g=l(t.text,t.level,t.index),u=document.getElementById(g),c=n instanceof Element?n:document.querySelector(n);if(u&&c){let a=u.offsetParent,m=u.offsetTop;if(c.contains(a))for(;a&&c!=a;)m+=a==null?void 0:a.offsetTop,a=a==null?void 0:a.offsetParent;c==null||c.scrollTo({top:m-i,behavior:"smooth"})}}},[s("span",{title:t.text},[t.text]),s("div",{class:`${r}-catalog-wrapper`},[t.children&&t.children.map(d=>s(_l,{mdHeadingId:l,key:`${t.text}-link-${d.level}-${d.text}`,tocItem:d,scrollElement:n,onClick:o,scrollElementOffsetTop:i},null))])])}}}),nn=_l,an={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function}},be=j({name:"MdCatalog",props:an,emits:["onClick","onActive"],setup(e,t){const l=e.editorId,n=X({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),o=ce(),i=J(()=>{const c=[];return n.list.forEach((a,m)=>{const{text:y,level:C}=a,h={level:C,text:y,index:m+1,active:o.value===a};if(c.length===0)c.push(h);else{let f=c[c.length-1];if(h.level>f.level)for(let $=f.level+1;$<=6;$++){const{children:b}=f;if(!b){f.children=[h];break}if(f=b[b.length-1],h.level<=f.level){b.push(h);break}}else c.push(h)}}),c}),d=()=>n.scrollElement instanceof HTMLElement?n.scrollElement:document.querySelector(n.scrollElement),g=c=>{if(c.length===0)return n.list=[],!1;const{activeHead:a}=c.reduce((m,y,C)=>{const h=document.getElementById(e.mdHeadingId(y.text,y.level,C+1));if(h instanceof HTMLElement){const f=d(),$=Co(h,f);if($<e.offsetTop&&$>m.minTop)return{activeHead:y,minTop:$}}return m},{activeHead:c[0],minTop:Number.MIN_SAFE_INTEGER});o.value=a,n.list=c},u=()=>{g(n.list)};return S(()=>o.value,c=>{const a=c?{...c}:void 0;e.onActive?e.onActive(a):t.emit("onActive",a)}),O(()=>{let c=window;const a=()=>{const m=d();c=m===document.documentElement?window:m};k.on(l,{name:we,callback:m=>{c==null||c.removeEventListener("scroll",u),g(m),a(),c==null||c.addEventListener("scroll",u)}}),k.emit(l,yl),a(),c==null||c.addEventListener("scroll",u)}),pe(()=>{var c;const a=d();(c=a===document.documentElement?window:a)==null||c.removeEventListener("scroll",u)}),()=>s("div",{class:`${r}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[i.value.map(c=>s(nn,{mdHeadingId:e.mdHeadingId,tocItem:c,key:`link-${c.level}-${c.text}`,scrollElement:n.scrollElement,onClick:(a,m)=>{e.onClick?e.onClick(a,m):t.emit("onClick",a,m)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}});be.install=e=>(e.component(be.name,be),e);const rn={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},xe=j({name:"NormalToolbar",props:rn,emits:["onClick"],setup(e,t){return()=>{const l=Q({props:e,ctx:t},"trigger");return s("div",{class:`${r}-toolbar-item`,title:e.title,onClick:n=>{e.onClick instanceof Function?e.onClick(n):t.emit("onClick",n)}},[l])}}});xe.install=e=>(e.component(xe.name,xe),e);function sn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Pl(e)}const cn={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String}},Se=j({name:"ModalToolbar",props:cn,emits:["onClick","onClose","onAdjust"],setup(e,t){return()=>{const l=Q({props:e,ctx:t},"trigger"),n=Q({props:e,ctx:t},"default");return s(Ee,null,[s("div",{class:`${r}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[l]),s(fe,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:o=>{e.onAdjust instanceof Function?e.onAdjust(o):t.emit("onAdjust",o)}},sn(n)?n:{default:()=>[n]})])}}});Se.install=e=>(e.component(Se.name,Se),e);var dn=Object.defineProperty,un=(e,t,l)=>t in e?dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,ie=(e,t,l)=>(un(e,typeof t!="symbol"?t+"":t,l),l);const mn=j({setup(){return()=>s("div",{class:`${r}-divider`},null)}}),gn={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},fn=e=>{const t=L("editorId"),{editorExtensions:l,editorExtensionsAttrs:n}=V;let o=l.screenfull.instance;const i=N(!1),d=c=>{if(!o){k.emit(t,de,{name:"fullscreen",message:"fullscreen is undefined"});return}o.isEnabled?(i.value=!0,(c===void 0?!o.isFullscreen:c)?o.request():o.exit()):console.error("browser does not support screenfull!")},g=()=>{o&&o.isEnabled&&o.on("change",()=>{(i.value||e.setting.fullscreen)&&(i.value=!1,e.updateSetting("fullscreen"))})},u=()=>{o=window.screenfull,g()};return O(()=>{var c;g(),o||Z("script",{...(c=n.screenfull)==null?void 0:c.js,src:l.screenfull.js,id:`${r}-screenfull`,onload:u},"screenfull")}),O(()=>{k.on(t,{name:vl,callback:d})}),{fullscreenHandler:d}},hn={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},vn=j({name:"TableShape",props:hn,setup(e){const t=X({x:-1,y:-1}),l=()=>{const o=[...e.tableShape];return(!o[2]||o[2]<o[0])&&(o[2]=o[0]),(!o[3]||o[3]<o[3])&&(o[3]=o[1]),o},n=N(l());return S(()=>e.tableShape,()=>{n.value=l()}),()=>s("div",{class:`${r}-table-shape`,onMouseleave:()=>{n.value=l(),t.x=-1,t.y=-1}},[new Array(n.value[1]).fill("").map((o,i)=>s("div",{class:`${r}-table-shape-row`,key:`table-shape-row-${i}`},[new Array(n.value[0]).fill("").map((d,g)=>s("div",{class:`${r}-table-shape-col`,key:`table-shape-col-${g}`,onMouseenter:()=>{t.x=i,t.y=g,g+1===n.value[0]&&g+1<n.value[2]?n.value[0]++:g+2<n.value[0]&&n.value[0]>e.tableShape[0]&&n.value[0]--,i+1===n.value[1]&&i+1<n.value[3]?n.value[1]++:i+2<n.value[1]&&n.value[1]>e.tableShape[1]&&n.value[1]--},onClick:()=>{e.onSelected(t)}},[s("div",{class:[`${r}-table-shape-col-default`,i<=t.x&&g<=t.y&&`${r}-table-shape-col-include`]},null)]))]))])}}),bn=vn,pn={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},yn=j({props:pn,setup(e){const t=L("usedLanguageText"),l=L("editorId"),n=J(()=>{var i,d;switch(e.type){case"link":return(i=t.value.linkModalTips)==null?void 0:i.linkTitle;case"image":return(d=t.value.linkModalTips)==null?void 0:d.imageTitle;default:return""}}),o=X({desc:"",url:""});return S(()=>e.visible,i=>{i||setTimeout(()=>{o.desc="",o.url=""},200)}),()=>s(fe,{title:n.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var i,d,g,u,c;return[s("div",{class:`${r}-form-item`},[s("label",{class:`${r}-label`,for:`link-desc-${l}`},[(i=t.value.linkModalTips)==null?void 0:i.descLabel]),s("input",{placeholder:(d=t.value.linkModalTips)==null?void 0:d.descLabelPlaceHolder,class:`${r}-input`,id:`link-desc-${l}`,type:"text",value:o.desc,onChange:a=>{o.desc=a.target.value},autocomplete:"off"},null)]),s("div",{class:`${r}-form-item`},[s("label",{class:`${r}-label`,for:`link-url-${l}`},[(g=t.value.linkModalTips)==null?void 0:g.urlLabel]),s("input",{placeholder:(u=t.value.linkModalTips)==null?void 0:u.urlLabelPlaceHolder,class:`${r}-input`,id:`link-url-${l}`,type:"text",value:o.url,onChange:a=>{o.url=a.target.value},autocomplete:"off"},null)]),s("div",{class:`${r}-form-item`},[s("button",{class:[`${r}-btn`,`${r}-btn-row`],type:"button",onClick:()=>{e.onOk(o),o.desc="",o.url=""}},[(c=t.value.linkModalTips)==null?void 0:c.buttonOK])])]}})}}),kn={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Cn=j({props:kn,setup(e){const t=L("usedLanguageText"),l=L("editorId");let n=V.editorExtensions.cropper.instance;const o=N(),i=N(),d=N(),g=X({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let u=null;S(()=>e.visible,()=>{e.visible&&!g.cropperInited&&(n=n||window.Cropper,o.value.onchange=()=>{if(!n){k.emit(l,de,{name:"Cropper",message:"Cropper is undefined"});return}const a=o.value.files||[];if(g.imgSelected=!0,(a==null?void 0:a.length)>0){const m=new FileReader;m.onload=y=>{g.imgSrc=y.target.result,le(()=>{u=new n(i.value,{viewMode:2,preview:`.${r}-clip-preview-target`})})},m.readAsDataURL(a[0])}})}),S(()=>[g.imgSelected],()=>{d.value.style=""}),S(()=>g.isFullscreen,()=>{le(()=>{u==null||u.destroy(),d.value.style="",i.value&&(u=new n(i.value,{viewMode:2,preview:`.${r}-clip-preview-target`}))})});const c=()=>{u.clear(),u.destroy(),u=null,o.value.value="",g.imgSelected=!1};return()=>{var a;return s(fe,{class:`${r}-modal-clip`,title:(a=t.value.clipModalTips)==null?void 0:a.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:g.isFullscreen,onAdjust:m=>{g.isFullscreen=m},width:"668px",height:"421px"},{default:()=>{var m,y;return[s("div",{class:`${r}-form-item ${r}-clip`},[s("div",{class:`${r}-clip-main`},[g.imgSelected?s("div",{class:`${r}-clip-cropper`},[s("img",{src:g.imgSrc,ref:i,style:{display:"none"},alt:""},null),s("div",{class:`${r}-clip-delete`,onClick:c},[s(E,{name:"delete"},null)])]):s("div",{class:`${r}-clip-upload`,onClick:()=>{o.value.click()}},[s(E,{name:"upload"},null)])]),s("div",{class:`${r}-clip-preview`},[s("div",{class:`${r}-clip-preview-target`,ref:d},null)])]),s("div",{class:`${r}-form-item`},[s("button",{class:`${r}-btn`,type:"button",onClick:()=>{if(u){const C=u.getCroppedCanvas();k.emit(l,Le,[yo(C.toDataURL("image/png"))],e.onOk),c()}}},[((m=t.value.clipModalTips)==null?void 0:m.buttonUpload)||((y=t.value.linkModalTips)==null?void 0:y.buttonOK)])]),s("input",{ref:o,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),$n={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},wn=j({props:$n,setup(e){return()=>s(Ee,null,[s(yn,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),s(Cn,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),Tn=j({name:"MDEditorToolbar",props:gn,setup(e){const t=L("editorId"),l=L("usedLanguageText"),n=L("theme"),o=L("previewTheme"),i=L("language"),{fullscreenHandler:d}=fn(e),g=`${t}-toolbar-wrapper`,u=N(),c=X({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),a=(b,p)=>{k.emit(t,M,b,p)},m=X({type:"link",linkVisible:!1,clipVisible:!1}),y=N();O(()=>{k.on(t,{name:De,callback(b){m.type=b,m.linkVisible=!0}})});const C=J(()=>{const b=e.toolbars.filter(x=>!e.toolbarsExclude.includes(x)),p=b.indexOf("="),w=p===-1?b:b.slice(0,p+1),T=p===-1?[]:b.slice(p,Number.MAX_SAFE_INTEGER);return[w,T]}),h=N(),f=()=>{k.emit(t,Le,Array.from(h.value.files||[])),h.value.value=""};O(()=>{h.value.addEventListener("change",f)});const $=b=>{var p,w,T,x,P,_,A,I,F,R,G,K,D,W,oe,Y,ee,te,U,z,He,ze,qe,Ge,Ke,Ze,Xe,Je,Ye,Qe,et,tt,lt,ot,nt,at,it,rt,st,ct,dt,ut,mt,gt,ft,ht,vt,bt,pt,yt,kt,Ct,$t,wt,Tt,xt,St,_t,Et,It,Lt,Ht,At,Ft,Mt,Pt,Bt,Nt,jt;if(fl.includes(b))switch(b){case"-":return s(mn,null,null);case"bold":return s("div",{class:`${r}-toolbar-item`,title:(p=l.value.toolbarTips)==null?void 0:p.bold,onClick:()=>{a("bold")}},[s(E,{name:"bold"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(w=l.value.toolbarTips)==null?void 0:w.bold])]);case"underline":return s("div",{class:`${r}-toolbar-item`,title:(T=l.value.toolbarTips)==null?void 0:T.underline,onClick:()=>{a("underline")}},[s(E,{name:"underline"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(x=l.value.toolbarTips)==null?void 0:x.underline])]);case"italic":return s("div",{class:`${r}-toolbar-item`,title:(P=l.value.toolbarTips)==null?void 0:P.italic,onClick:()=>{a("italic")}},[s(E,{name:"italic"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(_=l.value.toolbarTips)==null?void 0:_.italic])]);case"strikeThrough":return s("div",{class:`${r}-toolbar-item`,title:(A=l.value.toolbarTips)==null?void 0:A.strikeThrough,onClick:()=>{a("strikeThrough")}},[s(E,{name:"strike-through"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(I=l.value.toolbarTips)==null?void 0:I.strikeThrough])]);case"title":return s(ge,{relative:`#${g}`,visible:c.title,onChange:H=>{c.title=H},overlay:s("ul",{class:`${r}-menu`,onClick:()=>{c.title=!1}},[s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h1")}},[(F=l.value.titleItem)==null?void 0:F.h1]),s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h2")}},[(R=l.value.titleItem)==null?void 0:R.h2]),s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h3")}},[(G=l.value.titleItem)==null?void 0:G.h3]),s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h4")}},[(K=l.value.titleItem)==null?void 0:K.h4]),s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h5")}},[(D=l.value.titleItem)==null?void 0:D.h5]),s("li",{class:`${r}-menu-item ${r}-menu-item-title`,onClick:()=>{a("h6")}},[(W=l.value.titleItem)==null?void 0:W.h6])])},{default:()=>{var H,q;return[s("div",{class:`${r}-toolbar-item`,title:(H=l.value.toolbarTips)==null?void 0:H.title},[s(E,{name:"title"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(q=l.value.toolbarTips)==null?void 0:q.title])])]}});case"sub":return s("div",{class:`${r}-toolbar-item`,title:(oe=l.value.toolbarTips)==null?void 0:oe.sub,onClick:()=>{a("sub")}},[s(E,{name:"sub"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Y=l.value.toolbarTips)==null?void 0:Y.sub])]);case"sup":return s("div",{class:`${r}-toolbar-item`,title:(ee=l.value.toolbarTips)==null?void 0:ee.sup,onClick:()=>{a("sup")}},[s(E,{name:"sup"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.sup])]);case"quote":return s("div",{class:`${r}-toolbar-item`,title:(U=l.value.toolbarTips)==null?void 0:U.quote,onClick:()=>{a("quote")}},[s(E,{name:"quote"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(z=l.value.toolbarTips)==null?void 0:z.quote])]);case"unorderedList":return s("div",{class:`${r}-toolbar-item`,title:(He=l.value.toolbarTips)==null?void 0:He.unorderedList,onClick:()=>{a("unorderedList")}},[s(E,{name:"unordered-list"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(ze=l.value.toolbarTips)==null?void 0:ze.unorderedList])]);case"orderedList":return s("div",{class:`${r}-toolbar-item`,title:(qe=l.value.toolbarTips)==null?void 0:qe.orderedList,onClick:()=>{a("orderedList")}},[s(E,{name:"ordered-list"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Ge=l.value.toolbarTips)==null?void 0:Ge.orderedList])]);case"task":return s("div",{class:`${r}-toolbar-item`,title:(Ke=l.value.toolbarTips)==null?void 0:Ke.task,onClick:()=>{a("task")}},[s(E,{name:"task"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Ze=l.value.toolbarTips)==null?void 0:Ze.task])]);case"codeRow":return s("div",{class:`${r}-toolbar-item`,title:(Xe=l.value.toolbarTips)==null?void 0:Xe.codeRow,onClick:()=>{a("codeRow")}},[s(E,{name:"code-row"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Je=l.value.toolbarTips)==null?void 0:Je.codeRow])]);case"code":return s("div",{class:`${r}-toolbar-item`,title:(Ye=l.value.toolbarTips)==null?void 0:Ye.code,onClick:()=>{a("code")}},[s(E,{name:"code"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Qe=l.value.toolbarTips)==null?void 0:Qe.code])]);case"link":return s("div",{class:`${r}-toolbar-item`,title:(et=l.value.toolbarTips)==null?void 0:et.link,onClick:()=>{m.type="link",m.linkVisible=!0}},[s(E,{name:"link"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(tt=l.value.toolbarTips)==null?void 0:tt.link])]);case"image":return e.noUploadImg?s("div",{class:`${r}-toolbar-item`,title:(lt=l.value.toolbarTips)==null?void 0:lt.image,onClick:()=>{m.type="image",m.linkVisible=!0}},[s(E,{name:"image"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(ot=l.value.toolbarTips)==null?void 0:ot.image])]):s(ge,{relative:`#${g}`,visible:c.image,onChange:H=>{c.image=H},overlay:s("ul",{class:`${r}-menu`,onClick:()=>{c.title=!1}},[s("li",{class:`${r}-menu-item ${r}-menu-item-image`,onClick:()=>{m.type="image",m.linkVisible=!0}},[(nt=l.value.imgTitleItem)==null?void 0:nt.link]),s("li",{class:`${r}-menu-item ${r}-menu-item-image`,onClick:()=>{h.value.click()}},[(at=l.value.imgTitleItem)==null?void 0:at.upload]),s("li",{class:`${r}-menu-item ${r}-menu-item-image`,onClick:()=>{m.clipVisible=!0}},[(it=l.value.imgTitleItem)==null?void 0:it.clip2upload])])},{default:()=>{var H,q;return[s("div",{class:`${r}-toolbar-item`,title:(H=l.value.toolbarTips)==null?void 0:H.image},[s(E,{name:"image"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(q=l.value.toolbarTips)==null?void 0:q.image])])]}});case"table":return s(ge,{relative:`#${g}`,visible:c.table,onChange:H=>{c.table=H},key:"bar-table",overlay:s(bn,{tableShape:e.tableShape,onSelected:H=>{a("table",{selectedShape:H})}},null)},{default:()=>{var H,q;return[s("div",{class:`${r}-toolbar-item`,title:(H=l.value.toolbarTips)==null?void 0:H.table},[s(E,{name:"table"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(q=l.value.toolbarTips)==null?void 0:q.table])])]}});case"revoke":return s("div",{class:`${r}-toolbar-item`,title:(rt=l.value.toolbarTips)==null?void 0:rt.revoke,onClick:()=>{k.emit(t,bl)}},[s(E,{name:"revoke"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(st=l.value.toolbarTips)==null?void 0:st.revoke])]);case"next":return s("div",{class:`${r}-toolbar-item`,title:(ct=l.value.toolbarTips)==null?void 0:ct.next,onClick:()=>{k.emit(t,pl)}},[s(E,{name:"next"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(dt=l.value.toolbarTips)==null?void 0:dt.next])]);case"save":return s("div",{class:`${r}-toolbar-item`,title:(ut=l.value.toolbarTips)==null?void 0:ut.save,onClick:()=>{k.emit(t,Ie)}},[s(E,{name:"baocun"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(mt=l.value.toolbarTips)==null?void 0:mt.save])]);case"prettier":return e.noPrettier?"":s("div",{class:`${r}-toolbar-item`,title:(gt=l.value.toolbarTips)==null?void 0:gt.prettier,onClick:()=>{a("prettier")}},[s(E,{name:"prettier"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(ft=l.value.toolbarTips)==null?void 0:ft.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&s("div",{class:`${r}-toolbar-item`,title:(ht=l.value.toolbarTips)==null?void 0:ht.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[s(E,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(vt=l.value.toolbarTips)==null?void 0:vt.pageFullscreen])]);case"fullscreen":return s("div",{class:`${r}-toolbar-item`,title:(bt=l.value.toolbarTips)==null?void 0:bt.fullscreen,onClick:()=>{d()}},[s(E,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(pt=l.value.toolbarTips)==null?void 0:pt.fullscreen])]);case"preview":return s("div",{class:`${r}-toolbar-item`,title:(yt=l.value.toolbarTips)==null?void 0:yt.preview,onClick:()=>{e.updateSetting("preview")}},[s(E,{name:"preview"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(kt=l.value.toolbarTips)==null?void 0:kt.preview])]);case"previewOnly":return s("div",{class:`${r}-toolbar-item`,title:(Ct=l.value.toolbarTips)==null?void 0:Ct.previewOnly,onClick:()=>{e.updateSetting("previewOnly")}},[s(E,{name:"preview-only"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[($t=l.value.toolbarTips)==null?void 0:$t.previewOnly])]);case"htmlPreview":return s("div",{class:`${r}-toolbar-item`,title:(wt=l.value.toolbarTips)==null?void 0:wt.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[s(E,{name:"coding"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Tt=l.value.toolbarTips)==null?void 0:Tt.htmlPreview])]);case"catalog":return s("div",{class:`${r}-toolbar-item`,title:(xt=l.value.toolbarTips)==null?void 0:xt.catalog,onClick:()=>{k.emit(t,We)},key:"bar-catalog"},[s(E,{name:"catalog"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(St=l.value.toolbarTips)==null?void 0:St.catalog])]);case"github":return s("div",{class:`${r}-toolbar-item`,title:(_t=l.value.toolbarTips)==null?void 0:_t.github,onClick:()=>Hl("https://github.com/imzbf/md-editor-v3")},[s(E,{name:"github"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(Et=l.value.toolbarTips)==null?void 0:Et.github])]);case"mermaid":return s(ge,{relative:`#${g}`,visible:c.mermaid,onChange:H=>{c.mermaid=H},overlay:s("ul",{class:`${r}-menu`,onClick:()=>{c.mermaid=!1}},[s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("flow")}},[(It=l.value.mermaid)==null?void 0:It.flow]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("sequence")}},[(Lt=l.value.mermaid)==null?void 0:Lt.sequence]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("gantt")}},[(Ht=l.value.mermaid)==null?void 0:Ht.gantt]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("class")}},[(At=l.value.mermaid)==null?void 0:At.class]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("state")}},[(Ft=l.value.mermaid)==null?void 0:Ft.state]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("pie")}},[(Mt=l.value.mermaid)==null?void 0:Mt.pie]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("relationship")}},[(Pt=l.value.mermaid)==null?void 0:Pt.relationship]),s("li",{class:`${r}-menu-item ${r}-menu-item-mermaid`,onClick:()=>{a("journey")}},[(Bt=l.value.mermaid)==null?void 0:Bt.journey])]),key:"bar-mermaid"},{default:()=>{var H,q;return[s("div",{class:`${r}-toolbar-item`,title:(H=l.value.toolbarTips)==null?void 0:H.mermaid},[s(E,{name:"mermaid"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(q=l.value.toolbarTips)==null?void 0:q.mermaid])])]}});case"katex":return s(ge,{relative:`#${g}`,visible:c.katex,onChange:H=>{c.katex=H},overlay:s("ul",{class:`${r}-menu`,onClick:()=>{c.katex=!1}},[s("li",{class:`${r}-menu-item ${r}-menu-item-katex`,onClick:()=>{a("katexInline")}},[(Nt=l.value.katex)==null?void 0:Nt.inline]),s("li",{class:`${r}-menu-item ${r}-menu-item-katex`,onClick:()=>{a("katexBlock")}},[(jt=l.value.katex)==null?void 0:jt.block])]),key:"bar-katex"},{default:()=>{var H,q;return[s("div",{class:`${r}-toolbar-item`,title:(H=l.value.toolbarTips)==null?void 0:H.katex},[s(E,{name:"formula"},null),e.showToolbarName&&s("div",{class:`${r}-toolbar-item-name`},[(q=l.value.toolbarTips)==null?void 0:q.katex])])]}})}else if(e.defToolbars instanceof Array){const H=e.defToolbars[b];return H?Oe(H,{theme:n.value,previewTheme:o.value,language:i.value,insert(Ae){k.emit(t,M,"universal",{generate:Ae})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const H=e.defToolbars.children[b];return H?Oe(H,{theme:n.value,previewTheme:o.value,language:i.value,insert(Ae){k.emit(t,M,"universal",{generate:Ae})}}):""}else return""};return S(()=>e.toolbars,()=>{le(()=>{u.value&&Ll(u.value)})},{immediate:!0}),()=>{const b=C.value[0].map(w=>$(w)),p=C.value[1].map(w=>$(w));return s(Ee,null,[e.toolbars.length>0&&s("div",{class:`${r}-toolbar-wrapper`,ref:u,id:g},[s("div",{class:[`${r}-toolbar`,e.showToolbarName&&`${r}-stn`]},[s("div",{class:`${r}-toolbar-left`,ref:y},[b]),s("div",{class:`${r}-toolbar-right`},[p])])]),s("input",{ref:h,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),s(wn,{linkVisible:m.linkVisible,clipVisible:m.clipVisible,type:m.type,onCancel:()=>{m.linkVisible=!1,m.clipVisible=!1},onOk:w=>{w&&a(m.type,{desc:w.desc,url:w.url,transform:m.type==="image"}),m.linkVisible=!1,m.clipVisible=!1}},null)])}}}),xn=`.${r}-preview > [data-line]`,Sn=(e,t)=>{const l=Ve(()=>{e.removeEventListener("scroll",n),e.addEventListener("scroll",n),t.removeEventListener("scroll",n),t.addEventListener("scroll",n)},50),n=o=>{const i=e.clientHeight,d=t.clientHeight,g=e.scrollHeight,u=t.scrollHeight,c=(g-i)/(u-d);o.target===e?(t.removeEventListener("scroll",n),t.scrollTo({top:e.scrollTop/c}),l()):(e.removeEventListener("scroll",n),e.scrollTo({top:t.scrollTop*c}),l())};return[()=>{l().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",n),t.removeEventListener("scroll",n)}]},_n=(e,t,l)=>{const{view:n}=l,o=Al(),i=$=>n.lineBlockAt(n.state.doc.line($).from).top,d=$=>n.lineBlockAt(n.state.doc.line($).from).height;let g=[],u=[],c=[];const a=()=>{g=[],u=[],c=[],u=u.concat(Array.from(t.querySelectorAll(xn)));const $=u.map(T=>Number(T.dataset.line)+1);c=c.concat($);const{lines:b}=n.state.doc;let p=1,w=$.shift()??b;for(let T=1;T<=b;T++)T===w&&(p=T,w=$.shift()||b+1),g.push({start:p,end:w-1})};let m=0,y=0;const C=()=>{var $,b;if(y!==0)return!1;m++;const{scrollDOM:p,contentHeight:w}=n;let T=+getComputedStyle(t).paddingTop.replace("px","");const x=n.lineBlockAtHeight(p.scrollTop),{number:P}=n.state.doc.lineAt(x.from),_=g[P-1];if(!_)return!1;let A=i(_.end)+d(_.end),I=0;const F=i(_.start),R=t.querySelector(`[data-line="${_.start-1}"]`)||(($=t.firstElementChild)==null?void 0:$.firstElementChild),G=t.querySelector(`[data-line="${_.end}"]`)||((b=t.lastElementChild)==null?void 0:b.lastElementChild);let K=0,D=0;F===0?(I=p.scrollTop/A,R===G?(T=0,A=w-p.offsetHeight,K=G.offsetTop+G.offsetHeight-t.clientHeight):K=G.offsetTop):(I=(p.scrollTop-F)/(A-F),D=R.offsetTop,K=G.offsetTop-D),A>=p.scrollHeight-p.clientHeight&&(I=(p.scrollTop-F)/(p.scrollHeight-p.clientHeight-F),D=R.offsetTop,K=t.scrollHeight-t.clientHeight-D+10);const W=D-T+K*I;o(t,W,()=>{m--})},h=()=>{var $,b,p,w,T,x;if(m!==0)return;y++;const{scrollDOM:P}=n,_=t.scrollTop,A=t.scrollHeight;let I=($=t.firstElementChild)==null?void 0:$.firstElementChild,F=(b=t.firstElementChild)==null?void 0:b.lastElementChild;if(c.length>0){let te=Math.ceil(Number(c[c.length-1])*(_/A)),U=c.findLastIndex(z=>z<=te);U=U===-1?0:U,te=c[U];for(let z=U;z>=0&&z<c.length;)if(u[z].offsetTop>_){if(z-1>=0){z--;continue}te=-1,U=z;break}else{if(z+1<c.length&&u[z+1].offsetTop<_){z++;continue}te=c[z],U=z;break}switch(te){case-1:{I=(p=t.firstElementChild)==null?void 0:p.firstElementChild,F=u[U];break}case c.length-1:{I=u[U],F=(w=t.firstElementChild)==null?void 0:w.lastElementChild;break}default:I=u[U],F=u[U+1===u.length?U:U+1]}}const R=I===((T=t.firstElementChild)==null?void 0:T.firstElementChild)?0:I.offsetTop;let G=F.offsetTop,K=0;const{start:D,end:W}=g[Number(I.dataset.line||0)],oe=i(D);let Y=i(W===n.state.doc.lines?W:W+1),ee=0;Y>P.scrollHeight-P.clientHeight||F.scrollTop>t.scrollHeight-t.clientHeight?(K=Math.max((_-R)/(t.scrollHeight-R-t.clientHeight),0),Y=i(n.state.doc.lines)+d(n.state.doc.lines),ee=8+Y-oe-e.clientHeight):I===((x=t.firstElementChild)==null?void 0:x.firstElementChild)?(I===F&&(G=F.offsetTop+F.offsetHeight+ +getComputedStyle(F).marginBottom.replace("px","")),ee=Y,K=Math.max(_/G,0)):(K=Math.max((_-R)/(G-R),0),ee=Y-oe),o(e,oe+ee*K,()=>{y--})},f=ul($=>{var b;const{scrollDOM:p,contentHeight:w}=n,T=p.clientHeight;if(w<=T||t.firstElementChild.clientHeight<=t.clientHeight||n.state.doc.lines<((b=g[g.length-1])==null?void 0:b.end))return!1;$.target===e?C():h()},1);return[()=>{a(),e.addEventListener("scroll",f),t.addEventListener("scroll",f),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",f),t.removeEventListener("scroll",f)}]},En=(e,t,l)=>{const n=L("editorId");let o=()=>{},i=()=>{};const d=()=>{o();const g=document.querySelector(`#${n} .cm-scroller`),u=document.querySelector(`[id="${n}-preview-wrapper"]`),c=document.querySelector(`[id="${n}-html-wrapper"]`);(u||c)&&([i,o]=(u?_n:Sn)(g,u||c,l.value),e.scrollAuto&&i())};S([t,se(e.setting,"preview"),se(e.setting,"htmlPreview"),se(e.setting,"fullscreen"),se(e.setting,"pageFullscreen")],()=>{le(d)}),S(()=>e.scrollAuto,g=>{g?i():o()}),S(()=>e.setting.previewOnly,g=>{g?o():i()}),O(d)},Me=(e,t,l)=>{var n;let o="",i=0,d=0,g=!0,u=!1;const c=t.getSelectedText(),a=V.editorConfig.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const m=e.replace(/^h(\d)/,(y,C)=>new Array(Number(C)).fill("#",0,C).join(""));o=`${m} ${c}`,i=m.length+1}else if(e==="prettier"){const m=window.prettier||V.editorExtensions.prettier.prettierInstance,y=[((n=window.prettierPlugins)==null?void 0:n.markdown)||V.editorExtensions.prettier.parserMarkdownInstance];!m||y[0]===void 0?(k.emit(l.editorId,de,{name:"prettier",message:"prettier is undefined"}),o=t.getValue()):o=m.format(t.getValue(),{parser:"markdown",plugins:y}),g=!1,u=!0}else switch(e){case"bold":{o=`**${c}**`,i=2,d=-2;break}case"underline":{o=`<u>${c}</u>`,i=3,d=-4;break}case"italic":{o=`*${c}*`,i=1,d=-1;break}case"strikeThrough":{o=`~~${c}~~`,i=2,d=-2;break}case"sub":{o=`<sub>${c}</sub>`,i=5,d=-6;break}case"sup":{o=`<sup>${c}</sup>`,i=5,d=-6;break}case"codeRow":{o="`"+c+"`",i=1,d=-1;break}case"quote":{o=`> ${c}`,i=2;break}case"orderedList":{o=`1. ${c}`,i=3;break}case"unorderedList":{o=`- ${c}`,i=2;break}case"task":{o=`- [ ] ${c}`,i=6;break}case"code":{const m=l.text||c||"",y=l.mode||"language";o=`\`\`\`${y}
${m}
\`\`\`
`,i=3,d=3+y.length-o.length;break}case"table":{o="|";const{selectedShape:m={x:1,y:1}}=l,{x:y,y:C}=m;for(let h=0;h<=C;h++)o+=" col |";o+=`
|`;for(let h=0;h<=C;h++)o+=" - |";for(let h=0;h<=y;h++){o+=`
|`;for(let f=0;f<=C;f++)o+=" content |"}i=2,d=5-o.length;break}case"link":{const{desc:m,url:y}=l;o=`[${m}](${y})`,g=!1;break}case"image":{const{desc:m,url:y,urls:C}=l;C instanceof Array?o=C.reduce((h,f)=>{const{url:$="",alt:b="",title:p=""}=typeof f=="object"?f:{url:f};return h+`![${b}](${$}${p?" '"+p+"'":""})
`},""):o=`![${m}](${y})
`,g=!1;break}case"flow":{o=`\`\`\`mermaid
${(a==null?void 0:a.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,i=3,d=10-o.length;break}case"sequence":{o=`\`\`\`mermaid
${(a==null?void 0:a.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,i=3,d=10-o.length;break}case"gantt":{o=`\`\`\`mermaid
${(a==null?void 0:a.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,i=3,d=10-o.length;break}case"class":{o=`\`\`\`mermaid
${(a==null?void 0:a.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,i=3,d=10-o.length;break}case"state":{o=`\`\`\`mermaid
${(a==null?void 0:a.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,i=3,d=10-o.length;break}case"pie":{o=`\`\`\`mermaid
${(a==null?void 0:a.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,i=3,d=10-o.length;break}case"relationship":{o=`\`\`\`mermaid
${(a==null?void 0:a.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,i=3,d=10-o.length;break}case"journey":{o=`\`\`\`mermaid
${(a==null?void 0:a.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,i=3,d=10-o.length;break}case"katexInline":{o="$$",i=1,d=-1;break}case"katexBlock":{o=`$$

$$
`,i=3,d=-4;break}case"universal":{const{generate:m}=l,y=m(c);o=y.targetValue,g=y.select??!0,i=y.deviationStart||0,d=y.deviationEnd||0}}return{text:o,options:{select:g,deviationStart:i,deviationEnd:d,replaceAll:u}}},In="#e5c07b",Jt="var(--md-color)",Ln="#56b6c2",Hn="#ffffff",he="var(--md-color)",Yt="#e5c07b",An="#e5c07b",Fn="var(--md-color)",Qt="#d19a66",Mn="#c678dd",Pn="#21252b",Bn="#2c313a",el="var(--md-bk-color)",Pe="var(--md-bk-color)",Nn="#ceedfa33",tl="#528bff",jn=re.theme({"&":{color:he,backgroundColor:el},".cm-content":{caretColor:tl},".cm-cursor, .cm-dropCursor":{borderLeftColor:tl},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Nn},".cm-panels":{backgroundColor:Pn,color:he},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:el,color:he,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Bn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Pe},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Pe,borderBottomColor:Pe},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:he}}},{dark:!0}),On=ml.define([{tag:v.keyword,color:Mn},{tag:[v.name,v.deleted,v.character,v.propertyName,v.macroName],color:Jt},{tag:[v.function(v.variableName),v.labelName],color:An},{tag:[v.color,v.constant(v.name),v.standard(v.name)],color:Qt},{tag:[v.definition(v.name),v.separator],color:he},{tag:[v.typeName,v.className,v.number,v.changed,v.annotation,v.modifier,v.self,v.namespace],color:In},{tag:[v.operator,v.operatorKeyword,v.url,v.escape,v.regexp,v.link,v.special(v.string)],color:Ln},{tag:[v.meta,v.comment],color:Yt},{tag:v.strong,fontWeight:"bold"},{tag:v.emphasis,fontStyle:"italic"},{tag:v.strikethrough,textDecoration:"line-through"},{tag:v.link,color:Yt,textDecoration:"underline"},{tag:v.heading,fontWeight:"bold",color:Jt},{tag:[v.atom,v.bool,v.special(v.variableName)],color:Qt},{tag:[v.processingInstruction,v.string,v.inserted],color:Fn},{tag:v.invalid,color:Hn}]),ll=[jn,gl(On)],Rn="#e5c07b",ol="#3f4a54",Dn="#56b6c2",Vn="#fff",ve="#3f4a54",nl="#2d8cf0",Wn="#2d8cf0",Un="#3f4a54",al="#d19a66",zn="#c678dd",qn="#f6f6f6",Gn="#ceedfa33",il="var(--md-bk-color)",Be="var(--md-bk-color)",Kn="#bad5fa",rl="#3f4a54",Zn=re.theme({"&":{color:ve,backgroundColor:il},".cm-content":{caretColor:rl},".cm-cursor, .cm-dropCursor":{borderLeftColor:rl},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Kn},".cm-panels":{backgroundColor:qn,color:ve},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:il,color:ve,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Gn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Be},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Be,borderBottomColor:Be},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ve}}}),Xn=ml.define([{tag:v.keyword,color:zn},{tag:[v.name,v.deleted,v.character,v.propertyName,v.macroName],color:ol},{tag:[v.function(v.variableName),v.labelName],color:Wn},{tag:[v.color,v.constant(v.name),v.standard(v.name)],color:al},{tag:[v.definition(v.name),v.separator],color:ve},{tag:[v.typeName,v.className,v.number,v.changed,v.annotation,v.modifier,v.self,v.namespace],color:Rn},{tag:[v.operator,v.operatorKeyword,v.url,v.escape,v.regexp,v.link,v.special(v.string)],color:Dn},{tag:[v.meta,v.comment],color:nl},{tag:v.strong,fontWeight:"bold"},{tag:v.emphasis,fontStyle:"italic"},{tag:v.strikethrough,textDecoration:"line-through"},{tag:v.link,color:nl,textDecoration:"underline"},{tag:v.heading,fontWeight:"bold",color:ol},{tag:[v.atom,v.bool,v.special(v.variableName)],color:al},{tag:[v.processingInstruction,v.string,v.inserted],color:Un},{tag:v.invalid,color:Vn}]),sl=[Zn,gl(Xn)],ke=(e,t,l,n,o)=>(i,d,g,u)=>{const c=`${e}${t}`.slice(u-g);i.dispatch(i.state.replaceSelection(`${c}${l}${n}`));const a=g+d.label.length+(o==="title"?l.length:0);i.dispatch({selection:ae.create([ae.range(g+d.label.length+(o==="title"?1:-t.length),a),ae.cursor(a)],1)}),i.focus()},cl=e=>(t,l,n,o)=>{const i=e.slice(o-n);t.dispatch(t.state.replaceSelection(`${i} `))},dl=e=>{const t=l=>{const n=l.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|\$\$?|!+\s*\w*/);return n===null||n.from==n.to&&l.explicit?null:{from:n.from,options:[...["h1","h2","h3","h4","h5","h6"].map((o,i)=>{const d=new Array(i+1).fill("#").join("");return{label:d,type:"text",apply:cl(d)}}),...["unchecked","checked"].map(o=>{const i=o==="checked"?"- [x]":"- [ ]";return{label:i,type:"text",apply:cl(i)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(o=>({label:`${o[0]}${o[1]}`,type:"text",apply:ke(o[0],o[1],"",o[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:ke("$","","","$","type")},{label:"$$",type:"text",apply:ke("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(o=>({label:`!!! ${o}`,type:"text",apply:ke("!!!",` ${o}`," Title",`

!!!`,"title")}))]}};return Wl({override:e?[t,...e]:[t]})},ue=e=>{const t=new me;return n=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(n)}):e.dispatch({effects:Kl.appendConfig.of(t.of(n))}),!0)};class Jn{constructor(t){ie(this,"view"),ie(this,"maxLength",Number.MAX_SAFE_INTEGER),ie(this,"toggleTabSize"),ie(this,"togglePlaceholder"),ie(this,"setExtensions"),ie(this,"toggleDisabled"),ie(this,"toggleReadOnly"),ie(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=ue(this.view),this.togglePlaceholder=ue(this.view),this.setExtensions=ue(this.view),this.toggleDisabled=ue(this.view),this.toggleReadOnly=ue(this.view),this.toggleMaxlength=ue(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,l=0,n=this.view.state.doc.length){this.view.dispatch({changes:{from:l,to:n,insert:t}})}getSelectedText(){const{from:t,to:l}=this.view.state.selection.main;return this.view.state.sliceDoc(t,l)}replaceSelectedText(t,l={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},n){try{if(l.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:o}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(t)),l.select){const i=o+t.length+l.deviationEnd;this.view.dispatch({selection:ae.create([ae.range(o+l.deviationStart,i),ae.cursor(i)],1)})}this.view.focus()}catch(o){if(o.message==="The input text is too long")k.emit(n,de,{name:"overlength",message:o.message,data:t});else throw o}}setTabSize(t){this.toggleTabSize([Fe.tabSize.of(t),Ul.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder(zl(t))}focus(t){if(this.view.focus(),!t)return;let l=0,n=0,o=0;switch(t){case"start":break;case"end":{l=n=o=this.getValue().length;break}default:l=t.rangeAnchor||t.cursorPos,n=t.rangeHead||t.cursorPos,o=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:ae.create([ae.range(l,n),ae.cursor(o)],1)})}setDisabled(t){this.toggleDisabled([re.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([Fe.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([Fe.changeFilter.of(l=>l.newDoc.length<=t)])}}const Yn=(e,t)=>{const l=L("editorId"),n=i=>{i instanceof Promise?i.then(d=>{k.emit(l,M,"universal",{generate(){return{targetValue:d}}})}).catch(d=>{console.error(d)}):k.emit(l,M,"universal",{generate(){return{targetValue:i}}})};return i=>{var d,g,u;if(!i.clipboardData)return;if(i.clipboardData.files.length>0){const{files:f}=i.clipboardData;k.emit(l,Le,Array.from(f).filter($=>/image\/.*/.test($.type))),i.preventDefault();return}const c=i.clipboardData.getData("text/plain"),a=((d=t.value)==null?void 0:d.view.state.selection.main.to)||0,m=((g=t.value)==null?void 0:g.view.state.doc.lineAt(a).from)||0,y=((u=t.value)==null?void 0:u.view.state.doc.sliceString(m,a))||"",C=/!\[.*\]\(\s*$/.test(y),h=/!\[.*\]\((.*)\s?.*\)/.test(c);if(C){const f=e.transformImgUrl(c);n(f),i.preventDefault();return}else if(h){const f=c.match(new RegExp(`(?<=!\\[.*\\]\\()([^)\\s]+)(?=\\s?["']?.*["']?\\))`,"g"));f?Promise.all(f.map($=>e.transformImgUrl($))).then($=>{n($.reduce((b,p,w)=>b.replace(f[w],p),c))}):n(c),i.preventDefault();return}if(e.autoDetectCode&&i.clipboardData.types.includes("vscode-editor-data")){const f=JSON.parse(i.clipboardData.getData("vscode-editor-data"));k.emit(l,M,"code",{mode:f.mode,text:i.clipboardData.getData("text/plain")}),i.preventDefault();return}e.maxlength&&c.length+e.modelValue.length>e.maxlength&&k.emit(l,de,{name:"overlength",message:"The input text is too long",data:c})}},Qn=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(k.emit(e,M,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:Zl,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:T=>(k.emit(e,Ie,T.state.doc.toString()),!0),shift:()=>(k.emit(e,M,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>(k.emit(e,M,"underline"),!0),shift:()=>(k.emit(e,M,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>(k.emit(e,M,"italic"),!0),shift:()=>(k.emit(e,De,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(k.emit(e,M,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(k.emit(e,M,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(k.emit(e,M,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(k.emit(e,M,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(k.emit(e,M,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(k.emit(e,M,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(k.emit(e,M,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(k.emit(e,M,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(k.emit(e,M,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(k.emit(e,M,"code"),!0),any(T,x){return(x.ctrlKey||x.metaKey)&&x.altKey&&x.code==="KeyC"?(k.emit(e,M,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(k.emit(e,De,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:(k.emit(e,M,"prettier"),!0)},{any:(T,x)=>(x.ctrlKey||x.metaKey)&&x.altKey&&x.shiftKey&&x.code==="KeyT"?(k.emit(e,M,"table"),!0):!1},...Gl],ea=e=>{const t=L("tabWidth"),l=L("editorId"),n=L("theme"),o=N(),i=ce(),d=new me,g=new me,u=new me,c=new me,a=new me,m=Qn(l,e),y=N(!1),h={paste:Yn(e,i),blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,compositionstart:()=>{y.value=!0},compositionend:(b,p)=>{y.value=!1,e.updateModelValue(p.state.doc.toString())},input:b=>{e.onInput&&e.onInput(b);const{data:p}=b;e.maxlength&&e.modelValue.length+p.length>e.maxlength&&k.emit(l,de,{name:"overlength",message:"The input text is too long",data:p})}},f=[Bl.of([...Nl,...jl,...m,Ol]),c.of(Ot()),d.of(Rl({codeLanguages:ql})),re.lineWrapping,re.updateListener.of(b=>{b.docChanged&&(e.onChange(b.state.doc.toString()),y.value||e.updateModelValue(b.state.doc.toString()))}),a.of(re.domEventHandlers(h))],$=()=>{const b=[...f,g.of(n.value==="light"?sl:ll),u.of(dl(e.completions))];return V.codeMirrorExtensions(n.value,b,[...m])};return O(()=>{const b=new re({doc:e.modelValue,parent:o.value,extensions:[$()]}),p=new Jn(b);i.value=p,setTimeout(()=>{p.setTabSize(t),p.setDisabled(e.disabled),p.setReadOnly(e.readonly),e.placeholder&&p.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&p.setMaxLength(e.maxlength),e.autofocus&&b.focus()},0),k.on(l,{name:bl,callback(){Dl(b)}}),k.on(l,{name:pl,callback(){Vl(b)}}),k.on(l,{name:M,callback(w,T={}){var x,P;if(w==="image"&&T.transform){const _=e.transformImgUrl(T.url);if(_ instanceof Promise)_.then(A=>{var I;const{text:F,options:R}=Me(w,i.value,{...T,url:A});(I=i.value)==null||I.replaceSelectedText(F,R,l)}).catch(A=>{console.error(A)});else{const{text:A,options:I}=Me(w,i.value,{...T,url:_});(x=i.value)==null||x.replaceSelectedText(A,I,l)}}else{const{text:_,options:A}=Me(w,i.value,T);(P=i.value)==null||P.replaceSelectedText(_,A,l)}}}),k.on(l,{name:kl,callback:ul(w=>{var T;const x={...h},P=Object.keys(h);for(const _ in w){const A=_;P.includes(A)?x[A]=(I,F)=>{w[A](I,F),I.defaultPrevented||h[A](I,F)}:x[A]=w[A]}(T=i.value)==null||T.view.dispatch({effects:a.reconfigure(re.domEventHandlers(x))})})})}),S(n,()=>{var b;(b=i.value)==null||b.view.dispatch({effects:g.reconfigure(n.value==="light"?sl:ll)})},{deep:!0}),S(()=>e.completions,()=>{var b;(b=i.value)==null||b.view.dispatch({effects:u.reconfigure(dl(e.completions))})},{deep:!0}),S(()=>e.modelValue,()=>{var b,p;((b=i.value)==null?void 0:b.getValue())!==e.modelValue&&((p=i.value)==null||p.setValue(e.modelValue))}),S(()=>e.placeholder,()=>{var b;(b=i.value)==null||b.setPlaceholder(e.placeholder)}),S(()=>e.disabled,()=>{var b;(b=i.value)==null||b.setDisabled(e.disabled)}),S(()=>e.readonly,()=>{var b;(b=i.value)==null||b.setDisabled(e.readonly)}),S(()=>e.maxlength,()=>{var b;e.maxlength&&((b=i.value)==null||b.setMaxLength(e.maxlength))}),{inputWrapperRef:o,codeMirrorUt:i,resetHistory(){var b,p;(b=i.value)==null||b.view.dispatch({effects:c.reconfigure([])}),(p=i.value)==null||p.view.dispatch({effects:c.reconfigure(Ot())})}}},ta=(e,t,l)=>{const n=X({resizedWidth:e.inputBoxWitdh}),o=X({width:e.inputBoxWitdh}),i=X({left:e.inputBoxWitdh,display:"initial"}),d=c=>{var a,m,y;const C=((a=t.value)==null?void 0:a.offsetWidth)||0,h=((m=t.value)==null?void 0:m.getBoundingClientRect().x)||0;let f=c.x-h;f<ye?f=ye:f>C-ye&&(f=C-ye);const $=`${f}px`;o.width=$,i.left=$,n.resizedWidth=$,(y=e.onInputBoxWitdhChange)==null||y.call(e,$)},g=()=>{document.addEventListener("mousemove",d)},u=()=>{document.removeEventListener("mousemove",d)};return S([l],()=>{var c,a;(c=l.value)==null||c.addEventListener("mousedown",g),(a=l.value)==null||a.addEventListener("mouseup",u)},{immediate:!0}),pe(()=>{var c,a;(c=l.value)==null||c.removeEventListener("mousedown",g),(a=l.value)==null||a.removeEventListener("mouseup",u)}),S(()=>e.inputBoxWitdh,c=>{c&&(o.width=c,i.left=c)}),S([se(e.setting,"htmlPreview"),se(e.setting,"preview")],()=>{!e.setting.htmlPreview&&!e.setting.preview?(o.width="100%",i.display="none"):(o.width=n.resizedWidth,i.display="initial")},{immediate:!0}),S(()=>e.setting.previewOnly,c=>{c?(o.width="0%",i.display="none"):(o.width=n.resizedWidth,i.display="initial")}),{inputWrapperStyle:o,resizeOperateStyle:i}},la=j({name:"MDEditorContent",props:zo,setup(e,t){const l=L("editorId"),n=N(""),o=N(),i=N(),{inputWrapperRef:d,codeMirrorUt:g,resetHistory:u}=ea(e),{inputWrapperStyle:c,resizeOperateStyle:a}=ta(e,o,i);return En(e,n,g),t.expose({getSelectedText(){var m;return(m=g.value)==null?void 0:m.getSelectedText()},focus(m){var y;(y=g.value)==null||y.focus(m)},resetHistory:u}),()=>s("div",{class:`${r}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:o},[s("div",{class:`${r}-input-wrapper`,style:c,ref:d},null),(e.setting.htmlPreview||e.setting.preview)&&s("div",{class:`${r}-resize-operate`,style:a,ref:i},null),s($l,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:m=>{n.value=m,e.onHtmlChanged(m)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.catalogVisible&&s(be,{theme:e.theme,class:`${r}-catalog-editor`,editorId:l,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),oa=j({props:{modelValue:{type:String,default:""}},setup(e){const t=L("usedLanguageText");return()=>{var l,n;return s("div",{class:`${r}-footer-item`},[s("label",{class:`${r}-footer-label`},[`${(l=t.value.footer)==null?void 0:l.markdownTotal}:`]),s("span",null,[((n=e.modelValue)==null?void 0:n.length)||0])])}}}),na={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},aa=j({props:na,setup(e){return()=>s("div",{class:[`${r}-checkbox`,e.checked&&`${r}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),ia={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},ra=j({props:ia,setup(e){const t=L("usedLanguageText");return()=>{var l;return s("div",{class:`${r}-footer-item`},[s("label",{class:`${r}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(l=t.value.footer)==null?void 0:l.scrollAuto]),s(aa,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),sa={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},ca=j({name:"MDEditorFooter",props:sa,setup(e){const t=J(()=>{const n=e.footers.indexOf("="),o=n===-1?e.footers:e.footers.slice(0,n),i=n===-1?[]:e.footers.slice(n,Number.MAX_SAFE_INTEGER);return[o,i]}),l=n=>{if(hl.includes(n))switch(n){case"markdownTotal":return s(oa,{modelValue:e.modelValue},null);case"scrollSwitch":return s(ra,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[n]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[n]||""};return()=>{const n=t.value[0].map(i=>l(i)),o=t.value[1].map(i=>l(i));return s("div",{class:`${r}-footer`},[s("div",{class:`${r}-footer-left`},[n]),s("div",{class:`${r}-footer-right`},[o])])}}}),Ne=j({name:"MdEditorV3",props:en,emits:tn,setup(e,t){const{editorId:l,noKatex:n,noMermaid:o,noPrettier:i,noUploadImg:d,noHighlight:g}=e,u=X({scrollAuto:e.scrollAuto}),c=N();qo(e,t),Go(e),Ko(e),Zo(e,t);const[a,m]=Xo(e,t),y=Jo(e);return pe(()=>{k.clear(l)}),Yo(e,t,y,a,m,c),()=>{const C=Q({props:e,ctx:t},"defToolbars"),h=Q({props:e,ctx:t},"defFooters");return s("div",{id:l,class:[r,e.class,e.theme==="dark"&&`${r}-dark`,a.fullscreen||a.pageFullscreen?`${r}-fullscreen`:""],style:e.style},[e.toolbars.length>0&&s(Tn,{noPrettier:i,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:a,updateSetting:m,tableShape:e.tableShape,defToolbars:C,noUploadImg:d,showToolbarName:e.showToolbarName},null),s(la,{ref:c,modelValue:e.modelValue,setting:a,mdHeadingId:e.mdHeadingId,noMermaid:o,noPrettier:i,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:n,scrollAuto:u.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:g,updateModelValue:f=>{t.emit("update:modelValue",f)},onChange:f=>{e.onChange&&e.onChange(f),t.emit("onChange",f)},onHtmlChanged:f=>{e.onHtmlChanged&&e.onHtmlChanged(f),t.emit("onHtmlChanged",f)},onGetCatalog:f=>{e.onGetCatalog&&e.onGetCatalog(f),t.emit("onGetCatalog",f)},onBlur:f=>{e.onBlur&&e.onBlur(f),t.emit("onBlur",f)},onFocus:f=>{e.onFocus&&e.onFocus(f),t.emit("onFocus",f)},onInput:f=>{e.onInput&&e.onInput(f),t.emit("onInput",f)},completions:e.completions,catalogVisible:y.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:f=>{e.onDrop&&e.onDrop(f),t.emit("onDrop",f)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:f=>{e.onInputBoxWitdhChange&&e.onInputBoxWitdhChange(f),t.emit("onInputBoxWitdhChange",f)},sanitizeMermaid:e.sanitizeMermaid,transformImgUrl:e.transformImgUrl,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.footers.length>0&&s(ca,{modelValue:e.modelValue,footers:e.footers,defFooters:h,scrollAuto:u.scrollAuto,onScrollAutoChange:f=>u.scrollAuto=f},null)])}}});Ne.install=e=>(e.component(Ne.name,Ne),e.use(xe).use(Ce).use(Se).use(be).use(Te),e);export{Ne as E};
