import{c as e,m as a,_ as l}from"./index-b3536dae.js";import{_ as o,u as t,a as n}from"./index-906593f8.js";import{_ as s,a as r}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-2a7f3db2.js";import{u as d,a as u,d as i}from"./userRole-0da7543c.js";import{u as c}from"./useDict-701118d3.js";import{h as m,M as p,x as v,ba as h,i as b,o as f,q as k,k as g,w as y,l as w,Q as _,F as S,C as R,S as U,bb as D,b4 as x,aU as N,b9 as j,Y as V,aV as F,az as C,bg as q,W as z,ax as A}from"./.pnpm-222492af.js";import"./dict-ec7f526e.js";const E=m({name:"UserRole"}),K=m({...E,setup(m){const{dict:E}=c(["status"]),K=p([{type:"selection"},{title:"ID",key:"id"},{title:"角色名称",key:"roleName"},{title:"角色排序",key:"roleSort"},{title:"角色状态",key:"roleStatus",render:e=>v(h,{rubberBand:!1,value:Number(e.roleStatus),loading:!!e.loading,checkedValue:1,uncheckedValue:0,onUpdateValue:()=>M(e)})},{title:"备注",key:"roleReamark"},{title:"操作",key:"actions",align:"center",fixed:"right",render:e=>[v(o,{onHandleDelete:()=>ae([e.id]),onHandleEdit:()=>le(e),onHandleView:()=>te(e)})]}]),M=async e=>{e.loading=!0;const a={...e,roleStatus:0===e.roleStatus?1:0};await d(a),await ce(),e.loading=!1},Q=p(),H=e=>({style:"cursor: pointer;",onClick:()=>{Q.value=e,T.value=e.roleMenu||[]}}),B=b((()=>e=>{var a;return e.id===(null==(a=Q.value)?void 0:a.id)?"selected-row":""})),I=e(),L=p(I.treeMenu),T=p([]),W=e=>{T.value=e},Y=p(!1),G=()=>{if(Q.value&&T.value){Y.value=!0;const e={...Q.value,roleMenu:T.value};d(e).then((e=>{Y.value=!1,a.success(e.message),ce()})).catch((()=>{Y.value=!1}))}else a.warning("请选择数据")},J={roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{modalVisible:O,modalAction:P,modalShowFooter:X,modalTitle:Z,modalLoading:$,handleAdd:ee,handleDelete:ae,handleEdit:le,handleDownload:oe,handleView:te,handleSave:ne,handlereset:se,defualtQuery:re,modalForm:de,modalFormRef:ue,changeCheckRow:ie,listQuery:ce,listData:me,pagination:pe,loading:ve,rowKey:he,btnDisabled:be}=t({name:"角色",url:"/userRole",key:"id",initForm:{roleName:"",roleStatus:1,roleSort:null,roleReamark:""},initQuery:{roleName:"",roleStatus:void 0},doCreate:u,doDelete:i,doUpdate:d,beforeSave:e=>e});return(e,a)=>{const o=U,t=s,d=D,u=x,i=r,c=N,m=j,p=V,v=F,b=n,M=C,Q=l,I=q,te=z,fe=A;return f(),k("div",null,[g(fe,{cols:"3","item-responsive":"","y-gap":8,"x-gap":10,responsive:"screen"},{default:y((()=>[g(M,{span:"3 m:2 l:2 xl:2"},{default:y((()=>[g(i,{columns:w(K),"onUpdate:columns":a[2]||(a[2]=e=>_(K)?K.value=e:null),btnDisabled:w(be),onSearch:w(ce),onReset:w(se),onAdd:w(ee),onDelete:w(ae),onEdit:w(le),onDownload:w(oe)},{queryBar:y((()=>[g(t,{label:"角色名称"},{default:y((()=>[g(o,{value:w(re).roleName,"onUpdate:value":a[0]||(a[0]=e=>w(re).roleName=e),size:"small",placeholder:"输入角色名称"},null,8,["value"])])),_:1}),g(t,{label:"角色状态"},{default:y((()=>{var e;return[g(d,{value:w(re).roleStatus,"onUpdate:value":a[1]||(a[1]=e=>w(re).roleStatus=e),placeholder:"选择角色状态",options:null==(e=w(E))?void 0:e.status},null,8,["value","options"])]})),_:1})])),default:y((()=>[g(u,{columns:w(K),data:w(me),pagination:w(pe),loading:w(ve),"row-key":w(he),"row-props":H,"row-class-name":w(B),striped:"",remote:!0,"onUpdate:checkedRowKeys":w(ie)},null,8,["columns","data","pagination","loading","row-key","row-class-name","onUpdate:checkedRowKeys"])])),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),g(b,{visible:w(O),"onUpdate:visible":a[7]||(a[7]=e=>_(O)?O.value=e:null),title:w(Z),loading:w($),"show-footer":w(X),width:"550px",onSave:w(ne)},{default:y((()=>[g(v,{ref_key:"modalFormRef",ref:ue,"label-placement":"left","label-align":"right","label-width":80,model:w(de),rules:J,disabled:"view"===w(P)},{default:y((()=>[g(c,{label:"角色名称",path:"roleName"},{default:y((()=>[g(o,{value:w(de).roleName,"onUpdate:value":a[3]||(a[3]=e=>w(de).roleName=e)},null,8,["value"])])),_:1}),g(p,{justify:"space-between"},{default:y((()=>[g(c,{label:"角色排序",path:"roleSort"},{default:y((()=>[g(m,{value:w(de).roleSort,"onUpdate:value":a[4]||(a[4]=e=>w(de).roleSort=e),clearable:""},null,8,["value"])])),_:1}),g(c,{label:"角色状态",path:"roleStatus"},{default:y((()=>[g(w(h),{"checked-value":1,"unchecked-value":0,value:w(de).roleStatus,"onUpdate:value":a[5]||(a[5]=e=>w(de).roleStatus=e)},null,8,["value"])])),_:1})])),_:1}),g(c,{label:"备注",path:"roleReamark"},{default:y((()=>[g(o,{value:w(de).roleReamark,"onUpdate:value":a[6]||(a[6]=e=>w(de).roleReamark=e)},null,8,["value"])])),_:1})])),_:1},8,["model","disabled"])])),_:1},8,["visible","title","loading","show-footer","onSave"])])),_:1}),g(M,{span:"3 m:1 l:1 xl:1"},{default:y((()=>[g(te,{title:"菜单分配",size:"small",segmented:!0},{"header-extra":y((()=>[g(w(S),{type:"primary",size:"small",loading:w(Y),onClick:G},{icon:y((()=>[g(Q,{icon:"mingcute:save-2-line"})])),default:y((()=>[R(" 保存 ")])),_:1},8,["loading"])])),default:y((()=>[g(I,{data:w(L),"checked-keys":w(T),"key-field":"path","label-field":"title",selectable:!1,"show-line":!0,"block-line":"",multiple:"",cascade:"",checkable:"","expand-on-click":"","onUpdate:checkedKeys":W},null,8,["data","checked-keys"])])),_:1})])),_:1})])),_:1})])}}});export{K as default};
