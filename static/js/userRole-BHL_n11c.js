import{k as e,p as a,a as l}from"./index-BYCMBCbo.js";import{_ as t,u as s,a as o}from"./index-rQKpO1eD.js";import{_ as i,a as d}from"./queryItem.vue_vue_type_style_index_0_scope_true_lang-NY9PludQ.js";import{u as n,a as r,s as u,b as m,d as p}from"./role-CExap95w.js";import{u as c}from"./useDict-DS0KAcRW.js";import{X as v,B as h,j as b,Y as j,T as y,L as f,W as k,n as g,M as w,G as _,a2 as U,m as D,H as x}from"./naive-ui-DtZk0WJ8.js";import{d as R,a as S,h as V,j as z,l as K,m as F,q,by as A,u as B,f as C,B as E}from"./@vue-7s647Hg9.js";import"./@vueuse-5kwDSbK9.js";import"./pinia-DxolVr3A.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-i18n-Af_yDAzr.js";import"./@intlify-DTqJVEQS.js";import"./vue-echarts-DpynRI6o.js";import"./resize-detector-BnI0Kdmb.js";import"./echarts-BRR8dxA2.js";import"./zrender-BiYmND81.js";import"./tslib-ZseNXxlj.js";import"./vue-router-BiYFwnTs.js";import"./@iconify-BsjoIFlE.js";import"./axios-CURSphCx.js";import"./@codemirror-BDMijoIR.js";import"./@lezer-B1NhjyO5.js";import"./crelt-DSg10-ms.js";import"./style-mod-BCKp0_dq.js";import"./w3c-keyname-f-y9tSbI.js";import"./lodash-es-BqiBNFWB.js";import"./pinia-plugin-persistedstate-Cs-f0Iqr.js";import"./date-fns-YzY8oSGz.js";import"./@babel-DJq229zv.js";import"./vueuc-Bk9f_vlN.js";import"./evtd-hWw0KU7y.js";import"./seemly-B0CCZz1h.js";import"./@css-render-sXtP9vHb.js";import"./vooks-Dg4BxRLw.js";import"./vdirs-aWQMhJPa.js";import"./@juggle-BnTvdTVm.js";import"./css-render-7x70jhNC.js";import"./@emotion-DFFAhID7.js";import"./treemate-CC-CeH3d.js";import"./async-validator-Cuo4gI4y.js";import"./dict-xpcayHuz.js";const H=R({name:"UserRole"}),Q=R({...H,setup(R){const H={add:["admin","role:add"],del:["admin","role:del"],edit:["admin","role:edit"],download:["admin","role:download"]},{dict:Q}=c(["status"]),L=S([{type:"selection",disabled:e=>1===e.id},{title:"ID",key:"id"},{title:"角色名称",key:"name"},{title:"角色排序",key:"sort"},{title:"角色状态",key:"status",render:e=>V(v,{rubberBand:!1,value:Number(e.status),loading:!!e.loading,checkedValue:1,uncheckedValue:0,disabled:1===e.id,onUpdateValue:()=>I(e)})},{title:"备注",key:"remark"},{title:"操作",key:"actions",align:"center",fixed:"right",render:e=>[V(t,{permission:H,disabled:1===e.id,onHandleDelete:()=>oe(e.id),onHandleEdit:()=>ie(e),onHandleView:()=>ne(e)})]}]),I=async e=>{try{e.loading=!0;const a={...e,status:0===e.status?1:0};await n(a),await he(),e.loading=!1}catch(a){e.loading=!1}},M=S(),N=e=>({style:"cursor: pointer;",onClick:async()=>{var a;e.id&&1!==e.id&&e.id!==(null==(a=M.value)?void 0:a.id)&&(J.value=await T(e.id)||[],M.value=e)}}),T=async e=>(await r(e)).data,W=z((()=>e=>{var a;return e.id===(null==(a=M.value)?void 0:a.id)?"selected-row":""})),G=S(),J=S([]),O=z((()=>{var e;return void 0===(null==(e=M.value)?void 0:e.id)}));e().then((e=>{G.value=e.data}));const P=e=>{J.value=e},X=S(!1),Y=()=>{var e;M.value&&J.value?(X.value=!0,u(null==(e=M.value)?void 0:e.id,J.value).then((e=>{X.value=!1,a.success(e.message)})).catch((()=>{X.value=!1}))):a.warning("请选择数据")},Z={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{modalVisible:$,modalAction:ee,modalShowFooter:ae,modalTitle:le,modalLoading:te,handleAdd:se,handleDelete:oe,handleEdit:ie,handleDownload:de,handleView:ne,handleSave:re,handlereset:ue,defualtQuery:me,modalForm:pe,modalFormRef:ce,changeCheckRow:ve,listQuery:he,listData:be,pagination:je,loading:ye,rowKey:fe,btnDisabled:ke,checkedRowKeys:ge}=s({name:"角色",url:"/role",key:"id",initForm:{name:"",status:1,sort:null,remark:""},initQuery:{name:"",status:null},doCreate:m,doDelete:p,doUpdate:n,beforeSave:e=>e,beforeRefresh:()=>(M.value=void 0,J.value=[],!0)});return(e,a)=>{const t=b,s=i,n=j,r=y,u=d,m=f,p=k,c=g,R=w,S=o,V=_,z=l,I=U,M=D,T=x;return K(),F("div",null,[q(T,{cols:"3","item-responsive":"","y-gap":8,"x-gap":10,responsive:"screen"},{default:A((()=>[q(V,{span:"3 m:2 l:2 xl:2"},{default:A((()=>[q(u,{columns:B(L),"onUpdate:columns":a[2]||(a[2]=e=>C(L)?L.value=e:null),btnDisabled:B(ke),permission:H,onSearch:B(he),onReset:B(ue),onAdd:B(se),onDelete:B(oe),onEdit:B(ie),onDownload:B(de)},{queryBar:A((()=>[q(s,{label:"角色名称"},{default:A((()=>[q(t,{value:B(me).name,"onUpdate:value":a[0]||(a[0]=e=>B(me).name=e),size:"small",placeholder:"输入角色名称"},null,8,["value"])])),_:1}),q(s,{label:"角色状态"},{default:A((()=>{var e;return[q(n,{value:B(me).status,"onUpdate:value":a[1]||(a[1]=e=>B(me).status=e),placeholder:"选择角色状态",clearable:"",options:null==(e=B(Q))?void 0:e.status},null,8,["value","options"])]})),_:1})])),default:A((()=>[q(r,{columns:B(L),data:B(be),pagination:B(je),loading:B(ye),"row-key":B(fe),"row-props":N,"row-class-name":B(W),striped:"",remote:!0,"checked-row-keys":B(ge),"onUpdate:checkedRowKeys":B(ve)},null,8,["columns","data","pagination","loading","row-key","row-class-name","checked-row-keys","onUpdate:checkedRowKeys"])])),_:1},8,["columns","btnDisabled","onSearch","onReset","onAdd","onDelete","onEdit","onDownload"]),q(S,{visible:B($),"onUpdate:visible":a[7]||(a[7]=e=>C($)?$.value=e:null),title:B(le),loading:B(te),"show-footer":B(ae),width:"550px",onSave:B(re)},{default:A((()=>[q(R,{ref_key:"modalFormRef",ref:ce,"label-placement":"left","label-align":"right","label-width":80,model:B(pe),rules:Z,disabled:"view"===B(ee)},{default:A((()=>[q(m,{label:"角色名称",path:"name"},{default:A((()=>[q(t,{value:B(pe).name,"onUpdate:value":a[3]||(a[3]=e=>B(pe).name=e)},null,8,["value"])])),_:1}),q(c,{justify:"space-between"},{default:A((()=>[q(m,{label:"角色排序",path:"sort"},{default:A((()=>[q(p,{value:B(pe).sort,"onUpdate:value":a[4]||(a[4]=e=>B(pe).sort=e),clearable:""},null,8,["value"])])),_:1}),q(m,{label:"角色状态",path:"status"},{default:A((()=>[q(B(v),{"checked-value":1,"unchecked-value":0,value:B(pe).status,"onUpdate:value":a[5]||(a[5]=e=>B(pe).status=e)},null,8,["value"])])),_:1})])),_:1}),q(m,{label:"备注",path:"remark"},{default:A((()=>[q(t,{value:B(pe).remark,"onUpdate:value":a[6]||(a[6]=e=>B(pe).remark=e)},null,8,["value"])])),_:1})])),_:1},8,["model","disabled"])])),_:1},8,["visible","title","loading","show-footer","onSave"])])),_:1}),q(V,{span:"3 m:1 l:1 xl:1"},{default:A((()=>[q(M,{title:"菜单分配",size:"small",segmented:!0},{"header-extra":A((()=>[q(B(h),{type:"primary",size:"small",loading:B(X),disabled:B(O),onClick:Y},{icon:A((()=>[q(z,{icon:"mingcute:save-2-line"})])),default:A((()=>[E(" 保存 ")])),_:1},8,["loading","disabled"])])),default:A((()=>[q(I,{data:B(G),"checked-keys":B(J),disabled:B(O),"key-field":"id","label-field":"title",selectable:!1,"show-line":!0,"block-line":"",multiple:"",checkable:"","expand-on-click":"","onUpdate:checkedKeys":P},null,8,["data","checked-keys","disabled"])])),_:1})])),_:1})])),_:1})])}}});export{Q as default};
