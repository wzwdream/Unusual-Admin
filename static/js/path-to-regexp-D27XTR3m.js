function D(r){for(var i=[],e=0;e<r.length;){var t=r[e];if(t==="*"||t==="+"||t==="?"){i.push({type:"MODIFIER",index:e,value:r[e++]});continue}if(t==="\\"){i.push({type:"ESCAPED_CHAR",index:e++,value:r[e++]});continue}if(t==="{"){i.push({type:"OPEN",index:e,value:r[e++]});continue}if(t==="}"){i.push({type:"CLOSE",index:e,value:r[e++]});continue}if(t===":"){for(var p="",n=e+1;n<r.length;){var u=r.charCodeAt(n);if(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||u===95){p+=r[n++];continue}break}if(!p)throw new TypeError("Missing parameter name at ".concat(e));i.push({type:"NAME",index:e,value:p}),e=n;continue}if(t==="("){var E=1,o="",n=e+1;if(r[n]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<r.length;){if(r[n]==="\\"){o+=r[n++]+r[n++];continue}if(r[n]===")"){if(E--,E===0){n++;break}}else if(r[n]==="("&&(E++,r[n+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(n));o+=r[n++]}if(E)throw new TypeError("Unbalanced pattern at ".concat(e));if(!o)throw new TypeError("Missing pattern at ".concat(e));i.push({type:"PATTERN",index:e,value:o}),e=n;continue}i.push({type:"CHAR",index:e,value:r[e++]})}return i.push({type:"END",index:e,value:""}),i}function M(r,i){i===void 0&&(i={});for(var e=D(r),t=i.prefixes,p=t===void 0?"./":t,n="[^".concat(R(i.delimiter||"/#?"),"]+?"),u=[],E=0,o=0,d="",c=function(v){if(o<e.length&&e[o].type===v)return e[o++].value},s=function(v){var h=c(v);if(h!==void 0)return h;var x=e[o],N=x.type,P=x.index;throw new TypeError("Unexpected ".concat(N," at ").concat(P,", expected ").concat(v))},T=function(){for(var v="",h;h=c("CHAR")||c("ESCAPED_CHAR");)v+=h;return v};o<e.length;){var w=c("CHAR"),C=c("NAME"),y=c("PATTERN");if(C||y){var l=w||"";p.indexOf(l)===-1&&(d+=l,l=""),d&&(u.push(d),d=""),u.push({name:C||E++,prefix:l,suffix:"",pattern:y||n,modifier:c("MODIFIER")||""});continue}var f=w||c("ESCAPED_CHAR");if(f){d+=f;continue}d&&(u.push(d),d="");var m=c("OPEN");if(m){var l=T(),A=c("NAME")||"",a=c("PATTERN")||"",g=T();s("CLOSE"),u.push({name:A||(a?E++:""),pattern:A&&!a?n:a,prefix:l,suffix:g,modifier:c("MODIFIER")||""});continue}s("END")}return u}function R(r){return r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function O(r){return r&&r.sensitive?"":"i"}function H(r,i){return r}function I(r,i,e){var t=r.map(function(p){return b(p,i,e).source});return new RegExp("(?:".concat(t.join("|"),")"),O(e))}function S(r,i,e){return _(M(r,e),i,e)}function _(r,i,e){e===void 0&&(e={});for(var t=e.strict,p=t===void 0?!1:t,n=e.start,u=n===void 0?!0:n,E=e.end,o=E===void 0?!0:E,d=e.encode,c=d===void 0?function(P){return P}:d,s=e.delimiter,T=s===void 0?"/#?":s,w=e.endsWith,C=w===void 0?"":w,y="[".concat(R(C),"]|$"),l="[".concat(R(T),"]"),f=u?"^":"",m=0,A=r;m<A.length;m++){var a=A[m];if(typeof a=="string")f+=R(c(a));else{var g=R(c(a.prefix)),v=R(c(a.suffix));if(a.pattern)if(g||v)if(a.modifier==="+"||a.modifier==="*"){var h=a.modifier==="*"?"?":"";f+="(?:".concat(g,"((?:").concat(a.pattern,")(?:").concat(v).concat(g,"(?:").concat(a.pattern,"))*)").concat(v,")").concat(h)}else f+="(?:".concat(g,"(").concat(a.pattern,")").concat(v,")").concat(a.modifier);else a.modifier==="+"||a.modifier==="*"?f+="((?:".concat(a.pattern,")").concat(a.modifier,")"):f+="(".concat(a.pattern,")").concat(a.modifier);else f+="(?:".concat(g).concat(v,")").concat(a.modifier)}}if(o)p||(f+="".concat(l,"?")),f+=e.endsWith?"(?=".concat(y,")"):"$";else{var x=r[r.length-1],N=typeof x=="string"?l.indexOf(x[x.length-1])>-1:x===void 0;p||(f+="(?:".concat(l,"(?=").concat(y,"))?")),N||(f+="(?=".concat(l,"|").concat(y,")"))}return new RegExp(f,O(e))}function b(r,i,e){return r instanceof RegExp?H(r):Array.isArray(r)?I(r,i,e):S(r,i,e)}export{b as p};
