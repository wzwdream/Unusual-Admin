import{x as Ae,F as ll,$ as yl,C as kl,M as $l}from"./@vavt-c7853335.js";import{d as A,i as E,q as s,v as q,a as B,w as T,e as M,x as he,y as Ve,j as K,n as ae,h as Cl,z as Y,F as He,t as ne,s as ve,A as wl}from"./@vue-b1321081.js";import{m as Tl}from"./codemirror-535e6aa3.js";import{_ as xl,E as se,H as ol,s as nl,k as Sl,i as El,m as Il,u as Fl,r as Ll,f as Q,g as Pe,j as Ml,p as Al,C as Se,l as Hl,n as Bl,S as jl,o as Pl}from"./@codemirror-f87e1e31.js";import{a as b}from"./@lezer-42a0dbdf.js";import{P as Nl}from"./medium-zoom-2b22670e.js";import{T as Ol}from"./copy-to-clipboard-162cd214.js";import{_ as Dl}from"./markdown-it-147551b9.js";import{r as Vl}from"./markdown-it-image-figures-6b4113de.js";import{H as Rl}from"./markdown-it-task-lists-1de1840c.js";import{x as _l}from"./lru-cache-ba592fc4.js";const c="md-editor",ql="md-editor-v3",Wl="https://at.alicdn.com/t/c/font_2605852_prouiefeic.js",zl="https://at.alicdn.com/t/c/font_2605852_prouiefeic.css",L="https://cdnjs.cloudflare.com/ajax/libs",Kl=`${L}/highlight.js/11.7.0/highlight.min.js`,Lt={main:`${L}/prettier/2.8.0/standalone.js`,markdown:`${L}/prettier/2.8.0/parser-markdown.js`},Mt={css:`${L}/cropperjs/1.5.13/cropper.min.css`,js:`${L}/cropperjs/1.5.13/cropper.min.js`},Ul=`${L}/screenfull.js/5.2.0/screenfull.min.js`,al=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","htmlPreview","catalog","github"],il=["markdownTotal","=","scrollSwitch"],At={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Word Count",scrollAuto:"Scroll Auto"}}},Gl=`${L}/mermaid/10.1.0/mermaid.esm.min.mjs`,Ht={js:`${L}/KaTeX/0.16.3/katex.min.js`,css:`${L}/KaTeX/0.16.3/katex.min.css`},Bt={a11y:{light:`${L}/highlight.js/11.7.0/styles/a11y-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/a11y-dark.min.css`},atom:{light:`${L}/highlight.js/11.7.0/styles/atom-one-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/atom-one-dark.min.css`},github:{light:`${L}/highlight.js/11.7.0/styles/github.min.css`,dark:`${L}/highlight.js/11.7.0/styles/github-dark.min.css`},gradient:{light:`${L}/highlight.js/11.7.0/styles/gradient-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/gradient-dark.min.css`},kimbie:{light:`${L}/highlight.js/11.7.0/styles/kimbie-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/kimbie-dark.min.css`},paraiso:{light:`${L}/highlight.js/11.7.0/styles/paraiso-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${L}/highlight.js/11.7.0/styles/qtcreator-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${L}/highlight.js/11.7.0/styles/stackoverflow-light.min.css`,dark:`${L}/highlight.js/11.7.0/styles/stackoverflow-dark.min.css`}},H={editorExtensions:{},editorConfig:{},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg"},Te=170,Z=({instance:e,ctx:t,props:l={}},o="default")=>{const a=(e==null?void 0:e.$slots[o])||(t==null?void 0:t.slots[o]);return(a?a(e):"")||l[o]},Zl={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},me=A({props:Zl,setup(e,t){const l=`${c}-dropdown-hidden`,o=q({overlayClass:[l],overlayStyle:{},triggerHover:!1,overlayHover:!1}),a=B(),i=B(),d=()=>{var r;o.triggerHover=!0;const p=a.value,k=i.value;if(!p||!k)return;const h=p.getBoundingClientRect(),g=p.offsetTop,v=p.offsetLeft,f=h.height,$=h.width,C=((r=document.querySelector(e.relative))==null?void 0:r.scrollLeft)||0;o.overlayStyle={...o.overlayStyle,top:g+f+"px",left:v-k.offsetWidth/2+$/2-C+"px"},e.onChange(!0)},u=()=>{o.overlayHover=!0};T(()=>e.visible,r=>{r?o.overlayClass=o.overlayClass.filter(p=>p!==l):o.overlayClass.push(l)});let m=-1;const n=r=>{a.value===r.target?o.triggerHover=!1:o.overlayHover=!1,clearTimeout(m),m=window.setTimeout(()=>{!o.overlayHover&&!o.triggerHover&&e.onChange(!1)},10)};return M(()=>{a.value.addEventListener("mouseenter",d),a.value.addEventListener("mouseleave",n),i.value.addEventListener("mouseenter",u),i.value.addEventListener("mouseleave",n)}),he(()=>{a.value.removeEventListener("mouseenter",d),a.value.removeEventListener("mouseleave",n),i.value.removeEventListener("mouseenter",u),i.value.removeEventListener("mouseleave",n)}),()=>{const r=Z({ctx:t}),p=Z({props:e,ctx:t},"overlay"),k=Ve(r instanceof Array?r[0]:r,{ref:a}),h=s("div",{class:[`${c}-dropdown`,o.overlayClass],style:o.overlayStyle,ref:i},[s("div",{class:`${c}-dropdown-overlay`},[p instanceof Array?p[0]:p])]);return[k,h]}}}),Xl={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},default:{type:[String,Object]}},Ee=A({name:"DropdownToolbar",props:Xl,emits:["onChange"],setup(e,t){const l=E("editorId");return()=>{const o=Z({props:e,ctx:t},"trigger"),a=Z({props:e,ctx:t},"overlay"),i=Z({props:e,ctx:t});return s(me,{relative:`#${l}-toolbar-wrapper`,visible:e.visible,onChange:d=>{e.onChange instanceof Function?e.onChange(d):t.emit("onChange",d)},overlay:a},{default:()=>[s("div",{class:`${c}-toolbar-item`,title:e.title||""},[o,i])]})}}});Ee.install=e=>(e.component(Ee.name,Ee),e);var Jl=Object.defineProperty,Yl=(e,t,l)=>t in e?Jl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,Ql=(e,t,l)=>(Yl(e,typeof t!="symbol"?t+"":t,l),l);let eo=class{constructor(){Ql(this,"pools",{})}remove(t,l,o){const a=this.pools[t]&&this.pools[t][l];a&&(this.pools[t][l]=a.filter(i=>i!==o))}clear(t){this.pools[t]={}}on(t,l){return this.pools[t]||(this.pools[t]={}),this.pools[t][l.name]||(this.pools[t][l.name]=[]),this.pools[t][l.name].push(l.callback),this.pools[t][l.name].includes(l.callback)}emit(t,l,...o){this.pools[t]||(this.pools[t]={});const a=this.pools[t][l];a&&a.forEach(i=>{try{i(...o)}catch(d){console.error(`${l} monitor event exception！`,d)}})}};const y=new eo,Be="onSave",qe="changeCatalogVisible",rl="changeFullscreen",jt="pageFullscreenChanged",Pt="fullscreenChanged",Nt="previewChanged",Ot="htmlPreviewChanged",Dt="catalogVisibleChanged",sl="textareaFocus",Ie="buildFinished",ce="errorCatcher",F="replace",je="uploadImage",Re="openModals",cl="ctrlZ",dl="ctrlShiftZ",_e="catalogChanged",ul="pushCatalog",to=(e,t="image.png")=>{const l=e.split(","),o=l[0].match(/:(.*?);/);if(o){const a=o[1],i=atob(l[1]);let d=i.length;const u=new Uint8Array(d);for(;d--;)u[d]=i.charCodeAt(d);return new File([u],t,{type:a})}return null},lo=e=>{if(!e)return e;const t=e.split(`
`),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{l.push("<span></span>")}),l.push("</span>"),`<span class="code-block">${e}</span>${l.join("")}`},oo=(e,t)=>{if(!e||!t)return 0;const l=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const o=t==null?void 0:t.getBoundingClientRect();return l.top-o.top},no=()=>`${Date.now().toString(36)}${Math.random().toString(36).substring(2)}`,Vt=(e,t)=>{const l=o=>{const a=e.parentElement||document.body,i=a.offsetWidth,d=a.offsetHeight,{clientWidth:u}=document.documentElement,{clientHeight:m}=document.documentElement,n=o.offsetX,r=o.offsetY,p=h=>{let g=h.x+document.body.scrollLeft-document.body.clientLeft-n,v=h.y+document.body.scrollTop-document.body.clientTop-r;g=g<1?1:g<u-i-1?g:u-i-1,v=v<1?1:v<m-d-1?v:m-d-1,t?t(g,v):(a.style.left=`${g}px`,a.style.top=`${v}px`)};document.addEventListener("mousemove",p);const k=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",k)};document.addEventListener("mouseup",k)};return e.addEventListener("mousedown",l),()=>{e.removeEventListener("mousedown",l)}},G=(e,t="")=>{const l=document.getElementById(e.id),o=e.onload;e.onload=null;const a=function(i){typeof o=="function"&&o.bind(this)(i),e.removeEventListener("load",a)};l?t!==""&&(l.addEventListener("load",a),Reflect.get(window,t)&&l.dispatchEvent(new Event("load"))):(e.addEventListener("load",a),document.head.appendChild(e))},ao=Ae((e,t,l)=>{const o=document.getElementById(e);o&&o.setAttribute(t,l)},10),io=A({props:{name:{type:String,default:""}},setup(e){return()=>H.iconfontType==="svg"?s("svg",{class:`${c}-icon`,"aria-hidden":"true"},[s("use",{"xlink:href":`#${c}-icon-${e.name}`},null)]):s("i",{class:`${c}-iconfont ${c}-icon-${e.name}`},null)}}),x=A({props:{name:{type:String,default:""}},setup(e){const t=E("customIcon");return()=>{const l=t.value[e.name];return typeof l=="object"?typeof l.component=="object"?Cl(l.component,l.props):s("span",{innerHTML:l.component},null):s(io,{name:e.name},null)}}}),ro={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}}},pe=A({name:"MdModal",props:ro,emits:["onClose"],setup(e,t){const l=B(e.visible),o=B([`${c}-modal`]),a=B(),i=B();let d=()=>{};const u=q({initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),m=K(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});return M(()=>{d=Vt(i.value,(n,r)=>{u.initPos.left=n+"px",u.initPos.top=r+"px"})}),he(()=>{d()}),T(()=>e.isFullscreen,n=>{n?d():d=Vt(i.value,(r,p)=>{u.initPos.left=r+"px",u.initPos.top=p+"px"})}),T(()=>e.visible,n=>{n?(o.value.push("zoom-in"),l.value=n,ae(()=>{const r=a.value.offsetWidth/2,p=a.value.offsetHeight/2,k=document.documentElement.clientWidth/2,h=document.documentElement.clientHeight/2;u.initPos.left=k-r+"px",u.initPos.top=h-p+"px"}),setTimeout(()=>{o.value=o.value.filter(r=>r!=="zoom-in")},140)):(o.value.push("zoom-out"),setTimeout(()=>{o.value=o.value.filter(r=>r!=="zoom-out"),l.value=n},130))}),()=>{const n=Z({ctx:t}),r=Z({props:e,ctx:t},"title");return s("div",{style:{display:l.value?"block":"none"}},[s("div",{class:`${c}-modal-mask`,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),s("div",{class:o.value,style:{...u.initPos,...m.value},ref:a},[s("div",{class:`${c}-modal-header`,ref:i},[r||""]),s("div",{class:`${c}-modal-body`},[n]),s("div",{class:`${c}-modal-func`},[e.showAdjust&&s("div",{class:`${c}-modal-adjust`,onClick:p=>{p.stopPropagation(),e.isFullscreen?u.initPos=u.historyPos:(u.historyPos=u.initPos,u.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[s(x,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),s("div",{class:`${c}-modal-close`,onClick:p=>{p.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[s(x,{name:"close"},null)])])])])}}});pe.install=e=>(e.component(pe.name,pe),e);const so=(e,t)=>{const l=E("editorId"),{noImgZoomIn:o}=e,a=Ae(()=>{const i=document.querySelectorAll(`#${l}-preview img`);i.length!==0&&Nl(i,{background:"#00000073"})});M(()=>{!o&&a()}),T([t,ne(e.setting,"preview")],()=>{!o&&a()})},co=so,uo=(e,t)=>{if(typeof t[e]=="string")return t[e];const l=`<i class="${c}-iconfont ${c}-icon-${e}"></i>`;switch(H.iconfontType){case"svg":return`<svg class="${c}-icon" aria-hidden="true"><use xlink:href="#${c}-icon-${e}"></use></svg>`;default:return l}},mo=(e,t)=>{const l=E("editorId"),o=E("usedLanguageText"),a=E("customIcon"),i=()=>{document.querySelectorAll(`#${l}-preview pre`).forEach(m=>{var n,r;let p=-1;(n=m.querySelector(".copy-button"))==null||n.remove();const k=((r=o.value.copyCode)==null?void 0:r.text)||"复制代码",h=document.createElement("span");h.setAttribute("class","copy-button"),h.dataset.tips=k,h.innerHTML=uo("copy",a.value),h.addEventListener("click",()=>{var g,v;clearTimeout(p);const f=m.querySelector("code").innerText,$=Ol(e.formatCopiedText(f)),C=((g=o.value.copyCode)==null?void 0:g.successTips)||"已复制！",w=((v=o.value.copyCode)==null?void 0:v.failTips)||"已复制！";h.dataset.tips=$?C:w,p=window.setTimeout(()=>{h.dataset.tips=k},1500)}),m.appendChild(h)})},d=()=>{ae(i)},u=m=>{m&&ae(i)};T(()=>t.value,d),T(()=>e.setting.preview,u),T(()=>e.setting.htmlPreview,u),T(()=>o.value,i),M(i)},po=mo,vo=e=>{var t;const l=(t=H.editorExtensions)==null?void 0:t.highlight,o=l==null?void 0:l.instance,a=E("highlight"),i=ve(o);return M(()=>{if(!e.noHighlight&&!i.value){const d=document.createElement("script");d.src=a.value.js,d.onload=()=>{i.value=window.hljs},d.id=`${c}-hljs`,G(d,"hljs");const u=document.createElement("link");u.rel="stylesheet",u.href=a.value.css,u.id=`${c}-hlCss`,G(u)}}),T(()=>a.value.css,d=>{ao(`${c}-hlCss`,"href",d)}),i},ho=vo,go=e=>{const t=E("theme"),{editorExtensions:l}=H,o=l==null?void 0:l.mermaid,a=ve(o==null?void 0:o.instance),i=ve(-1),d=new _l({max:1e3,ttl:6e5}),u=()=>{const m=a.value;!e.noMermaid&&m&&(m.initialize({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"}),i.value=i.value+1)};return T(()=>t.value,()=>{d.clear(),u()}),M(()=>{if(!e.noMermaid&&!(o!=null&&o.instance)){const m=(o==null?void 0:o.js)||Gl;if(/\.mjs/.test(m))xl(()=>import(m),[]).then(n=>{a.value=n.default,u()});else{const n=document.createElement("script");n.id=`${c}-mermaid`,n.src=m,n.onload=()=>{a.value=window.mermaid,u()},G(n,"mermaid")}}}),{mermaidRef:a,reRenderRef:i,replaceMermaid:()=>{ae(()=>{if(!e.noMermaid&&a.value){const m=document.querySelectorAll(`div.${c}-mermaid`),n=document.createElement("div");n.style.width=document.body.offsetWidth+"px",n.style.height=document.body.offsetHeight+"px",n.style.position="fixed",n.style.zIndex="-10000",n.style.top="-10000";let r=m.length;r>0&&document.body.appendChild(n),m.forEach(async p=>{let k=d.get(p.innerText);if(!k){const g=no(),v=a.value.renderAsync||a.value.render;let f="";try{f=await v(g,p.innerText,n)}catch{}k=typeof f=="string"?f:f.svg,d.set(p.innerText,k)}const h=document.createElement("p");h.className=`${c}-mermaid`,h.setAttribute("data-processed",""),h.innerHTML=k,p.dataset.line!==void 0&&(h.dataset.line=p.dataset.line),p.replaceWith(h),--r===0&&n.remove()})}})}}},fo=go,bo=e=>{var t;const l=(t=H.editorExtensions)==null?void 0:t.katex,o=l==null?void 0:l.instance,a=ve(o);return M(()=>{if(!e.noKatex&&!a.value){const i=document.createElement("script");i.src=(l==null?void 0:l.js)||Ht.js,i.onload=()=>{a.value=window.katex},i.id=`${c}-katex`;const d=document.createElement("link");d.rel="stylesheet",d.href=(l==null?void 0:l.css)||Ht.css,d.id=`${c}-katexCss`,G(i,"katex"),G(d)}}),a},yo=bo,ko=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(o,a,i,d,u)=>{const m=o[a],n=m.content.trim();if(m.info==="mermaid"){let r;return o[a].map&&o[a].level===0&&(r=o[a].map[0],o[a].attrSet("data-line",String(r))),`<div class="${c}-mermaid" ${r!==void 0?"data-line="+r:""} data-mermaid-theme=${t.themeRef.value}>${n}</div>`}return l(o,a,i,d,u)}},$o=ko,Rt=(e,t)=>{let l=!0,o=!0;const a=e.posMax,i=t>0?e.src.charCodeAt(t-1):-1,d=t+1<=a?e.src.charCodeAt(t+1):-1;return(i===32||i===9||d>=48&&d<=57)&&(o=!1),(d===32||d===9)&&(l=!1),{can_open:l,can_close:o}},Co=(e,t)=>{let l,o,a,i;if(e.src[e.pos]!=="$")return!1;if(a=Rt(e,e.pos),!a.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const d=e.pos+1;for(l=d;(l=e.src.indexOf("$",l))!==-1;){for(i=l-1;e.src[i]==="\\";)i-=1;if((l-i)%2==1)break;l+=1}return l===-1?(t||(e.pending+="$"),e.pos=d,!0):l-d===0?(t||(e.pending+="$$"),e.pos=d+1,!0):(a=Rt(e,l),a.can_close?(t||(o=e.push("math_inline","math",0),o.markup="$",o.content=e.src.slice(d,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=d,!0))},wo=(e,t,l,o)=>{let a,i,d,u,m=!1,n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];if(n+2>r||e.src.slice(n,n+2)!=="$$")return!1;if(n+=2,a=e.src.slice(n,r),o)return!0;for(a.trim().slice(-2)==="$$"&&(a=a.trim().slice(0,-2),m=!0),d=t;!m&&(d++,!(d>=l||(n=e.bMarks[d]+e.tShift[d],r=e.eMarks[d],n<r&&e.tShift[d]<e.blkIndent)));)e.src.slice(n,r).trim().slice(-2)==="$$"&&(u=e.src.slice(0,r).lastIndexOf("$$"),i=e.src.slice(n,u),m=!0);e.line=d+1;const p=e.push("math_block","math",0);return p.block=!0,p.content=(a&&a.trim()?a+`
`:"")+e.getLines(t+1,d,e.tShift[t],!0)+(i&&i.trim()?i:""),p.map=[t,e.line],p.markup="$$",!0},To=(e,t)=>{const l=a=>{if(t.katexRef.value){const i=t.katexRef.value.renderToString(a,{throwOnError:!1});return`<span class="${c}-katex-inline" data-processed>${i}</span>`}else return`<span class="${c}-katex-inline">${a}</span>`},o=(a,i)=>{if(t.katexRef.value){const d=t.katexRef.value.renderToString(a,{throwOnError:!1,displayMode:!0});return`<p class="${c}-katex-block" data-line=${i} data-processed>${d}</p>`}else return`<p class="${c}-katex-block" data-line=${i}>${a}</p>`};e.inline.ruler.after("escape","math_inline",Co),e.block.ruler.after("blockquote","math_block",wo,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(a,i)=>l(a[i].content),e.renderer.rules.math_block=(a,i)=>o(a[i].content,a[i].map[0])+`
`},xo=To,So=(e,t)=>{t=t||{};const l=3,o=t.marker||"!",a=o.charCodeAt(0),i=o.length;let d="",u="";const m=(r,p,k,h,g)=>{const v=r[p];return v.type==="admonition_open"?(r[p].attrPush(["class",`${c}-admonition ${c}-admonition-${v.info}`]),r[p].attrSet("data-line",String(r[p].map[0]))):v.type==="admonition_title_open"&&r[p].attrPush(["class",`${c}-admonition-title`]),g.renderToken(r,p,k)},n=r=>{const p=r.trim().split(" ",2);u="",d=p[0],p.length>1&&(u=r.substring(d.length+2)),(u===""||!u)&&(u=d)};e.block.ruler.before("code","admonition",(r,p,k,h)=>{let g,v,f,$=!1,C=r.bMarks[p]+r.tShift[p],w=r.eMarks[p];if(a!==r.src.charCodeAt(C))return!1;for(g=C+1;g<=w&&o[(g-C)%i]===r.src[g];g++);const I=Math.floor((g-C)/i);if(I!==l)return!1;g-=(g-C)%i;const P=r.src.slice(C,g),N=r.src.slice(g,w);if(n(N),h)return!0;for(v=p;v++,!(v>=k||(C=r.bMarks[v]+r.tShift[v],w=r.eMarks[v],C<w&&r.sCount[v]<r.blkIndent));)if(a===r.src.charCodeAt(C)&&!(r.sCount[v]-r.blkIndent>=4)){for(g=C+1;g<=w&&o[(g-C)%i]===r.src[g];g++);if(!(Math.floor((g-C)/i)<I)&&(g-=(g-C)%i,g=r.skipSpaces(g),!(g<w))){$=!0;break}}const de=r.parentType,j=r.lineMax;return r.parentType="root",r.lineMax=v,f=r.push("admonition_open","div",1),f.markup=P,f.block=!0,f.info=d,f.map=[p,v],f=r.push("admonition_title_open","p",1),f.markup=P+" "+d,f.map=[p,v],f=r.push("inline","",0),f.content=u,f.map=[p,r.line-1],f.children=[],f=r.push("admonition_title_close","p",-1),f.markup=P+" "+d,r.md.block.tokenize(r,p+1,v),f=r.push("admonition_close","div",-1),f.markup=r.src.slice(C,g),f.block=!0,r.parentType=de,r.lineMax=j,r.line=v+($?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=m,e.renderer.rules.admonition_title_open=m,e.renderer.rules.admonition_title_close=m,e.renderer.rules.admonition_close=m},Eo=So,Io=(e,t)=>{e.renderer.rules.heading_open=(l,o)=>{var a;const i=l[o],d=((a=l[o+1].children)==null?void 0:a.reduce((m,n)=>m+(n.content||""),""))||"",u=i.markup.length;return t.headsRef.value.push({text:d,level:u}),i.map&&i.level===0&&(i.attrSet("data-line",String(i.map[0])),i.attrSet("id",t.mdHeadingId(d,u,t.headsRef.value.length))),e.renderer.renderToken(l,o,t)},e.renderer.rules.heading_close=(l,o,a,i,d)=>d.renderToken(l,o,a)},Fo=Io,Lo=(e,t)=>{const l=e.renderer.rules.fence,o=e.utils.unescapeAll,a=/\[(\w*)(?::([\w ]*))?\]/;function i(n){return n.info?o(n.info).trim():""}function d(n){const r=i(n),[p=null,k=""]=(a.exec(r)||[]).slice(1);return[p,k]}function u(n){const r=i(n);return r?r.split(/(\s+)/g)[0]:""}const m=(n,r,p,k,h)=>{if(n[r].hidden)return"";const[g,v]=d(n[r]);if(g===null)return l(n,r,p,k,h);let f,$,C,w,I="",P="";for(let N=r;N<n.length&&(f=n[N],[$,C]=d(f),$===g);N++)f.info=f.info.replace(a,""),f.hidden=!0,w=N-r>0?"":" checked",I+=`<li><input type="radio" name="label-group-${t.editorId}-${r}"${w}><label for="group-${t.editorId}-${r}-tab-${N-r}" onclick="this.previousElementSibling.click()">${C||u(f)}</label></li>
`,P+=`<input type="radio" id="group-${t.editorId}-${r}-tab-${N-r}" name="group-${t.editorId}-${r}"${w}>
`+l(n,N,p,k,h);return`<div class="code-tabs">
<ul>
`+I+`</ul>
`+P+"</div>"};e.renderer.rules.fence=m},Mo=Lo,Ao=e=>{["paragraph_open","table_open","ordered_list_open","bullet_list_open","blockquote_open","hr","html_block","fence"].forEach(t=>{const l=e.renderer.rules[t];l?e.renderer.rules[t]=(o,a,i,d,u)=>{let m;const n=l(o,a,i,d,u);return o[a].map&&o[a].level===0&&!/^<!--/.test(n)?(m=o[a].map[0],n.replace(/^(<[^>]*)/,`$1 data-line="${m}"`)):n}:e.renderer.rules[t]=(o,a,i,d,u)=>{let m;return o[a].map&&o[a].level===0&&(m=o[a].map[0],o[a].attrSet("data-line",String(m))),u.renderToken(o,a,i)}})},Ho=(e,t)=>{const{editorConfig:l,markdownItConfig:o,markdownItPlugins:a}=H,i=E("editorId"),d=E("showCodeRowNumber"),u=E("theme"),m=B([]),n=ho(e),r=yo(e),{reRenderRef:p,replaceMermaid:k}=fo(e),h=Dl({html:!0,breaks:!0});o(h);const g=[{type:"katex",plugin:xo,options:{katexRef:r}},{type:"image",plugin:Vl,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Eo,options:{}},{type:"taskList",plugin:Rl,options:{}},{type:"heading",plugin:Fo,options:{mdHeadingId:e.mdHeadingId,headsRef:m}},{type:"codeTabs",plugin:Mo,options:{editorId:i}}];e.noMermaid||g.push({type:"mermaid",plugin:$o,options:{themeRef:u}}),a(g).forEach(w=>{h.use(w.plugin,w.options)}),h.set({highlight:(w,I)=>{let P;!e.noHighlight&&n.value?n.value.getLanguage(I)?P=n.value.highlight(w,{language:I,ignoreIllegals:!0}).value:P=n.value.highlightAuto(w).value:P=h.utils.escapeHtml(w);const N=d?lo(P.replace(/^\n+|\n+$/g,"")):`<span class="code-block">${P.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${I}" language=${I}>${N}</code></pre>`}}),Ao(h);const v=B(e.sanitize(h.render(e.modelValue))),f=()=>{y.emit(i,Ie,v.value),e.onHtmlChanged(v.value),e.onGetCatalog(m.value),y.emit(i,_e,m.value),k()};M(f);const $=Ae(async()=>{m.value=[],v.value=e.sanitize(h.render(e.modelValue)),f()},(l==null?void 0:l.renderDelay)!==void 0?l==null?void 0:l.renderDelay:t?0:500),C=K(()=>(e.noKatex||r.value)&&(e.noHighlight||n.value));return T([ne(e,"modelValue"),C,p],$),M(()=>{y.on(i,{name:ul,callback(){y.emit(i,_e,m.value)}})}),{html:v}},Bo=Ho,ml={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean}},jo={...ml,onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function}},pl=A({name:"ContentPreview",props:ml,setup(e){const t=E("editorId"),l=E("previewTheme"),o=E("showCodeRowNumber"),{html:a}=Bo(e,e.previewOnly);return po(e,a),co(e,a),()=>s(He,null,[s("div",{id:`${t}-preview-wrapper`,class:`${c}-preview-wrapper`,"data-show":e.setting.preview,key:"content-preview-wrapper"},[s("article",{id:`${t}-preview`,class:[`${c}-preview`,`${l==null?void 0:l.value}-theme`,o&&`${c}-scrn`],innerHTML:a.value},null)]),!e.previewOnly&&s("div",{id:`${t}-html-wrapper`,class:`${c}-preview-wrapper`,"data-show":e.setting.htmlPreview,key:"html-preview-wrapper"},[s("div",{class:`${c}-html`},[a.value])])])}}),Po=(e,t)=>{const{editorId:l}=e,o=q({buildFinished:!1,html:""});T(()=>e.modelValue,()=>{o.buildFinished=!1}),M(()=>{y.on(l,{name:Ie,callback(a){o.buildFinished=!0,o.html=a}}),y.on(l,{name:Be,callback(){const a=new Promise(i=>{if(o.buildFinished)i(o.html);else{const d=u=>{i(u),y.remove(l,Ie,d)};y.on(l,{name:Ie,callback:d})}});e.onSave?e.onSave(e.modelValue,a):t.emit("onSave",e.modelValue,a)}})})},vl=e=>{var t,l;const{editorId:o}=e,a=(l=(t=H)==null?void 0:t.editorExtensions)==null?void 0:l.highlight;Y("editorId",o),Y("theme",K(()=>e.theme)),Y("language",K(()=>e.language)),Y("highlight",K(()=>{const d={...Bt,...a==null?void 0:a.css},u=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme;return{js:(a==null?void 0:a.js)||Kl,css:d[e.codeTheme]?d[e.codeTheme][u]:Bt.atom[u]}})),Y("showCodeRowNumber",e.showCodeRowNumber);const i=K(()=>{var d,u;const m={...At,...(u=(d=H)==null?void 0:d.editorConfig)==null?void 0:u.languageUserDefined};return m[e.language]?m[e.language]:At["zh-CN"]});Y("usedLanguageText",i),Y("previewTheme",K(()=>e.previewTheme)),Y("customIcon",K(()=>e.customIcon))},No=e=>{vl(e),Y("tabWidth",e.tabWidth)},hl=e=>{M(()=>{var t,l;if(!e.noIconfont)if(H.iconfontType==="svg"){const o=document.createElement("script");o.src=((t=H.editorExtensions)==null?void 0:t.iconfont)||Wl,o.id=`${c}-icon`,G(o)}else{const o=document.createElement("link");o.rel="stylesheet",o.href=((l=H.editorExtensions)==null?void 0:l.iconfontClass)||zl,o.id=`${c}-icon-class`,G(o)}})},Oo=e=>{var t,l,o,a,i,d;const{noPrettier:u,noUploadImg:m}=e,{editorExtensions:n}=H,r=u||!!((l=(t=H.editorExtensions)==null?void 0:t.prettier)!=null&&l.prettierInstance),p=u||!!((a=(o=H.editorExtensions)==null?void 0:o.prettier)!=null&&a.parserMarkdownInstance),k=m||!!((d=(i=H.editorExtensions)==null?void 0:i.cropper)!=null&&d.instance);M(()=>{var h,g,v,f;const $=document.createElement("script"),C=document.createElement("script");$.src=((h=n==null?void 0:n.prettier)==null?void 0:h.standaloneJs)||Lt.main,$.id=`${c}-prettier`,C.src=((g=n==null?void 0:n.prettier)==null?void 0:g.parserMarkdownJs)||Lt.markdown,C.id=`${c}-prettierMD`;const w=document.createElement("link");w.rel="stylesheet",w.href=((v=n==null?void 0:n.cropper)==null?void 0:v.css)||Mt.css,w.id=`${c}-cropperCss`;const I=document.createElement("script");I.src=((f=n==null?void 0:n.cropper)==null?void 0:f.js)||Mt.js,I.id=`${c}-cropper`,k||(G(w),G(I)),r||G($),p||G(C)}),hl(e)},Do=(e,t)=>{const{editorId:l}=e;M(()=>{y.on(l,{name:ce,callback:o=>{e.onError instanceof Function?e.onError(o):t.emit("onError",o)}})})},Vo=(e,t)=>{const{editorId:l}=e,o=q({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview}),a=(u,m)=>{o[u]=m===void 0?!o[u]:m,u==="preview"&&o.preview?o.htmlPreview=!1:u==="htmlPreview"&&o.htmlPreview&&(o.preview=!1)};let i="";const d=()=>{o.pageFullscreen||o.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=i};return T(()=>[o.pageFullscreen,o.fullscreen],d),M(()=>{y.on(l,{name:je,callback(u,m){const n=r=>{y.emit(l,F,"image",{desc:"",urls:r}),m&&m()};e.onUploadImg?e.onUploadImg(u,n):t.emit("onUploadImg",u,n)}}),i=document.body.style.overflow,d()}),[o,a]},Ro=e=>{const{editorId:t}=e,l=B(!1);return M(()=>{y.on(t,{name:qe,callback:o=>{o===void 0?l.value=!l.value:l.value=o}})}),K(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&l.value)},_o=(e,t,l,o,a)=>{const{editorId:i}=e;T(()=>o.pageFullscreen,u=>{y.emit(i,jt,u)}),T(()=>o.fullscreen,u=>{y.emit(i,Pt,u)}),T(()=>o.preview,u=>{y.emit(i,Nt,u)}),T(()=>o.htmlPreview,u=>{y.emit(i,Ot,u)}),T(l,u=>{y.emit(i,Dt,u)});const d={on(u,m){switch(u){case"pageFullscreen":{y.on(i,{name:jt,callback(n){m(n)}});break}case"fullscreen":{y.on(i,{name:Pt,callback(n){m(n)}});break}case"preview":{y.on(i,{name:Nt,callback(n){m(n)}});break}case"htmlPreview":{y.on(i,{name:Ot,callback(n){m(n)}});break}case"catalog":{y.on(i,{name:Dt,callback(n){m(n)}});break}}},togglePageFullscreen(u){a("pageFullscreen",u)},toggleFullscreen(u){y.emit(i,rl,u)},togglePreview(u){a("preview",u)},toggleHtmlPreview(u){a("htmlPreview",u)},toggleCatalog(u){y.emit(i,qe,u)},triggerSave(){y.emit(i,Be)},insert(u){y.emit(i,F,"universal",{generate:u})},focus(u){y.emit(i,sl,u)}};t.expose(d)},qo=e=>e,gl={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:ql},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:qo},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}}},Wo={...gl,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:al},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array,default:()=>[6,4]},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:il},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function}},fl=["onHtmlChanged","onGetCatalog"],zo=[...fl,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],Ko=A({name:"MdPreview",props:gl,emits:fl,setup(e,t){const{editorId:l,noKatex:o,noMermaid:a,noHighlight:i}=e;return vl(e),hl(e),he(()=>{y.clear(l)}),()=>s("div",{id:l,class:[c,e.class,e.theme==="dark"&&`${c}-dark`,`${c}-previewOnly`],style:e.style},[s(pl,{modelValue:e.modelValue,onHtmlChanged:d=>{e.onHtmlChanged?e.onHtmlChanged(d):t.emit("onHtmlChanged",d)},onGetCatalog:d=>{e.onGetCatalog?e.onGetCatalog(d):t.emit("onGetCatalog",d)},mdHeadingId:e.mdHeadingId,noMermaid:a,sanitize:e.sanitize,noKatex:o,formatCopiedText:e.formatCopiedText,noHighlight:i,noImgZoomIn:e.noImgZoomIn,previewOnly:!0},null)])}}),Fe=Ko;Fe.install=e=>(e.component(Fe.name,Fe),e);const Uo={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},bl=A({props:Uo,setup(e){return()=>{const{tocItem:t,mdHeadingId:l,scrollElement:o,onClick:a,scrollElementOffsetTop:i}=e;return s("div",{class:[`${c}-catalog-link`,t.active&&`${c}-catalog-active`],onClick:d=>{a(d,t),d.stopPropagation();const u=l(t.text,t.level,t.index),m=document.getElementById(u),n=o instanceof Element?o:document.querySelector(o);if(m&&n){let r=m.offsetParent,p=m.offsetTop;if(n.contains(r))for(;r&&n!=r;)p+=r==null?void 0:r.offsetTop,r=r==null?void 0:r.offsetParent;n==null||n.scrollTo({top:p-i,behavior:"smooth"})}}},[s("span",{title:t.text},[t.text]),s("div",{class:`${c}-catalog-wrapper`},[t.children&&t.children.map(d=>s(bl,{mdHeadingId:l,key:`${t.text}-link-${d.level}-${d.text}`,tocItem:d,scrollElement:o,onClick:a,scrollElementOffsetTop:i},null))])])}}}),Go=bl,Zo={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function}},Xo=A({name:"MdCatalog",props:Zo,emits:["onClick"],setup(e,t){const l=e.editorId,o=q({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),a=ve(),i=K(()=>{const n=[];return o.list.forEach((r,p)=>{const{text:k,level:h}=r,g={level:h,text:k,index:p+1,active:a.value===r};if(n.length===0)n.push(g);else{let v=n[n.length-1];if(g.level>v.level)for(let f=v.level+1;f<=6;f++){const{children:$}=v;if(!$){v.children=[g];break}if(v=$[$.length-1],g.level<=v.level){$.push(g);break}}else n.push(g)}}),n}),d=()=>o.scrollElement instanceof HTMLElement?o.scrollElement:document.querySelector(o.scrollElement),u=ll(n=>{if(n.length===0)return o.list=[],!1;const{activeHead:r}=n.reduce((p,k,h)=>{const g=document.getElementById(e.mdHeadingId(k.text,k.level,h+1));if(g instanceof HTMLElement){const v=d(),f=oo(g,v);if(f<e.offsetTop&&f>p.minTop)return{activeHead:k,minTop:f}}return p},{activeHead:n[0],minTop:Number.MIN_SAFE_INTEGER});a.value=r,o.list=n}),m=()=>{u(o.list)};return M(()=>{var n;const r=d();(n=r===document.documentElement?window:r)==null||n.addEventListener("scroll",m),y.on(l,{name:_e,callback:p=>{u(p)}}),y.emit(l,ul)}),he(()=>{var n;const r=d();(n=r===document.documentElement?window:r)==null||n.removeEventListener("scroll",m)}),()=>s("div",{class:`${c}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[i.value.map(n=>s(Go,{mdHeadingId:e.mdHeadingId,tocItem:n,key:`link-${n.level}-${n.text}`,scrollElement:o.scrollElement,onClick:(r,p)=>{e.onClick?e.onClick(r,p):t.emit("onClick",r,p)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}}),$e=Xo;$e.install=e=>(e.component($e.name,$e),e);const Jo={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},Le=A({name:"NormalToolbar",props:Jo,emits:["onClick"],setup(e,t){return()=>{const l=Z({props:e,ctx:t},"trigger");return s("div",{class:`${c}-toolbar-item`,title:e.title,onClick:o=>{e.onClick instanceof Function?e.onClick(o):t.emit("onClick",o)}},[l])}}});Le.install=e=>(e.component(Le.name,Le),e);function Yo(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!wl(e)}const Qo={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},Me=A({name:"ModalToolbar",props:Qo,emits:["onClick","onClose","onAdjust"],setup(e,t){return()=>{const l=Z({props:e,ctx:t},"trigger"),o=Z({props:e,ctx:t},"default");return s(He,null,[s("div",{class:`${c}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[l]),s(pe,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:a=>{e.onAdjust instanceof Function?e.onAdjust(a):t.emit("onAdjust",a)}},Yo(o)?o:{default:()=>[o]})])}}});Me.install=e=>(e.component(Me.name,Me),e);var en=Object.defineProperty,tn=(e,t,l)=>t in e?en(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,oe=(e,t,l)=>(tn(e,typeof t!="symbol"?t+"":t,l),l);const ln=A({setup(){return()=>s("div",{class:`${c}-divider`},null)}}),on={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},nn=e=>{var t,l,o,a;const i=E("editorId");let d=(l=(t=H.editorExtensions)==null?void 0:t.screenfull)==null?void 0:l.instance;const u=(a=(o=H.editorExtensions)==null?void 0:o.screenfull)==null?void 0:a.js,m=B(!1),n=k=>{if(!d){y.emit(i,ce,{name:"fullscreen",message:"fullscreen is undefined"});return}d.isEnabled?(m.value=!0,(k===void 0?!d.isFullscreen:k)?d.request():d.exit()):console.error("browser does not support screenfull!")},r=()=>{d&&d.isEnabled&&d.on("change",()=>{(m.value||e.setting.fullscreen)&&(m.value=!1,e.updateSetting("fullscreen"))})},p=()=>{d=window.screenfull,r()};return M(()=>{if(r(),!d){const k=document.createElement("script");k.src=u||Ul,k.onload=p,k.id=`${c}-screenfull`,G(k,"screenfull")}}),M(()=>{y.on(i,{name:rl,callback:n})}),{fullscreenHandler:n}},an={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},rn=A({name:"TableShape",props:an,setup(e){const t=q({x:-1,y:-1});return()=>s("div",{class:`${c}-table-shape`,onMouseleave:()=>{t.x=-1,t.y=-1}},[new Array(e.tableShape[1]).fill("").map((l,o)=>s("div",{class:`${c}-table-shape-row`,key:`table-shape-row-${o}`},[new Array(e.tableShape[0]).fill("").map((a,i)=>s("div",{class:`${c}-table-shape-col`,key:`table-shape-col-${i}`,onMouseenter:()=>{t.x=o,t.y=i},onClick:()=>{e.onSelected(t)}},[s("div",{class:[`${c}-table-shape-col-default`,o<=t.x&&i<=t.y&&`${c}-table-shape-col-include`]},null)]))]))])}}),sn=rn,cn={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},dn=A({props:cn,setup(e){const t=E("usedLanguageText"),l=E("editorId"),o=K(()=>{var i,d;switch(e.type){case"link":return(i=t.value.linkModalTips)==null?void 0:i.linkTitle;case"image":return(d=t.value.linkModalTips)==null?void 0:d.imageTitle;default:return""}}),a=q({desc:"",url:""});return T(()=>e.visible,i=>{i||setTimeout(()=>{a.desc="",a.url=""},200)}),()=>s(pe,{title:o.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var i,d,u,m,n;return[s("div",{class:`${c}-form-item`},[s("label",{class:`${c}-label`,for:`link-desc-${l}`},[(i=t.value.linkModalTips)==null?void 0:i.descLabel]),s("input",{placeholder:(d=t.value.linkModalTips)==null?void 0:d.descLabelPlaceHolder,class:`${c}-input`,id:`link-desc-${l}`,type:"text",value:a.desc,onChange:r=>{a.desc=r.target.value},autocomplete:"off"},null)]),s("div",{class:`${c}-form-item`},[s("label",{class:`${c}-label`,for:`link-url-${l}`},[(u=t.value.linkModalTips)==null?void 0:u.urlLabel]),s("input",{placeholder:(m=t.value.linkModalTips)==null?void 0:m.urlLabelPlaceHolder,class:`${c}-input`,id:`link-url-${l}`,type:"text",value:a.url,onChange:r=>{a.url=r.target.value},autocomplete:"off"},null)]),s("div",{class:`${c}-form-item`},[s("button",{class:[`${c}-btn`,`${c}-btn-row`],type:"button",onClick:()=>{e.onOk(a),a.desc="",a.url=""}},[(n=t.value.linkModalTips)==null?void 0:n.buttonOK])])]}})}}),un={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},mn=A({props:un,setup(e){var t,l,o;const a=E("usedLanguageText"),i=E("editorId");let d=(o=(l=(t=H)==null?void 0:t.editorExtensions)==null?void 0:l.cropper)==null?void 0:o.instance;const u=B(),m=B(),n=B(),r=q({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let p=null;T(()=>e.visible,()=>{e.visible&&!r.cropperInited&&(d=d||window.Cropper,u.value.onchange=()=>{if(!d){y.emit(i,ce,{name:"Cropper",message:"Cropper is undefined"});return}const h=u.value.files||[];if(r.imgSelected=!0,(h==null?void 0:h.length)>0){const g=new FileReader;g.onload=v=>{r.imgSrc=v.target.result,ae(()=>{p=new d(m.value,{viewMode:2,preview:`.${c}-clip-preview-target`})})},g.readAsDataURL(h[0])}})}),T(()=>[r.imgSelected],()=>{n.value.style=""}),T(()=>r.isFullscreen,()=>{ae(()=>{p==null||p.destroy(),n.value.style="",m.value&&(p=new d(m.value,{viewMode:2,preview:`.${c}-clip-preview-target`}))})});const k=()=>{p.clear(),p.destroy(),p=null,u.value.value="",r.imgSelected=!1};return()=>{var h;return s(pe,{class:`${c}-modal-clip`,title:(h=a.value.clipModalTips)==null?void 0:h.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:r.isFullscreen,onAdjust:g=>{r.isFullscreen=g},width:"668px",height:"421px"},{default:()=>{var g,v;return[s("div",{class:`${c}-form-item ${c}-clip`},[s("div",{class:`${c}-clip-main`},[r.imgSelected?s("div",{class:`${c}-clip-cropper`},[s("img",{src:r.imgSrc,ref:m,style:{display:"none"},alt:""},null),s("div",{class:`${c}-clip-delete`,onClick:k},[s(x,{name:"delete"},null)])]):s("div",{class:`${c}-clip-upload`,onClick:()=>{u.value.click()}},[s(x,{name:"upload"},null)])]),s("div",{class:`${c}-clip-preview`},[s("div",{class:`${c}-clip-preview-target`,ref:n},null)])]),s("div",{class:`${c}-form-item`},[s("button",{class:`${c}-btn`,type:"button",onClick:()=>{if(p){const f=p.getCroppedCanvas();y.emit(i,je,[to(f.toDataURL("image/png"))],e.onOk),k()}}},[((g=a.value.clipModalTips)==null?void 0:g.buttonUpload)||((v=a.value.linkModalTips)==null?void 0:v.buttonOK)])]),s("input",{ref:u,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),pn={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},vn=A({props:pn,setup(e){return()=>s(He,null,[s(dn,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),s(mn,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),hn=A({name:"MDEditorToolbar",props:on,setup(e){const t=E("editorId"),l=E("usedLanguageText"),o=E("theme"),a=E("language"),{fullscreenHandler:i}=nn(e),d=`${t}-toolbar-wrapper`,u=B(),m=q({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),n=(f,$)=>{y.emit(t,F,f,$)},r=q({type:"link",linkVisible:!1,clipVisible:!1}),p=B();M(()=>{y.on(t,{name:Re,callback(f){r.type=f,r.linkVisible=!0}})});const k=K(()=>{const f=e.toolbars.filter(I=>!e.toolbarsExclude.includes(I)),$=f.indexOf("="),C=$===-1?f:f.slice(0,$+1),w=$===-1?[]:f.slice($,Number.MAX_SAFE_INTEGER);return[C,w]}),h=B(),g=()=>{y.emit(t,je,Array.from(h.value.files||[])),h.value.value=""};M(()=>{h.value.addEventListener("change",g)});const v=f=>{var $,C,w,I,P,N,de,j,D,J,X,_,V,R,W,ee,ie,Ce,ge,re,te,fe,le,z,U,be,we,We,ze,Ke,Ue,Ge,Ze,Xe,Je,Ye,Qe,et,tt,lt,ot,nt,at,it,rt,st,ct,dt,ut,mt,pt,vt,ht,gt,ft,bt,yt,kt,$t,Ct,wt,Tt,xt,St,Et,It,Ft;if(al.includes(f))switch(f){case"-":return s(ln,null,null);case"bold":return s("div",{class:`${c}-toolbar-item`,title:($=l.value.toolbarTips)==null?void 0:$.bold,onClick:()=>{n("bold")}},[s(x,{name:"bold"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(C=l.value.toolbarTips)==null?void 0:C.bold])]);case"underline":return s("div",{class:`${c}-toolbar-item`,title:(w=l.value.toolbarTips)==null?void 0:w.underline,onClick:()=>{n("underline")}},[s(x,{name:"underline"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(I=l.value.toolbarTips)==null?void 0:I.underline])]);case"italic":return s("div",{class:`${c}-toolbar-item`,title:(P=l.value.toolbarTips)==null?void 0:P.italic,onClick:()=>{n("italic")}},[s(x,{name:"italic"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(N=l.value.toolbarTips)==null?void 0:N.italic])]);case"strikeThrough":return s("div",{class:`${c}-toolbar-item`,title:(de=l.value.toolbarTips)==null?void 0:de.strikeThrough,onClick:()=>{n("strikeThrough")}},[s(x,{name:"strike-through"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(j=l.value.toolbarTips)==null?void 0:j.strikeThrough])]);case"title":return s(me,{relative:`#${d}`,visible:m.title,onChange:S=>{m.title=S},overlay:s("ul",{class:`${c}-menu`,onClick:()=>{m.title=!1}},[s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h1")}},[(D=l.value.titleItem)==null?void 0:D.h1]),s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h2")}},[(J=l.value.titleItem)==null?void 0:J.h2]),s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h3")}},[(X=l.value.titleItem)==null?void 0:X.h3]),s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h4")}},[(_=l.value.titleItem)==null?void 0:_.h4]),s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h5")}},[(V=l.value.titleItem)==null?void 0:V.h5]),s("li",{class:`${c}-menu-item ${c}-menu-item-title`,onClick:()=>{n("h6")}},[(R=l.value.titleItem)==null?void 0:R.h6])])},{default:()=>{var S,O;return[s("div",{class:`${c}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.title},[s(x,{name:"title"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(O=l.value.toolbarTips)==null?void 0:O.title])])]}});case"sub":return s("div",{class:`${c}-toolbar-item`,title:(W=l.value.toolbarTips)==null?void 0:W.sub,onClick:()=>{n("sub")}},[s(x,{name:"sub"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ee=l.value.toolbarTips)==null?void 0:ee.sub])]);case"sup":return s("div",{class:`${c}-toolbar-item`,title:(ie=l.value.toolbarTips)==null?void 0:ie.sup,onClick:()=>{n("sup")}},[s(x,{name:"sup"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(Ce=l.value.toolbarTips)==null?void 0:Ce.sup])]);case"quote":return s("div",{class:`${c}-toolbar-item`,title:(ge=l.value.toolbarTips)==null?void 0:ge.quote,onClick:()=>{n("quote")}},[s(x,{name:"quote"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(re=l.value.toolbarTips)==null?void 0:re.quote])]);case"unorderedList":return s("div",{class:`${c}-toolbar-item`,title:(te=l.value.toolbarTips)==null?void 0:te.unorderedList,onClick:()=>{n("unorderedList")}},[s(x,{name:"unordered-list"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(fe=l.value.toolbarTips)==null?void 0:fe.unorderedList])]);case"orderedList":return s("div",{class:`${c}-toolbar-item`,title:(le=l.value.toolbarTips)==null?void 0:le.orderedList,onClick:()=>{n("orderedList")}},[s(x,{name:"ordered-list"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(z=l.value.toolbarTips)==null?void 0:z.orderedList])]);case"task":return s("div",{class:`${c}-toolbar-item`,title:(U=l.value.toolbarTips)==null?void 0:U.task,onClick:()=>{n("task")}},[s(x,{name:"task"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(be=l.value.toolbarTips)==null?void 0:be.task])]);case"codeRow":return s("div",{class:`${c}-toolbar-item`,title:(we=l.value.toolbarTips)==null?void 0:we.codeRow,onClick:()=>{n("codeRow")}},[s(x,{name:"code-row"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(We=l.value.toolbarTips)==null?void 0:We.codeRow])]);case"code":return s("div",{class:`${c}-toolbar-item`,title:(ze=l.value.toolbarTips)==null?void 0:ze.code,onClick:()=>{n("code")}},[s(x,{name:"code"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(Ke=l.value.toolbarTips)==null?void 0:Ke.code])]);case"link":return s("div",{class:`${c}-toolbar-item`,title:(Ue=l.value.toolbarTips)==null?void 0:Ue.link,onClick:()=>{r.type="link",r.linkVisible=!0}},[s(x,{name:"link"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(Ge=l.value.toolbarTips)==null?void 0:Ge.link])]);case"image":return e.noUploadImg?s("div",{class:`${c}-toolbar-item`,title:(Ze=l.value.toolbarTips)==null?void 0:Ze.image,onClick:()=>{r.type="image",r.linkVisible=!0}},[s(x,{name:"image"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(Xe=l.value.toolbarTips)==null?void 0:Xe.image])]):s(me,{relative:`#${d}`,visible:m.image,onChange:S=>{m.image=S},overlay:s("ul",{class:`${c}-menu`,onClick:()=>{m.title=!1}},[s("li",{class:`${c}-menu-item ${c}-menu-item-image`,onClick:()=>{r.type="image",r.linkVisible=!0}},[(Je=l.value.imgTitleItem)==null?void 0:Je.link]),s("li",{class:`${c}-menu-item ${c}-menu-item-image`,onClick:()=>{h.value.click()}},[(Ye=l.value.imgTitleItem)==null?void 0:Ye.upload]),s("li",{class:`${c}-menu-item ${c}-menu-item-image`,onClick:()=>{r.clipVisible=!0}},[(Qe=l.value.imgTitleItem)==null?void 0:Qe.clip2upload])])},{default:()=>{var S,O;return[s("div",{class:`${c}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.image},[s(x,{name:"image"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(O=l.value.toolbarTips)==null?void 0:O.image])])]}});case"table":return s(me,{relative:`#${d}`,visible:m.table,onChange:S=>{m.table=S},key:"bar-table",overlay:s(sn,{tableShape:e.tableShape,onSelected:S=>{n("table",{selectedShape:S})}},null)},{default:()=>{var S,O;return[s("div",{class:`${c}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.table},[s(x,{name:"table"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(O=l.value.toolbarTips)==null?void 0:O.table])])]}});case"revoke":return s("div",{class:`${c}-toolbar-item`,title:(et=l.value.toolbarTips)==null?void 0:et.revoke,onClick:()=>{y.emit(t,cl)}},[s(x,{name:"revoke"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(tt=l.value.toolbarTips)==null?void 0:tt.revoke])]);case"next":return s("div",{class:`${c}-toolbar-item`,title:(lt=l.value.toolbarTips)==null?void 0:lt.next,onClick:()=>{y.emit(t,dl)}},[s(x,{name:"next"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ot=l.value.toolbarTips)==null?void 0:ot.next])]);case"save":return s("div",{class:`${c}-toolbar-item`,title:(nt=l.value.toolbarTips)==null?void 0:nt.save,onClick:()=>{y.emit(t,Be)}},[s(x,{name:"baocun"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(at=l.value.toolbarTips)==null?void 0:at.save])]);case"prettier":return e.noPrettier?"":s("div",{class:`${c}-toolbar-item`,title:(it=l.value.toolbarTips)==null?void 0:it.prettier,onClick:()=>{n("prettier")}},[s(x,{name:"prettier"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(rt=l.value.toolbarTips)==null?void 0:rt.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&s("div",{class:`${c}-toolbar-item`,title:(st=l.value.toolbarTips)==null?void 0:st.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[s(x,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ct=l.value.toolbarTips)==null?void 0:ct.pageFullscreen])]);case"fullscreen":return s("div",{class:`${c}-toolbar-item`,title:(dt=l.value.toolbarTips)==null?void 0:dt.fullscreen,onClick:()=>{i()}},[s(x,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ut=l.value.toolbarTips)==null?void 0:ut.fullscreen])]);case"preview":return s("div",{class:`${c}-toolbar-item`,title:(mt=l.value.toolbarTips)==null?void 0:mt.preview,onClick:()=>{e.updateSetting("preview")}},[s(x,{name:"preview"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(pt=l.value.toolbarTips)==null?void 0:pt.preview])]);case"htmlPreview":return s("div",{class:`${c}-toolbar-item`,title:(vt=l.value.toolbarTips)==null?void 0:vt.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[s(x,{name:"coding"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ht=l.value.toolbarTips)==null?void 0:ht.htmlPreview])]);case"catalog":return s("div",{class:`${c}-toolbar-item`,title:(gt=l.value.toolbarTips)==null?void 0:gt.catalog,onClick:()=>{y.emit(t,qe)},key:"bar-catalog"},[s(x,{name:"catalog"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(ft=l.value.toolbarTips)==null?void 0:ft.catalog])]);case"github":return s("div",{class:`${c}-toolbar-item`,title:(bt=l.value.toolbarTips)==null?void 0:bt.github,onClick:()=>kl("https://github.com/imzbf/md-editor-v3")},[s(x,{name:"github"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(yt=l.value.toolbarTips)==null?void 0:yt.github])]);case"mermaid":return s(me,{relative:`#${d}`,visible:m.mermaid,onChange:S=>{m.mermaid=S},overlay:s("ul",{class:`${c}-menu`,onClick:()=>{m.mermaid=!1}},[s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("flow")}},[(kt=l.value.mermaid)==null?void 0:kt.flow]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("sequence")}},[($t=l.value.mermaid)==null?void 0:$t.sequence]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("gantt")}},[(Ct=l.value.mermaid)==null?void 0:Ct.gantt]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("class")}},[(wt=l.value.mermaid)==null?void 0:wt.class]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("state")}},[(Tt=l.value.mermaid)==null?void 0:Tt.state]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("pie")}},[(xt=l.value.mermaid)==null?void 0:xt.pie]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("relationship")}},[(St=l.value.mermaid)==null?void 0:St.relationship]),s("li",{class:`${c}-menu-item ${c}-menu-item-mermaid`,onClick:()=>{n("journey")}},[(Et=l.value.mermaid)==null?void 0:Et.journey])]),key:"bar-mermaid"},{default:()=>{var S,O;return[s("div",{class:`${c}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.mermaid},[s(x,{name:"mermaid"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(O=l.value.toolbarTips)==null?void 0:O.mermaid])])]}});case"katex":return s(me,{relative:`#${d}`,visible:m.katex,onChange:S=>{m.katex=S},overlay:s("ul",{class:`${c}-menu`,onClick:()=>{m.katex=!1}},[s("li",{class:`${c}-menu-item ${c}-menu-item-katex`,onClick:()=>{n("katexInline")}},[(It=l.value.katex)==null?void 0:It.inline]),s("li",{class:`${c}-menu-item ${c}-menu-item-katex`,onClick:()=>{n("katexBlock")}},[(Ft=l.value.katex)==null?void 0:Ft.block])]),key:"bar-katex"},{default:()=>{var S,O;return[s("div",{class:`${c}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.katex},[s(x,{name:"formula"},null),e.showToolbarName&&s("div",{class:`${c}-toolbar-item-name`},[(O=l.value.toolbarTips)==null?void 0:O.katex])])]}})}else if(e.defToolbars instanceof Array){const S=e.defToolbars[f];return S?Ve(S,{theme:o.value,language:a.value,insert(O){y.emit(t,F,"universal",{generate:O})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const S=e.defToolbars.children[f];return S?Ve(S,{theme:o.value,language:a.value,insert(O){y.emit(t,F,"universal",{generate:O})}}):""}else return""};return T(()=>e.toolbars,()=>{ae(()=>{u.value&&yl(u.value)})},{immediate:!0}),()=>{const f=k.value[0].map(C=>v(C)),$=k.value[1].map(C=>v(C));return s(He,null,[e.toolbars.length>0&&s("div",{class:`${c}-toolbar-wrapper`,ref:u,id:d},[s("div",{class:[`${c}-toolbar`,e.showToolbarName&&`${c}-stn`]},[s("div",{class:`${c}-toolbar-left`,ref:p},[f]),s("div",{class:`${c}-toolbar-right`},[$])])]),s("input",{ref:h,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),s(vn,{linkVisible:r.linkVisible,clipVisible:r.clipVisible,type:r.type,onCancel:()=>{r.linkVisible=!1,r.clipVisible=!1},onOk:C=>{C&&n(r.type,{desc:C.desc,url:C.url}),r.linkVisible=!1,r.clipVisible=!1}},null)])}}}),gn=(e,t)=>{const l=Ae(()=>{e.removeEventListener("scroll",o),e.addEventListener("scroll",o),t.removeEventListener("scroll",o),t.addEventListener("scroll",o)},50),o=a=>{const i=e.clientHeight,d=t.clientHeight,u=e.scrollHeight,m=t.scrollHeight,n=(u-i)/(m-d);a.target===e?(t.removeEventListener("scroll",o),t.scrollTo({top:e.scrollTop/n}),l()):(e.removeEventListener("scroll",o),e.scrollTo({top:t.scrollTop*n}),l())};return[()=>{l().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",o),t.removeEventListener("scroll",o)}]},fn=(e,t,l)=>{const{view:o}=l,a=$l(),i=k=>o.lineBlockAt(o.state.doc.line(k).from).top,d=k=>o.lineBlockAt(o.state.doc.line(k).from).height;let u=[];const m=()=>{u=[];const k=Array.from(t.querySelectorAll("[data-line]")).map(f=>Number(f.dataset.line)+1),{lines:h}=o.state.doc;let g=1,v=k.shift()??h;for(let f=1;f<=h;f++)f===v&&(g=f,v=k.shift()||h+1),u.push({start:g,end:v-1})};let n=0,r=0;const p=ll(k=>{var h,g,v,f,$,C,w;if(!((h=t.firstElementChild)!=null&&h.firstElementChild))return;const I=o.lineBlockAtHeight(o.scrollDOM.scrollTop),{number:P}=o.state.doc.lineAt(I.from);if(P>u.length||o.state.doc.lines<u[u.length-1].end)return;let N=+getComputedStyle(t).paddingTop.replace("px","");const de=+getComputedStyle(t).paddingBottom.replace("px","");if(k.target===e){if(r!==0)return;n++;const j=u[P-1];let D=i(j.end)+d(j.end),J=0;const X=i(j.start),_=t.querySelector(`[data-line="${j.start-1}"]`)||((g=t.firstElementChild)==null?void 0:g.firstElementChild),V=t.querySelector(`[data-line="${j.end}"]`)||((v=t.lastElementChild)==null?void 0:v.lastElementChild);let R=0,W=0;X===0?_===V?(N=0,D=o.contentDOM.offsetHeight-o.scrollDOM.offsetHeight,J=o.scrollDOM.scrollTop/D,R=V.offsetTop+V.offsetHeight-t.clientHeight):(J=o.scrollDOM.scrollTop/D,R=V.offsetTop):D>o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight?(J=(o.scrollDOM.scrollTop-X)/(o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight-X),W=_.offsetTop,R=t.scrollHeight-t.clientHeight-W+10):(J=(o.scrollDOM.scrollTop-X)/(D-X),W=_.offsetTop,R=V.offsetTop-W);const ee=W-N+R*J;a(t,ee,()=>{n--})}else{if(n!==0)return;r++;const j=Array.from(t.querySelectorAll("[data-line]")),D=t.scrollTop,J=t.scrollHeight;let X=j.length===0?1:Math.ceil(Number(j[j.length-1].dataset.line)*(D/J)),_=(f=t.firstElementChild)==null?void 0:f.firstElementChild;for(let z=X;z>=0;z--){const U=t.querySelector(`[data-line="${z}"]`);if(U&&U.offsetTop<=D){_=U,X=z;break}}let V=($=t.firstElementChild)==null?void 0:$.firstElementChild,R=(C=t.firstElementChild)==null?void 0:C.lastElementChild;for(;j.length>0;){const z=j.indexOf(_);if(z+1>=j.length)break;const U=j[z+1];if(z===-1){R=U;break}const be=_.offsetTop;if(be>D){if(z===0){V=_,R=U;break}_=j[z-1];continue}const we=U.offsetTop;if(be<=D&&we>D){V=_,R=U;break}_=U}const W=V.offsetTop;let ee=R.offsetTop,ie=0;const{start:Ce,end:ge}=u[Number(V.dataset.line||0)],re=i(Ce);let te=i(ge);const fe=d(ge);let le=0;V===((w=t.firstElementChild)==null?void 0:w.firstElementChild)?(V===R?(ee=R.offsetHeight-t.offsetHeight+N+de,le=o.contentDOM.offsetHeight-o.scrollDOM.offsetHeight):le=te+fe-re,ie=Math.max(D/ee,0)):te>o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight?(ie=Math.max((D-W)/(t.scrollHeight-W-t.clientHeight),0),te=i(o.state.doc.lines)+d(o.state.doc.lines),le=8+te-re-e.clientHeight):(ie=Math.max((D-W)/(ee-W),0),le=te+fe-re),a(e,re+le*ie,()=>{r--})}},10);return[()=>{m(),e.addEventListener("scroll",p),t.addEventListener("scroll",p),e.dispatchEvent(new Event("scroll"))},()=>{u=[],e.removeEventListener("scroll",p),t.removeEventListener("scroll",p)}]},bn=(e,t,l)=>{const o=E("editorId");let a=()=>{},i=()=>{};const d=()=>{a();const u=document.querySelector(`#${o} .cm-scroller`),m=document.querySelector(`[id="${o}-preview-wrapper"][data-show="true"]`),n=document.querySelector(`[id="${o}-html-wrapper"][data-show="true"]`);(m||n)&&([i,a]=(m?fn:gn)(u,m||n,l.value)),e.scrollAuto&&i()};T([t,ne(e.setting,"preview"),ne(e.setting,"htmlPreview"),ne(e.setting,"fullscreen"),ne(e.setting,"pageFullscreen")],()=>{ae(d)}),T(()=>e.scrollAuto,u=>{u?i():a()}),M(d)},yn=bn,kn=(e,t,l)=>{var o,a,i,d,u,m;let n="",r=0,p=0,k=!0,h=!1;const g=t.getSelectedText(),v=(o=H.editorConfig)==null?void 0:o.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const f=e.replace(/^h(\d)/,($,C)=>new Array(Number(C)).fill("#",0,C).join(""));n=`${f} ${g}`,r=f.length+1}else if(e==="prettier"){const f=window.prettier||((i=(a=H.editorExtensions)==null?void 0:a.prettier)==null?void 0:i.prettierInstance),$=[((d=window.prettierPlugins)==null?void 0:d.markdown)||((m=(u=H.editorExtensions)==null?void 0:u.prettier)==null?void 0:m.parserMarkdownInstance)];!f||$[0]===void 0?(y.emit(l.editorId,ce,{name:"prettier",message:"prettier is undefined"}),n=t.getValue()):n=f.format(t.getValue(),{parser:"markdown",plugins:$}),k=!1,h=!0}else switch(e){case"bold":{n=`**${g}**`,r=2,p=-2;break}case"underline":{n=`<u>${g}</u>`,r=3,p=-4;break}case"italic":{n=`*${g}*`,r=1,p=-1;break}case"strikeThrough":{n=`~~${g}~~`,r=2,p=-2;break}case"sub":{n=`<sub>${g}</sub>`,r=5,p=-6;break}case"sup":{n=`<sup>${g}</sup>`,r=5,p=-6;break}case"codeRow":{n="`"+g+"`",r=1,p=-1;break}case"quote":{n=`> ${g}`,r=2;break}case"orderedList":{n=`1. ${g}`,r=3;break}case"unorderedList":{n=`- ${g}`,r=2;break}case"task":{n=`- [ ] ${g}`,r=6;break}case"code":{const f=l.text||g||"",$=l.mode||"language";n=`\`\`\`${$}
${f}
\`\`\`
`,r=3,p=3+$.length-n.length;break}case"table":{n="|";const{selectedShape:f={x:1,y:1}}=l,{x:$,y:C}=f;for(let w=0;w<=C;w++)n+=" col |";n+=`
|`;for(let w=0;w<=C;w++)n+=" - |";for(let w=0;w<=$;w++){n+=`
|`;for(let I=0;I<=C;I++)n+=" content |"}r=2,p=5-n.length;break}case"link":{const{desc:f,url:$}=l;n=`[${f}](${$})`,k=!1;break}case"image":{const{desc:f,url:$,urls:C}=l;C instanceof Array?n=C.reduce((w,I)=>w+`![${f}](${I})
`,""):n=`![${f}](${$})
`,k=!1;break}case"flow":{n=`\`\`\`mermaid
${(v==null?void 0:v.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,r=3,p=10-n.length;break}case"sequence":{n=`\`\`\`mermaid
${(v==null?void 0:v.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,r=3,p=10-n.length;break}case"gantt":{n=`\`\`\`mermaid
${(v==null?void 0:v.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,r=3,p=10-n.length;break}case"class":{n=`\`\`\`mermaid
${(v==null?void 0:v.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,r=3,p=10-n.length;break}case"state":{n=`\`\`\`mermaid
${(v==null?void 0:v.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,r=3,p=10-n.length;break}case"pie":{n=`\`\`\`mermaid
${(v==null?void 0:v.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,r=3,p=10-n.length;break}case"relationship":{n=`\`\`\`mermaid
${(v==null?void 0:v.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,r=3,p=10-n.length;break}case"journey":{n=`\`\`\`mermaid
${(v==null?void 0:v.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,r=3,p=10-n.length;break}case"katexInline":{n="$$",r=1,p=-1;break}case"katexBlock":{n=`$$

$$
`,r=3,p=-4;break}case"universal":{const{generate:f}=l,$=f(g);n=$.targetValue,k=$.select,r=$.deviationStart,p=$.deviationEnd}}return{text:n,options:{select:k,deviationStart:r,deviationEnd:p,replaceAll:h}}},$n="#e5c07b",_t="var(--md-color)",Cn="#56b6c2",wn="#ffffff",ye="var(--md-color)",qt="#e5c07b",Tn="#e5c07b",xn="var(--md-color)",Wt="#d19a66",Sn="#c678dd",En="#21252b",In="#2c313a",zt="var(--md-bk-color)",Ne="var(--md-bk-color)",Fn="#ceedfa33",Kt="#528bff",Ln=se.theme({"&":{color:ye,backgroundColor:zt},".cm-content":{caretColor:Kt},".cm-cursor, .cm-dropCursor":{borderLeftColor:Kt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Fn},".cm-panels":{backgroundColor:En,color:ye},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:zt,color:ye,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:In},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Ne},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ne,borderBottomColor:Ne},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ye}}},{dark:!0}),Mn=ol.define([{tag:b.keyword,color:Sn},{tag:[b.name,b.deleted,b.character,b.propertyName,b.macroName],color:_t},{tag:[b.function(b.variableName),b.labelName],color:Tn},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:Wt},{tag:[b.definition(b.name),b.separator],color:ye},{tag:[b.typeName,b.className,b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:$n},{tag:[b.operator,b.operatorKeyword,b.url,b.escape,b.regexp,b.link,b.special(b.string)],color:Cn},{tag:[b.meta,b.comment],color:qt},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.link,color:qt,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:_t},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Wt},{tag:[b.processingInstruction,b.string,b.inserted],color:xn},{tag:b.invalid,color:wn}]),Ut=[Ln,nl(Mn)],An="#e5c07b",Gt="#3f4a54",Hn="#56b6c2",Bn="#fff",ke="#3f4a54",Zt="#2d8cf0",jn="#2d8cf0",Pn="#3f4a54",Xt="#d19a66",Nn="#c678dd",On="#21252b",Dn="#ceedfa33",Jt="var(--md-bk-color)",Oe="var(--md-bk-color)",Vn="#bad5fa",Yt="#3f4a54",Rn=se.theme({"&":{color:ke,backgroundColor:Jt},".cm-content":{caretColor:Yt},".cm-cursor, .cm-dropCursor":{borderLeftColor:Yt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Vn},".cm-panels":{backgroundColor:On,color:ke},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Jt,color:ke,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Dn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Oe},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Oe,borderBottomColor:Oe},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ke}}}),_n=ol.define([{tag:b.keyword,color:Nn},{tag:[b.name,b.deleted,b.character,b.propertyName,b.macroName],color:Gt},{tag:[b.function(b.variableName),b.labelName],color:jn},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:Xt},{tag:[b.definition(b.name),b.separator],color:ke},{tag:[b.typeName,b.className,b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:An},{tag:[b.operator,b.operatorKeyword,b.url,b.escape,b.regexp,b.link,b.special(b.string)],color:Hn},{tag:[b.meta,b.comment],color:Zt},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.link,color:Zt,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:Gt},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Xt},{tag:[b.processingInstruction,b.string,b.inserted],color:Pn},{tag:b.invalid,color:Bn}]),Qt=[Rn,nl(_n)],xe=(e,t,l,o,a)=>(i,d,u,m)=>{const n=`${e}${t}`.slice(m-u);i.dispatch(i.state.replaceSelection(`${n}${l}${o}`));const r=u+d.label.length+(a==="title"?l.length:0);i.dispatch({selection:Q.create([Q.range(u+d.label.length+(a==="title"?1:-t.length),r),Q.cursor(r)],1)}),i.focus()},el=e=>(t,l,o,a)=>{const i=e.slice(a-o);t.dispatch(t.state.replaceSelection(`${i} `))},qn=e=>{const t=l=>{const o=l.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|^\$\$?|!+\s*\w*/);return o===null||o.from==o.to&&l.explicit?null:{from:o.from,options:[...["h1","h2","h3","h4","h5","h6"].map((a,i)=>{const d=new Array(i+1).fill("#").join("");return{label:d,type:"text",apply:el(d)}}),...["unchecked","checked"].map(a=>{const i=a==="checked"?"- [x]":"- [ ]";return{label:i,type:"text",apply:el(i)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(a=>({label:`${a[0]}${a[1]}`,type:"text",apply:xe(a[0],a[1],"",a[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:xe("$","","","$","type")},{label:"$$",type:"text",apply:xe("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(a=>({label:`!!! ${a}`,type:"text",apply:xe("!!!",` ${a}`," Title",`

!!!`,"title")}))]}};return Bl({override:e?[t,...e]:[t]})},tl=qn,ue=e=>{const t=new Se;return l=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(l)}):e.dispatch({effects:jl.appendConfig.of(t.of(l))}),!0)};class Wn{constructor(t){oe(this,"view"),oe(this,"maxLength",Number.MAX_SAFE_INTEGER),oe(this,"toggleTabSize"),oe(this,"togglePlaceholder"),oe(this,"setExtensions"),oe(this,"toggleDisabled"),oe(this,"toggleReadOnly"),oe(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=ue(this.view),this.togglePlaceholder=ue(this.view),this.setExtensions=ue(this.view),this.toggleDisabled=ue(this.view),this.toggleReadOnly=ue(this.view),this.toggleMaxlength=ue(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,l=0,o=this.view.state.doc.length){this.view.dispatch({changes:{from:l,to:o,insert:t}})}getSelectedText(){const{from:t,to:l}=this.view.state.selection.main;return this.view.state.sliceDoc(t,l)}replaceSelectedText(t,l={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},o){try{if(l.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:a}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(t)),l.select){const i=a+t.length+l.deviationEnd;this.view.dispatch({selection:Q.create([Q.range(a+l.deviationStart,i),Q.cursor(i)],1)})}this.view.focus()}catch(a){if(a.message==="The input text is too long")y.emit(o,ce,{name:"overlength",message:a.message,data:t});else throw a}}setTabSize(t){this.toggleTabSize([Pe.tabSize.of(t),Ml.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder(Al(t))}focus(t){if(this.view.focus(),!t)return;let l=0,o=0,a=0;switch(t){case"start":break;case"end":{l=o=a=this.getValue().length;break}default:l=t.rangeAnchor||t.cursorPos,o=t.rangeHead||t.cursorPos,a=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:Q.create([Q.range(l,o),Q.cursor(a)],1)})}setDisabled(t){this.toggleDisabled([se.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([Pe.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([Pe.changeFilter.of(l=>l.newDoc.length<=t)])}}const zn=e=>{const t=E("editorId");return l=>{if(!l.clipboardData)return;if(l.clipboardData.files.length>0){const{files:a}=l.clipboardData;y.emit(t,je,Array.from(a).filter(i=>/image\/.*/.test(i.type))),l.preventDefault();return}if(e.autoDetectCode&&l.clipboardData.types.includes("vscode-editor-data")){const a=JSON.parse(l.clipboardData.getData("vscode-editor-data"));y.emit(t,F,"code",{mode:a.mode,text:l.clipboardData.getData("text/plain")}),l.preventDefault();return}const o=l.clipboardData.getData("text/plain");e.maxlength&&o.length+e.modelValue.length>e.maxlength&&y.emit(t,ce,{name:"overlength",message:"The input text is too long",data:o})}},Kn=zn,Un=e=>{const t=E("editorId");M(()=>{y.on(t,{name:sl,callback(l){var o;(o=e.value)==null||o.focus(l)}})})},Gn=Un,Zn=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(y.emit(e,F,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:Pl,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:l=>(y.emit(e,Be,l.state.doc.toString()),!0),shift:()=>(y.emit(e,F,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>(y.emit(e,F,"underline"),!0),shift:()=>(y.emit(e,F,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>(y.emit(e,F,"italic"),!0),shift:()=>(y.emit(e,Re,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(y.emit(e,F,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(y.emit(e,F,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(y.emit(e,F,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(y.emit(e,F,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(y.emit(e,F,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(y.emit(e,F,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(y.emit(e,F,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(y.emit(e,F,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(y.emit(e,F,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(y.emit(e,F,"code"),!0),any(l,o){return(o.ctrlKey||o.metaKey)&&o.altKey&&o.code==="KeyC"?(y.emit(e,F,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(y.emit(e,Re,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:(y.emit(e,F,"prettier"),!0)},{any:(l,o)=>(o.ctrlKey||o.metaKey)&&o.altKey&&o.shiftKey&&o.code==="KeyT"?(y.emit(e,F,"table"),!0):!1}],Xn=Zn,Jn=e=>{const t=E("tabWidth"),l=E("editorId"),o=E("theme"),a=B(),i=ve(),d=new Se,u=new Se,m=new Se,n=Xn(l,e),r=Kn(e),p=[Sl.of([...n,El]),Tl,d.of(Il({codeLanguages:Hl})),se.lineWrapping,se.updateListener.of(h=>{h.docChanged&&e.onChange(h.state.doc.toString())}),se.domEventHandlers({paste:r,blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,input:h=>{e.onInput&&e.onInput(h);const{data:g}=h;e.maxlength&&e.modelValue.length+g.length>e.maxlength&&y.emit(l,ce,{name:"overlength",message:"The input text is too long",data:g})}})],k=()=>{const h=[...p,u.of(o.value==="light"?Qt:Ut),m.of(tl(e.completions))];return H.codeMirrorExtensions(o.value,h,[...n])};return M(()=>{const h=new se({doc:e.modelValue,parent:a.value,extensions:[k()]}),g=new Wn(h);i.value=g,setTimeout(()=>{g.setTabSize(t),g.setDisabled(e.disabled),g.setReadOnly(e.readonly),e.placeholder&&g.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&g.setMaxLength(e.maxlength),e.autofocus&&h.focus()},0),y.on(l,{name:cl,callback(){Fl(h)}}),y.on(l,{name:dl,callback(){Ll(h)}}),y.on(l,{name:F,callback(v,f={}){var $;const{text:C,options:w}=kn(v,i.value,f);($=i.value)==null||$.replaceSelectedText(C,w,l)}})}),T(o,()=>{var h;(h=i.value)==null||h.view.dispatch({effects:u.reconfigure(o.value==="light"?Qt:Ut)})},{deep:!0}),T(()=>e.completions,()=>{var h;(h=i.value)==null||h.view.dispatch({effects:m.reconfigure(tl(e.completions))})},{deep:!0}),T(()=>e.modelValue,()=>{var h,g;((h=i.value)==null?void 0:h.getValue())!==e.modelValue&&((g=i.value)==null||g.setValue(e.modelValue))}),T(()=>e.placeholder,()=>{var h;(h=i.value)==null||h.setPlaceholder(e.placeholder)}),T(()=>e.disabled,()=>{var h;(h=i.value)==null||h.setDisabled(e.disabled)}),T(()=>e.readonly,()=>{var h;(h=i.value)==null||h.setDisabled(e.readonly)}),T(()=>e.maxlength,()=>{var h;e.maxlength&&((h=i.value)==null||h.setMaxLength(e.maxlength))}),Gn(i),{inputWrapperRef:a,codeMirrorUt:i}},Yn=Jn,Qn=(e,t,l)=>{const o=q({resizedWidth:e.inputBoxWitdh}),a=q({width:e.inputBoxWitdh}),i=q({left:e.inputBoxWitdh,display:"initial"}),d=n=>{var r,p,k;const h=((r=t.value)==null?void 0:r.offsetWidth)||0,g=((p=t.value)==null?void 0:p.getBoundingClientRect().x)||0;let v=n.x-g;v<Te?v=Te:v>h-Te&&(v=h-Te);const f=`${v}px`;a.width=f,i.left=f,o.resizedWidth=f,(k=e.onInputBoxWitdhChange)==null||k.call(e,f)},u=()=>{document.addEventListener("mousemove",d)},m=()=>{document.removeEventListener("mousemove",d)};return M(()=>{var n;(n=l.value)==null||n.addEventListener("mousedown",u),document.addEventListener("mouseup",m)}),he(()=>{var n,r;(n=l.value)==null||n.removeEventListener("mousedown",u),(r=l.value)==null||r.removeEventListener("mouseup",m)}),T(()=>e.inputBoxWitdh,n=>{n&&(a.width=n,i.left=n)}),T([ne(e.setting,"htmlPreview"),ne(e.setting,"preview")],()=>{!e.setting.htmlPreview&&!e.setting.preview?(a.width="100%",i.display="none"):(a.width=o.resizedWidth,i.display="initial")},{immediate:!0}),{inputWrapperStyle:a,resizeOperateStyle:i}},ea=Qn,ta=A({name:"MDEditorContent",props:jo,setup(e){const t=E("editorId"),l=B(""),o=B(),a=B(),{inputWrapperRef:i,codeMirrorUt:d}=Yn(e),{inputWrapperStyle:u,resizeOperateStyle:m}=ea(e,o,a);return yn(e,l,d),()=>s("div",{class:`${c}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:o},[s("div",{class:`${c}-input-wrapper`,style:u,ref:i},null),(e.setting.htmlPreview||e.setting.preview)&&s("div",{class:`${c}-resize-operate`,style:m,ref:a},null),s(pl,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:n=>{l.value=n,e.onHtmlChanged(n)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn},null),e.catalogVisible&&s($e,{theme:e.theme,class:`${c}-catalog-editor`,editorId:t,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),la=A({props:{modelValue:{type:String,default:""}},setup(e){const t=E("usedLanguageText");return()=>{var l,o;return s("div",{class:`${c}-footer-item`},[s("label",{class:`${c}-footer-label`},[`${(l=t.value.footer)==null?void 0:l.markdownTotal}:`]),s("span",null,[((o=e.modelValue)==null?void 0:o.length)||0])])}}}),oa={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},na=A({props:oa,setup(e){return()=>s("div",{class:[`${c}-checkbox`,e.checked&&`${c}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),aa={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},ia=A({props:aa,setup(e){const t=E("usedLanguageText");return()=>{var l;return s("div",{class:`${c}-footer-item`},[s("label",{class:`${c}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(l=t.value.footer)==null?void 0:l.scrollAuto]),s(na,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),ra={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},sa=A({name:"MDEditorFooter",props:ra,setup(e){const t=K(()=>{const o=e.footers.indexOf("="),a=o===-1?e.footers:e.footers.slice(0,o),i=o===-1?[]:e.footers.slice(o,Number.MAX_SAFE_INTEGER);return[a,i]}),l=o=>{if(il.includes(o))switch(o){case"markdownTotal":return s(la,{modelValue:e.modelValue},null);case"scrollSwitch":return s(ia,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[o]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[o]||""};return()=>{const o=t.value[0].map(i=>l(i)),a=t.value[1].map(i=>l(i));return s("div",{class:`${c}-footer`},[s("div",{class:`${c}-footer-left`},[o]),s("div",{class:`${c}-footer-right`},[a])])}}}),ca=A({name:"MdEditorV3",props:Wo,emits:zo,setup(e,t){const{editorId:l,noKatex:o,noMermaid:a,noPrettier:i,noUploadImg:d,noHighlight:u}=e,m=q({scrollAuto:e.scrollAuto});Po(e,t),No(e),Oo(e),Do(e,t);const[n,r]=Vo(e,t),p=Ro(e);return he(()=>{y.clear(l)}),_o(e,t,p,n,r),()=>{var k;const h=Z({props:e,ctx:t},"defToolbars"),g=Z({props:e,ctx:t},"defFooters");return s("div",{id:l,class:[c,e.class,e.theme==="dark"&&`${c}-dark`,n.fullscreen||n.pageFullscreen?`${c}-fullscreen`:""],style:e.style},[s(hn,{noPrettier:i,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:n,updateSetting:r,tableShape:e.tableShape,defToolbars:h,noUploadImg:d,showToolbarName:e.showToolbarName},null),s(ta,{modelValue:e.modelValue,setting:n,mdHeadingId:e.mdHeadingId,noMermaid:a,noPrettier:i,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:o,scrollAuto:m.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:u,onChange:v=>{e.onChange?e.onChange(v):(t.emit("update:modelValue",v),t.emit("onChange",v))},onHtmlChanged:v=>{e.onHtmlChanged?e.onHtmlChanged(v):t.emit("onHtmlChanged",v)},onGetCatalog:v=>{e.onGetCatalog?e.onGetCatalog(v):t.emit("onGetCatalog",v)},onBlur:v=>{e.onBlur?e.onBlur(v):t.emit("onBlur",v)},onFocus:v=>{e.onFocus?e.onFocus(v):t.emit("onFocus",v)},onInput:v=>{e.onInput?e.onInput(v):t.emit("onInput",v)},completions:e.completions,catalogVisible:p.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:v=>{e.onDrop?e.onDrop(v):t.emit("onDrop",v)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:v=>{e.onInputBoxWitdhChange?e.onInputBoxWitdhChange(v):t.emit("onInputBoxWitdhChange",v)}},null),((k=e.footers)==null?void 0:k.length)>0&&s(sa,{modelValue:e.modelValue,footers:e.footers,defFooters:g,scrollAuto:m.scrollAuto,onScrollAutoChange:v=>m.scrollAuto=v},null)])}}}),De=ca;De.install=e=>(e.component(De.name,De),e.use(Le).use(Ee).use(Me).use($e).use(Fe),e);export{De as y};
